/*
Deployment script for SICAD_CONSOLIDADO

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "SICAD_CONSOLIDADO"
:setvar DefaultFilePrefix "SICAD_CONSOLIDADO"
:setvar DefaultDataPath "G:\SQL2012\"
:setvar DefaultLogPath "F:\SQL2012\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [master];


GO

IF (DB_ID(N'$(DatabaseName)') IS NOT NULL) 
BEGIN
    ALTER DATABASE [$(DatabaseName)]
    SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
    DROP DATABASE [$(DatabaseName)];
END

GO
PRINT N'Creating $(DatabaseName)...'
GO
CREATE DATABASE [$(DatabaseName)]
    ON 
    PRIMARY(NAME = [$(DatabaseName)], FILENAME = N'$(DefaultDataPath)$(DefaultFilePrefix)_Primary.mdf', SIZE = 78848KB , MAXSIZE = UNLIMITED, FILEGROWTH = 1024KB)
    LOG ON (NAME = [$(DatabaseName)_log], FILENAME = N'$(DefaultLogPath)$(DefaultFilePrefix)_Primary.ldf', SIZE = 4672KB , MAXSIZE = 2048GB , FILEGROWTH = 10%) COLLATE Latin1_General_CS_AS
GO

IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET COMPATIBILITY_LEVEL = 110
            WITH ROLLBACK IMMEDIATE;
    END


GO

IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET ANSI_NULLS OFF,
                ANSI_PADDING OFF,
                ANSI_WARNINGS OFF,
                ARITHABORT OFF,
                CONCAT_NULL_YIELDS_NULL OFF,
                NUMERIC_ROUNDABORT OFF,
                QUOTED_IDENTIFIER OFF,
                ANSI_NULL_DEFAULT OFF,
                CURSOR_DEFAULT GLOBAL,
                RECOVERY FULL,
                CURSOR_CLOSE_ON_COMMIT OFF,
                AUTO_CREATE_STATISTICS ON,
                AUTO_SHRINK OFF,
                AUTO_UPDATE_STATISTICS ON,
                RECURSIVE_TRIGGERS OFF 
            WITH ROLLBACK IMMEDIATE;
        ALTER DATABASE [$(DatabaseName)]
            SET AUTO_CLOSE OFF 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET ALLOW_SNAPSHOT_ISOLATION OFF;
    END


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET READ_COMMITTED_SNAPSHOT OFF 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET AUTO_UPDATE_STATISTICS_ASYNC OFF,
                PAGE_VERIFY CHECKSUM,
                DATE_CORRELATION_OPTIMIZATION OFF,
                DISABLE_BROKER,
                PARAMETERIZATION SIMPLE,
                SUPPLEMENTAL_LOGGING OFF 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF IS_SRVROLEMEMBER(N'sysadmin') = 1
    BEGIN
        IF EXISTS (SELECT 1
                   FROM   [master].[dbo].[sysdatabases]
                   WHERE  [name] = N'$(DatabaseName)')
            BEGIN
                EXECUTE sp_executesql N'ALTER DATABASE [$(DatabaseName)]
    SET TRUSTWORTHY OFF,
        DB_CHAINING OFF 
    WITH ROLLBACK IMMEDIATE';
            END
    END
ELSE
    BEGIN
        PRINT N'The database settings cannot be modified. You must be a SysAdmin to apply these settings.';
    END


GO
IF IS_SRVROLEMEMBER(N'sysadmin') = 1
    BEGIN
        IF EXISTS (SELECT 1
                   FROM   [master].[dbo].[sysdatabases]
                   WHERE  [name] = N'$(DatabaseName)')
            BEGIN
                EXECUTE sp_executesql N'ALTER DATABASE [$(DatabaseName)]
    SET HONOR_BROKER_PRIORITY OFF 
    WITH ROLLBACK IMMEDIATE';
            END
    END
ELSE
    BEGIN
        PRINT N'The database settings cannot be modified. You must be a SysAdmin to apply these settings.';
    END


GO


IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET MULTI_USER
            WITH ROLLBACK IMMEDIATE;
    END


GO

ALTER DATABASE [$(DatabaseName)]
    SET TARGET_RECOVERY_TIME = 0 SECONDS 
    WITH ROLLBACK IMMEDIATE;


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET FILESTREAM(NON_TRANSACTED_ACCESS = OFF),
                CONTAINMENT = NONE 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET READ_WRITE
            WITH ROLLBACK IMMEDIATE;
    END


GO

USE [$(DatabaseName)];


GO
IF fulltextserviceproperty(N'IsFulltextInstalled') = 1
    EXECUTE sp_fulltext_database 'enable';


GO
PRINT N'Creating TABLES...';
GO


/****** Object:  Table [dbo].[AUX_CUOTAS_MAX_DIAS_ATRASO_CAPITAL]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_CUOTAS_MAX_DIAS_ATRASO_CAPITAL](
	[ATRASO_CAPITAL] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_CUOTAS_MAX_DIAS_ATRASO_INTERES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_CUOTAS_MAX_DIAS_ATRASO_INTERES](
	[ATRASO_INTERES] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_FN_SALDO_GRUPO]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_FN_SALDO_GRUPO](
	[SALDO_GRUPO] [decimal](26, 2) NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[EMPRESA] [int] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_MODIFICACIONES_HISTORICAS_CIC]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_MODIFICACIONES_HISTORICAS_CIC](
	[EMPRESA] [int] NULL,
	[FECHA_CORTE] [date] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_LINEA] [varchar](25) NULL,
	[COD_SISTEMA] [int] NULL,
	[FRECUENCIA_PAGO_ACTUAL_PRINCIPAL] [int] NULL,
	[FRECUENCIA_PAGO_ACTUAL_INTERESES] [int] NULL,
	[FORMA_PAGO_VIGENTE_PRINCIPAL] [varchar](1) NULL,
	[FORMA_PAGO_VIGENTE_INTERESES] [varchar](1) NULL,
	[COD_TIPO_TASA] [varchar](2) NULL,
	[MONTO_OPERACION_AUTORIZADO] [decimal](26, 4) NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[FECHA_FORMALIZACION] [date] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_OCE]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_OCE](
	[NUM] [int] NULL,
	[EMPRESA] [int] NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[COD_SISTEMA] [int] NOT NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_OCS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_OCS](
	[NUM] [int] NULL,
	[EMPRESA] [int] NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[COD_SISTEMA] [int] NOT NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_PROVISION_OPERACIONES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_PROVISION_OPERACIONES](
	[ORDEN] [int] NULL,
	[NUMERO_GARANTIA] [varchar](25) NULL,
	[VALOR_GARANTIA] [decimal](18, 2) NULL,
	[VALOR_GARANTIA_CALC] [decimal](18, 2) NULL,
	[ID_OPERAC] [varchar](25) NULL,
	[SALDO_A_CUBRIR] [decimal](18, 2) NULL,
	[SALDO_CUBIERTO] [decimal](18, 2) NULL,
	[SALDO_A_CUBRIR_CALC] [decimal](18, 2) NULL,
	[PCJ_GARANTIA] [decimal](12, 9) NULL,
	[SALDO_PCJ_GARANTIA] [decimal](18, 2) NULL,
	[SALDO_PCJ_GARANTIA_UTILIZADO] [decimal](18, 2) NULL,
	[SALDO_CUBIERTO_ORIG] [decimal](18, 2) NULL,
	[SALDO_A_CUBRIR_CALC_ORIG] [decimal](18, 2) NULL,
	[SALDO_BASE_PROVISION_TOTAL] [decimal](18, 2) NULL,
	[GARANTIAS_RELACIONADAS] [int] NULL,
	[PRESTAMOS_X_GARANTIA] [int] NULL,
	[VALOR_DEPRECIADO_GARANTIA] [decimal](18, 2) NULL,
	[VALOR_REVAL_TERRENO] [decimal](18, 2) NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[CATEGORIA_RIESGO] [varchar](2) NULL,
 CONSTRAINT [IX_AUX_PROVISION_OPERACIONES] UNIQUE NONCLUSTERED 
(
	[ID_OPERAC] ASC,
	[NUMERO_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_RPT_ASIENTO_CONTABLE_814_619_DETALLE]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_RPT_ASIENTO_CONTABLE_814_619_DETALLE](
	[CUENTA] [varchar](100) NULL,
	[SALDO] [decimal](26, 2) NULL,
	[MONEDA] [varchar](255) NULL,
	[EMPRESA] [int] NULL,
	[AJUSTE] [varchar](5) NULL,
	[TIPO] [int] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_RPT_DEUDORES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_RPT_DEUDORES](
	[ID_DEUDOR] [varchar](30) NOT NULL,
	[TIPO_PERSONA] [int] NULL,
	[CATEGORIA_RIESGO] [varchar](4) NULL,
	[GRUPO_CLASIFICACION] [varchar](4) NOT NULL,
	[CAPACIDAD_PAGO] [int] NULL,
	[COMPORTAMIENTO_PAGO] [int] NULL,
	[AUTORIZACION] [varchar](1) NULL,
	[ATRASO_CUENTAS_COBRAR_ASOC_OPERA] [int] NOT NULL,
	[FECHA_INFORME_FINANCIERO] [date] NULL,
	[FECHA_REVISION_INFORME] [date] NULL,
	[CATEGORIA_FIJA] [varchar](2) NULL,
	[FECHA_CORTE] [date] NULL,
	[EMPRESA] [int] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_RPT_ESTADO_COLOCACIONES_POR_AREA_Y_DIVISION]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_RPT_ESTADO_COLOCACIONES_POR_AREA_Y_DIVISION](
	[AREA] [float] NULL,
	[DIVISION] [float] NULL,
	[OFICINA] [float] NULL,
	[RANGO_ATRASO] [varchar](100) NULL,
	[SALDO] [decimal](26, 2) NULL,
	[EMPRESA] [int] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_RPT_MAYOR_PROVISION_DETALLE]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_RPT_MAYOR_PROVISION_DETALLE](
	[ID_DEUDOR] [varchar](30) NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NULL,
	[ESTIMACION] [decimal](28, 2) NULL,
	[SALDO] [decimal](28, 2) NULL,
	[MORA] [int] NULL,
	[COD_OFICINA] [int] NULL,
	[DES_OFICINA] [varchar](100) NULL,
	[COD_CAPACIDAD_PAGO] [int] NULL,
	[COD_TIPO_COMPORTAMIENTO_PAGO] [int] NULL,
	[AUTORIZACION] [varchar](1) NULL,
	[COD_GRUPO_CLASIFICACION] [varchar](4) NULL,
	[COD_SISTEMA] [int] NULL,
	[DES_SISTEMA] [varchar](100) NULL,
	[NOMBRE] [varchar](255) NULL,
	[EMPRESA] [int] NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[TIPO_OPERACION] [int] NULL,
	[SALDO_TOTAL] [decimal](25, 2) NULL,
	[ESTIMACION_GENERICA_DIRECTA] [decimal](25, 2) NULL,
	[ESTIMACION_GENERICA_CONTINGENTE] [decimal](25, 2) NULL,
	[ESTIMACION_ESPECIFICA_DIRECTA_PARTE_CUBIERTA] [decimal](25, 2) NULL,
	[ESTIMACION_ESPECIFICA_DIRECTA_PARTE_DESCUBIERTA] [decimal](25, 2) NULL,
	[ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_CUBIERTA] [decimal](25, 2) NULL,
	[ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_DESCUBIERTA] [decimal](25, 2) NULL,
	[ESTIMACION_CONTRA_CICLICA_DIRECTA] [decimal](25, 2) NULL,
	[ESTIMACION_CONTRA_CICLICA_CONTINGENTE] [decimal](25, 2) NULL,
	[AGRUPACION] [varchar](1000) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_RPT_MAYOR_PROVISION_GENERAL]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_RPT_MAYOR_PROVISION_GENERAL](
	[ID_DEUDOR] [varchar](30) NULL,
	[ESTIMACION] [decimal](28, 2) NULL,
	[SALDO] [decimal](28, 2) NULL,
	[MORA] [int] NULL,
	[SISTEMA] [int] NULL,
	[OFICINA] [int] NULL,
	[EMPRESA] [int] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_RPT_MOROSIDAD_REGION_DETALLE]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_RPT_MOROSIDAD_REGION_DETALLE](
	[REGION] [varchar](100) NULL,
	[OFICINA] [int] NULL,
	[DETALLE] [varchar](100) NULL,
	[SALDO] [decimal](26, 2) NULL,
	[PORCENTAJE] [decimal](6, 3) NULL,
	[EMPRESA] [int] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_RPT_MOROSIDAD_REGION_GENERAL]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_RPT_MOROSIDAD_REGION_GENERAL](
	[DETALLE] [varchar](100) NULL,
	[SALDO] [decimal](26, 2) NULL,
	[PORCENTAJE] [decimal](6, 3) NULL,
	[EMPRESA] [int] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_SICAD_TH_CREDITO_PRINCIPAL_DIRECTO_MES_ANTERIOR]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_SICAD_TH_CREDITO_PRINCIPAL_DIRECTO_MES_ANTERIOR](
	[ID_AUTORIZADO] [int] NULL,
	[ID_CAPACIDAD_PAGO] [int] NULL,
	[ID_CATEGORIA_RIESGO] [int] NULL,
	[ID_CLIENTE] [int] NULL,
	[ID_COMPORTAMIENTO_PAGO] [int] NULL,
	[ID_EMPRESA] [int] NULL,
	[ID_ESTADO_OPERACION] [int] NULL,
	[ID_FECHA_AMORTIZACION] [int] NULL,
	[ID_FECHA_CORTE] [int] NULL,
	[ID_FECHA_FORMALIZACION] [int] NULL,
	[ID_FECHA_VENCIMIENTO] [int] NULL,
	[ID_GENERADOR_DIVISAS] [int] NULL,
	[ID_GENERO_CLIENTE] [int] NULL,
	[ID_GRUPO_CLASIFICACION] [int] NULL,
	[ID_MONEDA] [int] NULL,
	[ID_OFICINA] [int] NULL,
	[ID_PRODUCTO] [int] NULL,
	[ID_PROVINCIA] [int] NULL,
	[ID_RANGO_ATRASO] [int] NULL,
	[ID_RANGO_TASA_INTERES] [int] NULL,
	[ID_TASA] [int] NULL,
	[ID_TIPO_BIEN] [int] NULL,
	[ID_TIPO_CARTERA] [int] NULL,
	[ID_TIPO_GARANTIA] [int] NULL,
	[ID_TIPO_MODIFICACION_OPERACION] [int] NULL,
	[ID_TIPO_OPERACION] [int] NULL,
	[ID_TIPO_OPERACION_ESPECIAL] [int] NULL,
	[ID_LIMITE_INFERIOR_TASA_INT_VAR] [int] NULL,
	[ID_LIMITE_SUPERIOR_TASA_INT_VAR] [int] NULL,
	[COD_ACTIVIDAD] [varchar](14) NULL,
	[COD_AUTORIZADO] [int] NULL,
	[COD_CANTON_DESTINO_CREDITO] [int] NULL,
	[COD_CAPACIDAD_PAGO] [int] NULL,
	[COD_CATEGORIA_RIESGO] [varchar](2) NULL,
	[COD_CLIENTE] [varchar](30) NULL,
	[COD_COMPORTAMIENTO_PAGO] [int] NULL,
	[COD_EMPRESA] [int] NULL,
	[COD_ESTADO_OPERACION] [int] NULL,
	[COD_GENERADOR_DIVISAS] [int] NULL,
	[COD_GENERO_CLIENTE] [int] NULL,
	[COD_GRUPO_CLASIFICACION] [varchar](30) NULL,
	[COD_MONEDA] [int] NULL,
	[COD_OFICINA] [int] NULL,
	[COD_OPERACION] [varchar](50) NULL,
	[COD_PRODUCTO] [int] NULL,
	[COD_PROVINCIA_DESTINO_CREDITO] [int] NULL,
	[COD_RANGO_ATRASO] [int] NULL,
	[COD_RANGO_TASA_INTERES] [int] NULL,
	[COD_SISTEMA] [int] NULL,
	[COD_TASA] [int] NULL,
	[COD_TIPO_BIEN] [int] NULL,
	[COD_TIPO_CARTERA] [int] NULL,
	[COD_TIPO_CLIENTE] [int] NULL,
	[COD_TIPO_GARANTIA] [int] NULL,
	[COD_TIPO_MODIFICACION_OPERACION] [int] NULL,
	[COD_TIPO_OPERACION] [int] NULL,
	[COD_TIPO_OPERACION_ESPECIAL] [int] NULL,
	[COD_TIPO_PRODUCTO] [int] NULL,
	[COD_LIMITE_INFERIOR_TASA_INT_VAR] [int] NULL,
	[COD_LIMITE_SUPERIOR_TASA_INT_VAR] [int] NULL,
	[AJUST_PRINCIPAL] [decimal](25, 2) NULL,
	[DIAS_CAPITAL] [int] NULL,
	[DIAS_INTERES] [int] NULL,
	[MAXIMO_DIAS] [int] NULL,
	[MONTO_DESEMBOLSADO] [decimal](25, 2) NULL,
	[MONTO_MITIGADOR] [decimal](25, 2) NULL,
	[NUM_GARANTIA] [varchar](25) NULL,
	[PLAZO_OPERACION] [int] NULL,
	[PLAZO_RESTANTE] [int] NULL,
	[PRINCIPAL_CONTINGENTE] [decimal](25, 2) NULL,
	[PRINCIPAL_DIRECTO] [decimal](25, 2) NULL,
	[PROVISION_CONTINGENTE] [decimal](25, 2) NULL,
	[PROVISION_PRINCIPAL] [decimal](25, 2) NULL,
	[PROVISION_PRODUCTO] [decimal](25, 2) NULL,
	[PROVISION_SALDO_CC_ASOC_OPERA] [decimal](25, 2) NULL,
	[PROVISION_SALDO_X_DES_COMP] [decimal](25, 2) NULL,
	[PROVISION_TOTAL] [decimal](25, 2) NULL,
	[RECUPERACION_PRINCIPAL] [decimal](25, 2) NULL,
	[SALDO_CUENTAS_COBRAR_ASOC_OPERA] [decimal](25, 2) NULL,
	[SALDO_EQUIVALENTE_CONTINGENTE] [decimal](25, 2) NULL,
	[SALDO_INICIAL] [decimal](25, 2) NULL,
	[SALDO_INTERES] [decimal](25, 2) NULL,
	[SALDO_PEND_UTIL_SIN_COMPRO] [decimal](25, 2) NULL,
	[SALDO_POR_DESEMBOLSAR] [decimal](25, 2) NULL,
	[SALDO_PRINCIPAL_DEP_PREVIO] [decimal](25, 2) NULL,
	[SALDO_TOTAL] [decimal](25, 2) NULL,
	[SALDO_X_DESEMB_COMP] [decimal](25, 2) NULL,
	[TASA_INTERES] [decimal](5, 2) NULL,
	[ID_FECHA_CAMBIO_TIPO_TASA] [int] NULL,
	[LIMITE_INF_TASA_INT_VAR] [numeric](5, 2) NULL,
	[LIMITE_SUP_TASA_INT_VAR] [numeric](5, 2) NULL,
	[MONTO_ESTIMACION_GEN_DIRECTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_GEN_CONTIGEN] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESP_DIRECTA_CUB] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESP_DIRECTA_DESCUB] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESP_CONTIGEN_CUB] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESP_CONTIGEN_DESCUB] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_CON_CICLICA_DIRECTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_CON_CICLICA_CONTIGEN] [decimal](25, 2) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_SUMA_SALDOS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_SUMA_SALDOS](
	[COD_OPERACION] [varchar](25) NULL,
	[SUMA_SALDOS] [decimal](29, 4) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_TD_CLIENTE]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[AUX_TD_CLIENTE](
	[COD_CLIENTE] [varchar](30) NULL,
	[COD_TIPO_CLIENTE] [int] NULL,
	[COD_CATEG_RIESGO] [varchar](50) NULL,
	[COD_GRUPO_CLASIFICACION] [varchar](30) NULL,
	[DES_CLIENTE] [varchar](150) NULL,
	[DES_TIPO_CLIENTE] [varchar](50) NULL,
	[COD_GENERO] [varchar](2) NULL,
	[DES_GENERO] [varchar](50) NULL,
	[COD_GENERADOR_DIVISAS] [varchar](2) NULL,
	[DES_GENERADOR_DIVISAS] [varchar](50) NULL,
	[NIVEL_CAPACIDAD_PAGO] [varchar](2) NULL,
	[COMPORTAMIENTO_HISTORICO] [varchar](2) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AUX_TIPO_CAMBIO]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[AUX_TIPO_CAMBIO](
	[FECHA_CORTE] [date] NULL,
	[MONEDA] [int] NULL,
	[VALOR] [decimal](15, 2) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
/****** Object:  Table [dbo].[AUX_TIPO_CAMBIO_CONTEO]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[AUX_TIPO_CAMBIO_CONTEO](
	[CONTADOR] [int] NULL,
	[FECHA_CORTE] [date] NULL,
	[FECHA] [int] NULL,
	[MONEDA] [int] NULL,
	[VALOR] [decimal](15, 2) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
/****** Object:  Table [dbo].[AUX_TIPO_CAMBIO_LLAVES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[AUX_TIPO_CAMBIO_LLAVES](
	[CONTADOR] [int] NULL,
	[FECHA] [int] NULL,
	[MONEDA] [int] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
/****** Object:  Table [dbo].[BIENES_REALIZABLES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[BIENES_REALIZABLES](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_FORMA_ADQUISICION_BIEN] [int] NULL,
	[ID_BIEN_REALIZABLE] [varchar](25) NOT NULL,
	[IND_GARANTIA] [varchar](6) NULL,
	[ID_GARANTIA] [varchar](25) NULL,
	[ID_BIEN] [varchar](25) NULL,
	[COD_TIPO_BIEN] [int] NULL,
	[FECHA_ADJUDICACION_DACION_BIEN] [date] NULL,
	[SALDO_REGISTRO_CONTABLE] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_SALDO_REGISTRO_CONTABLE] [int] NULL,
	[CUENTA_CATALOGO_SUGEF] [int] NULL,
	[COD_TIPO_CATALOGO_SUGEF] [int] NULL,
	[FECHA_ULTIMA_TASACION_BIEN] [date] NULL,
	[MONTO_TASACION] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_MONTO_TASACION] [int] NULL,
	[COD_TIPO_PERSONA_TASADOR] [int] NULL,
	[ID_TASADOR] [varchar](30) NULL,
	[COD_TIPO_PERSONA_EMPRESA_TASADORA] [int] NULL,
	[ID_EMPRESA_TASADORA] [varchar](30) NULL,
	[SALDO_CONTABLE_CREDITO_CANCELADO] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_SALDO_CONTABLE_CREDITO_CANCELADO] [int] NULL,
	[MONTO_ESTIMACION] [decimal](25, 2) NULL,
 CONSTRAINT [PK_BIENES_REALIZABLES] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_BIEN_REALIZABLE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[BIENES_REALIZABLES_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[BIENES_REALIZABLES_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[COD_FORMA_ADQUISICION_BIEN] [int] NULL,
	[ID_BIEN_REALIZABLE] [varchar](25) NOT NULL,
	[IND_GARANTIA] [varchar](6) NULL,
	[ID_GARANTIA] [varchar](25) NULL,
	[ID_BIEN] [varchar](25) NULL,
	[COD_TIPO_BIEN] [int] NULL,
	[FECHA_ADJUDICACION_DACION_BIEN] [date] NULL,
	[SALDO_REGISTRO_CONTABLE] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_SALDO_REGISTRO_CONTABLE] [int] NULL,
	[CUENTA_CATALOGO_SUGEF] [int] NULL,
	[COD_TIPO_CATALOGO_SUGEF] [int] NULL,
	[FECHA_ULTIMA_TASACION_BIEN] [date] NULL,
	[MONTO_TASACION] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_MONTO_TASACION] [int] NULL,
	[COD_TIPO_PERSONA_TASADOR] [int] NULL,
	[ID_TASADOR] [varchar](30) NULL,
	[COD_TIPO_PERSONA_EMPRESA_TASADORA] [int] NULL,
	[ID_EMPRESA_TASADORA] [varchar](30) NULL,
	[SALDO_CONTABLE_CREDITO_CANCELADO] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_SALDO_CONTABLE_CREDITO_CANCELADO] [int] NULL,
	[MONTO_ESTIMACION] [decimal](25, 2) NULL,
 CONSTRAINT [PK_BIENES_REALIZABLES_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_BIEN_REALIZABLE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[BIENES_REALIZABLES_NO_REPORTADOS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[BIENES_REALIZABLES_NO_REPORTADOS](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_BIEN_REALIZABLE] [varchar](25) NOT NULL,
	[IND_GARANTIA] [varchar](6) NULL,
	[ID_GARANTIA] [varchar](25) NULL,
	[ID_BIEN] [varchar](25) NULL,
	[COD_TIPO_BIEN] [int] NULL,
	[COD_TIPO_MOTIVO_BIEN_NO_REPORTADO] [int] NULL,
	[ULTIMO_VALOR_CONTABLE] [decimal](25, 2) NULL,
	[VALOR_RECUPERADO_NETO] [decimal](25, 2) NULL,
	[ID_OPERACION_FINANCIAMIENTO] [varchar](25) NULL,
 CONSTRAINT [PK_BIENES_REALIZABLES_NO_REPORTADOS] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_BIEN_REALIZABLE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[BIENES_REALIZABLES_NO_REPORTADOS_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[BIENES_REALIZABLES_NO_REPORTADOS_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_BIEN_REALIZABLE] [varchar](25) NOT NULL,
	[COD_TIPO_MOTIVO_BIEN_NO_REPORTADO] [int] NULL,
	[VALOR_RECUPERADO_NETO] [decimal](25, 2) NULL,
	[ID_OPERACION_FINANCIAMIENTO] [varchar](25) NULL,
 CONSTRAINT [PK_BIENES_REALIZABLES_NO_REPORTADOS_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_BIEN_REALIZABLE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[BIENES_REALIZABLES_OPERACIONES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[BIENES_REALIZABLES_OPERACIONES](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_BIEN_REALIZABLE] [varchar](25) NOT NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NOT NULL,
	[ID_DEUDOR] [varchar](30) NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
 CONSTRAINT [PK_BIENES_REALIZABLES_OPERACIONES] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[COD_TIPO_PERSONA_DEUDOR] ASC,
	[ID_DEUDOR] ASC,
	[ID_OPERACION] ASC,
	[ID_BIEN_REALIZABLE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[BIENES_REALIZABLES_OPERACIONES_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[BIENES_REALIZABLES_OPERACIONES_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_BIEN_REALIZABLE] [varchar](25) NOT NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NOT NULL,
	[ID_DEUDOR] [varchar](30) NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
 CONSTRAINT [PK_BIENES_REALIZABLES_OPERACIONES_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[COD_TIPO_PERSONA_DEUDOR] ASC,
	[ID_DEUDOR] ASC,
	[ID_OPERACION] ASC,
	[ID_BIEN_REALIZABLE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[bloque_respaldo]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[bloque_respaldo](
	[ID_BLOQUE] [int] IDENTITY(1,1) NOT NULL,
	[COD_BLOQUE] [int] NOT NULL,
	[DES_BLOQUE] [varchar](255) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[CATALOGO_CUENTAS_BV]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[CATALOGO_CUENTAS_BV](
	[CUENTA] [varchar](20) NULL,
	[DESCRIPCION_CUENTA] [varchar](100) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_PERSONA] [varchar](30) NULL,
	[COD_TIPO_MONEDA_MONTO] [int] NULL,
	[MONTO_ORIGINAL] [decimal](25, 2) NULL,
	[COD_TIPO_CATALOGO_SUGEF] [int] NULL,
	[CUENTA_CONTABLE_SALDO_PRINCIPAL] [bigint] NULL,
	[SALDO_PRINCIPAL] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_SALDO_PRODUCTOS_COBRAR] [bigint] NULL,
	[SALDO_PRODUCTOS_COBRAR] [decimal](25, 2) NULL,
	[FECHA_REGISTRO_CONTABLE] [date] NULL,
	[FECHA_EXIGIBILIDAD] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[ESTIMACION_REGISTRADA] [decimal](25, 2) NULL,
	[ID_DEPENDENCIA] [int] NULL,
	[DIAS_MORA] [int] NULL,
 CONSTRAINT [PK_CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_PERSONA] [varchar](30) NULL,
	[COD_TIPO_MONEDA_MONTO] [int] NULL,
	[MONTO_ORIGINAL] [decimal](25, 2) NULL,
	[COD_TIPO_CATALOGO_SUGEF] [int] NULL,
	[CUENTA_CONTABLE_SALDO_PRINCIPAL] [bigint] NULL,
	[SALDO_PRINCIPAL] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_SALDO_PRODUCTOS_COBRAR] [bigint] NULL,
	[SALDO_PRODUCTOS_COBRAR] [decimal](25, 2) NULL,
	[FECHA_REGISTRO_CONTABLE] [date] NULL,
	[FECHA_EXIGIBILIDAD] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[ESTIMACION_REGISTRADA] [decimal](25, 2) NULL,
	[ID_DEPENDENCIA] [int] NULL,
	[DIAS_MORA] [int] NULL,
 CONSTRAINT [PK_CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[CUOTAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[CUOTAS](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_CUOTA] [int] NOT NULL,
	[NUM_CUOTA_ATRASADA] [int] NOT NULL,
	[DIAS_ATRASO] [int] NULL,
	[MONTO_CUOTA_ATRASADA] [decimal](25, 2) NULL,
 CONSTRAINT [PK_CUOTAS] PRIMARY KEY NONCLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_TIPO_CUOTA] ASC,
	[NUM_CUOTA_ATRASADA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[CUOTAS_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[CUOTAS_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_CUOTA] [int] NOT NULL,
	[NUM_CUOTA_ATRASADA] [int] NOT NULL,
	[DIAS_ATRASO] [int] NULL,
	[MONTO_CUOTA_ATRASADA] [decimal](25, 2) NULL,
 CONSTRAINT [PK_CUOTAS_ENTIDAD] PRIMARY KEY NONCLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_TIPO_CUOTA] ASC,
	[NUM_CUOTA_ATRASADA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[CUOTAS_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[CUOTAS_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_CUOTA] [int] NOT NULL,
	[NUM_CUOTA_ATRASADA] [int] NOT NULL,
	[DIAS_ATRASO] [int] NULL,
	[MONTO_CUOTA_ATRASADA] [decimal](25, 2) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[CuotasOperacion]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[CuotasOperacion](
	[ID_OPERACION] [varchar](25) NOT NULL,
	[TOTAL_CUOTAS] [int] NULL,
	[FRECUENCIA_DIAS] [int] NULL,
	[TIPO_PERSONA] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[MONTO] [decimal](22, 2) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DEUDORES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[DEUDORES](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA] [int] NOT NULL,
	[ID_DEUDOR] [varchar](30) NOT NULL,
	[COD_SECTOR_ECONOMICO] [int] NULL,
	[COD_GRUPO_CLASIFICACION] [varchar](4) NULL,
	[COD_CATEGORIA_RIESGO] [varchar](4) NULL,
	[COD_CAPACIDAD_PAGO] [int] NULL,
	[COD_CONDICIONES_ESPECIALES_DEUDOR] [int] NULL,
	[FECHA_CALIFICACION_RIESGO] [date] NULL,
	[COD_CATEGORIA_ANTERIOR] [varchar](4) NULL,
	[IND_GENERADOR_DIVISAS] [varchar](1) NULL,
	[COD_TIPO_ASIGNACION_CALIFICACION] [int] NULL,
	[COD_CATEGORIA_CALIFICACION] [int] NULL,
	[COD_CALIFICACION_RIESGO] [varchar](30) NULL,
	[COD_EMPRESA_CALIFICADORA] [int] NULL,
	[IND_VINCULADO_ENTIDAD] [varchar](1) NULL,
	[IND_VINCULADO_GRUPO_FINANCIERO] [varchar](1) NULL,
	[ID_GRUPO] [int] NULL,
	[COD_TIPO_COMPORTAMIENTO_PAGO] [int] NULL,
	[COD_TIPO_ACTIVIDAD_ECONOMICA_DEUDOR] [varchar](14) NULL,
	[AUTORIZACION] [varchar](1) NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_DEUDORES] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[COD_TIPO_PERSONA] ASC,
	[ID_DEUDOR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DEUDORES_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[DEUDORES_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA] [int] NOT NULL,
	[ID_DEUDOR] [varchar](30) NOT NULL,
	[COD_SECTOR_ECONOMICO] [int] NULL,
	[COD_CAPACIDAD_PAGO] [int] NULL,
	[COD_CONDICIONES_ESPECIALES_DEUDOR] [int] NULL,
	[IND_GENERADOR_DIVISAS] [varchar](1) NULL,
	[COD_TIPO_ASIGNACION_CALIFICACION] [int] NULL,
	[COD_CATEGORIA_CALIFICACION] [int] NULL,
	[COD_CALIFICACION_RIESGO] [varchar](30) NULL,
	[COD_EMPRESA_CALIFICADORA] [int] NULL,
	[IND_VINCULADO_ENTIDAD] [varchar](1) NULL,
	[IND_VINCULADO_GRUPO_FINANCIERO] [varchar](1) NULL,
	[ID_GRUPO] [int] NULL,
	[COD_TIPO_ACTIVIDAD_ECONOMICA_DEUDOR] [varchar](14) NULL,
	[AUTORIZACION] [varchar](1) NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_DEUDORES_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[COD_TIPO_PERSONA] ASC,
	[ID_DEUDOR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DEUDORES_RECALIFICADOS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[DEUDORES_RECALIFICADOS](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA] [int] NOT NULL,
	[ID_DEUDOR] [varchar](30) NOT NULL,
	[COD_CATEGORIA_ASIGNADA] [varchar](4) NULL,
	[COD_GRUPO_ASIGNADO] [varchar](4) NULL,
	[COD_ENTIDAD_RECALIFICA] [int] NOT NULL,
	[FECHA_RECALIFICACION] [date] NULL,
	[FECHA_RECALIFICACION_HASTA] [date] NULL,
	[ESTADO] [varchar](1) NULL,
	[COD_CATEGORIA_REEMPLAZA] [varchar](4) NULL,
	[COD_GRUPO_REEMPLAZA] [varchar](4) NULL,
	[PERIODICIDAD] [decimal](8, 2) NULL,
	[OBSERVACIONES] [varchar](255) NULL,
 CONSTRAINT [PK_DEUDORES_RECALIFICADOS] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[COD_TIPO_PERSONA] ASC,
	[ID_DEUDOR] ASC,
	[COD_ENTIDAD_RECALIFICA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[DEUDORES_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[DEUDORES_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA] [int] NOT NULL,
	[ID_DEUDOR] [varchar](30) NOT NULL,
	[COD_SECTOR_ECONOMICO] [int] NULL,
	[COD_GRUPO_CLASIFICACION] [varchar](4) NULL,
	[COD_CATEGORIA_RIESGO] [varchar](4) NULL,
	[COD_CAPACIDAD_PAGO] [int] NULL,
	[COD_CONDICIONES_ESPECIALES_DEUDOR] [int] NULL,
	[FECHA_CALIFICACION_RIESGO] [date] NULL,
	[COD_CATEGORIA_ANTERIOR] [varchar](4) NULL,
	[IND_GENERADOR_DIVISAS] [varchar](1) NULL,
	[COD_TIPO_ASIGNACION_CALIFICACION] [int] NULL,
	[COD_CATEGORIA_CALIFICACION] [int] NULL,
	[COD_CALIFICACION_RIESGO] [varchar](30) NULL,
	[COD_EMPRESA_CALIFICADORA] [int] NULL,
	[IND_VINCULADO_ENTIDAD] [varchar](1) NULL,
	[IND_VINCULADO_GRUPO_FINANCIERO] [varchar](1) NULL,
	[ID_GRUPO] [int] NULL,
	[COD_TIPO_COMPORTAMIENTO_PAGO] [int] NULL,
	[COD_TIPO_ACTIVIDAD_ECONOMICA_DEUDOR] [varchar](14) NULL,
	[AUTORIZACION] [varchar](1) NULL,
	[COD_SISTEMA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[ENTIDAD_CONTABLE_ESTADOS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[ENTIDAD_CONTABLE_ESTADOS](
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NULL,
	[CUENTA] [bigint] NULL,
	[TIPO_CATALOGO_SUGEF] [int] NULL,
	[DEBITO] [decimal](25, 2) NULL,
	[CREDITO] [decimal](25, 2) NULL,
	[SALDO_FINAL] [decimal](25, 2) NULL,
	[NOTA_TEXTO] [varchar](5000) NULL,
	[NOTA_ARCHIVO] [varchar](255) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = ROW
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[EXCEL]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[EXCEL](
	[ID_OPERACION] [varchar](167) NULL,
	[OFI] [varchar](41) NULL,
	[MON] [varchar](41) NULL,
	[PR] [decimal](2, 0) NULL,
	[OPERACI] [decimal](8, 0) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[FACTURAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[FACTURAS](
	[MIN_VENCIMIENTO] [date] NULL,
	[MAX_VENCIMIENTO] [date] NULL,
	[IdLinea] [numeric](8, 0) NOT NULL,
	[IdOperacion] [numeric](8, 0) NOT NULL
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[GARANTIA_ANTERIOR_NO_APLICA] [int] NULL,
 CONSTRAINT [PK_GARANTIA_OPERACION] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[GARANTIA_ANTERIOR_NO_APLICA] [int] NULL,
 CONSTRAINT [PK_GARANTIA_OPERACION_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDO] [int] NOT NULL,
	[MONTO_MITIGADOR_FIDEICOMETIDO] [decimal](25, 2) NULL,
	[VALOR_NOMINAL_FIDEICOMETIDO] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL_FIDEICOMETIDO] [int] NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO] [int] NOT NULL,
	[PORC_RESPONSABILIDAD_FIDEICOMETIDO] [decimal](5, 2) NULL,
	[FECHA_CONSTITUCION_GARANTIA_FIDEICOMETIDA] [date] NULL,
	[FECHA_VENCIMIENTO_GARANTIA_FIDEICOMETIDA] [date] NULL,
 CONSTRAINT [PK_GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_1] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC,
	[ID_GARANTIA_FIDEICOMETIDA] ASC,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDO] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDO] [int] NOT NULL,
	[VALOR_NOMINAL_FIDEICOMETIDO] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL_FIDEICOMETIDO] [int] NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO] [int] NOT NULL,
	[FECHA_CONSTITUCION_GARANTIA_FIDEICOMETIDA] [date] NULL,
	[FECHA_VENCIMIENTO_GARANTIA_FIDEICOMETIDA] [date] NULL,
 CONSTRAINT [PK_GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC,
	[ID_GARANTIA_FIDEICOMETIDA] ASC,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDO] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDA] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDA] [int] NOT NULL,
	[COD_GRADO_GRAVAMENES_FIDEICOMETIDA] [int] NOT NULL,
	[COD_TIPO_PERSONA_ACREEDOR_FIDEICOMETIDA] [int] NOT NULL,
	[ID_ACREEDOR_FIDEICOMETIDA] [varchar](30) NOT NULL,
	[MONTO_GRADO_GRAVAMENES_FIDEICOMETIDA] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_GRADO_GRAVAMEN_FIDEICOMETIDA] [int] NULL,
 CONSTRAINT [PK_GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC,
	[ID_GARANTIA_FIDEICOMETIDA] ASC,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDA] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDA] ASC,
	[COD_GRADO_GRAVAMENES_FIDEICOMETIDA] ASC,
	[COD_TIPO_PERSONA_ACREEDOR_FIDEICOMETIDA] ASC,
	[ID_ACREEDOR_FIDEICOMETIDA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDA] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDA] [int] NOT NULL,
	[COD_GRADO_GRAVAMENES_FIDEICOMETIDA] [int] NOT NULL,
	[COD_TIPO_PERSONA_ACREEDOR_FIDEICOMETIDA] [int] NOT NULL,
	[ID_ACREEDOR_FIDEICOMETIDA] [varchar](30) NOT NULL,
	[MONTO_GRADO_GRAVAMENES_FIDEICOMETIDA] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_GRADO_GRAVAMEN_FIDEICOMETIDA] [int] NULL,
 CONSTRAINT [PK_GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC,
	[ID_GARANTIA_FIDEICOMETIDA] ASC,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDA] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDA] ASC,
	[COD_GRADO_GRAVAMENES_FIDEICOMETIDA] ASC,
	[COD_TIPO_PERSONA_ACREEDOR_FIDEICOMETIDA] ASC,
	[ID_ACREEDOR_FIDEICOMETIDA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDA] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDA] [int] NOT NULL,
	[COD_GRADO_GRAVAMENES_FIDEICOMETIDA] [int] NOT NULL,
	[COD_TIPO_PERSONA_ACREEDOR_FIDEICOMETIDA] [int] NOT NULL,
	[ID_ACREEDOR_FIDEICOMETIDA] [varchar](30) NOT NULL,
	[MONTO_GRADO_GRAVAMENES_FIDEICOMETIDA] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_GRADO_GRAVAMEN_FIDEICOMETIDA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDO] [int] NOT NULL,
	[MONTO_MITIGADOR_FIDEICOMETIDO] [decimal](25, 2) NULL,
	[VALOR_NOMINAL_FIDEICOMETIDO] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL_FIDEICOMETIDO] [int] NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO] [int] NOT NULL,
	[PORC_RESPONSABILIDAD_FIDEICOMETIDO] [decimal](5, 2) NULL,
	[FECHA_CONSTITUCION_GARANTIA_FIDEICOMETIDA] [date] NULL,
	[FECHA_VENCIMIENTO_GARANTIA_FIDEICOMETIDA] [date] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_GRAVAMEN]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_GRAVAMEN](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[COD_GRADO_GRAVAMENES] [int] NOT NULL,
	[COD_TIPO_PERSONA_ACREEDOR] [int] NOT NULL,
	[ID_ACREEDOR] [varchar](30) NOT NULL,
	[MONTO_GRADO_GRAVAMEN] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_MONTO_GRADO_GRAVAMEN] [int] NULL,
 CONSTRAINT [PK_GARANTIA_OPERACION_GRAVAMEN] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC,
	[COD_GRADO_GRAVAMENES] ASC,
	[COD_TIPO_PERSONA_ACREEDOR] ASC,
	[ID_ACREEDOR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_GRAVAMEN_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_GRAVAMEN_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[COD_GRADO_GRAVAMENES] [int] NOT NULL,
	[COD_TIPO_PERSONA_ACREEDOR] [int] NOT NULL,
	[ID_ACREEDOR] [varchar](30) NOT NULL,
	[MONTO_GRADO_GRAVAMEN] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_MONTO_GRADO_GRAVAMEN] [int] NULL,
 CONSTRAINT [PK_GARANTIA_OPERACION_GRAVAMEN_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC,
	[COD_GRADO_GRAVAMENES] ASC,
	[COD_TIPO_PERSONA_ACREEDOR] ASC,
	[ID_ACREEDOR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_GRAVAMEN_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_GRAVAMEN_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[COD_GRADO_GRAVAMENES] [int] NOT NULL,
	[COD_TIPO_PERSONA_ACREEDOR] [int] NOT NULL,
	[ID_ACREEDOR] [varchar](30) NOT NULL,
	[MONTO_GRADO_GRAVAMEN] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_MONTO_GRADO_GRAVAMEN] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_LISTA]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_LISTA](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_GARANTIA] [int] NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[MONTO_MITIGADOR_FUENTE] [decimal](25, 2) NULL,
	[MONTO_MITIGADOR_CALCULADO] [decimal](25, 2) NULL,
	[IND_INSCRIPCION_GARANTIA] [int] NULL,
	[FECHA_PRESENTACION_REGISTRO_GARANTIA] [date] NULL,
	[PORC_RESPONSABILIDAD_GARANTIA] [decimal](7, 2) NULL,
	[MONTO_VALOR_NOMINAL_GARANTIA] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL_GARANTIA] [int] NULL,
	[PORC_ACEPTACION_FUENTE] [decimal](7, 2) NULL,
	[PORC_ACEPTACION_CALCULADO] [decimal](7, 2) NULL,
	[FECHA_CONSTITUCION_GARANTIA] [date] NULL,
	[FECHA_VENCIMIENTO_GARANTIA] [date] NULL,
 CONSTRAINT [PK_GARANTIA_OPERACION_LISTA] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_LISTA_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_LISTA_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_GARANTIA] [int] NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[IND_INSCRIPCION_GARANTIA] [int] NULL,
	[FECHA_PRESENTACION_REGISTRO_GARANTIA] [date] NULL,
	[MONTO_VALOR_NOMINAL_GARANTIA] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL_GARANTIA] [int] NULL,
	[FECHA_CONSTITUCION_GARANTIA] [date] NULL,
	[FECHA_VENCIMIENTO_GARANTIA] [date] NULL,
 CONSTRAINT [PK_GARANTIA_OPERACION_LISTA_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_LISTA_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_LISTA_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_GARANTIA] [int] NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[MONTO_MITIGADOR_FUENTE] [decimal](25, 2) NULL,
	[MONTO_MITIGADOR_CALCULADO] [decimal](25, 2) NULL,
	[IND_INSCRIPCION_GARANTIA] [int] NULL,
	[FECHA_PRESENTACION_REGISTRO_GARANTIA] [date] NULL,
	[PORC_RESPONSABILIDAD_GARANTIA] [decimal](7, 2) NULL,
	[MONTO_VALOR_NOMINAL_GARANTIA] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL_GARANTIA] [int] NULL,
	[PORC_ACEPTACION_FUENTE] [decimal](7, 2) NULL,
	[PORC_ACEPTACION_CALCULADO] [decimal](7, 2) NULL,
	[FECHA_CONSTITUCION_GARANTIA] [date] NULL,
	[FECHA_VENCIMIENTO_GARANTIA] [date] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_PRIORIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_PRIORIDAD](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[COD_GRADO_PRIORIDADES] [int] NOT NULL,
	[COD_TIPO_PERSONA_BENEFICIARIO] [int] NOT NULL,
	[ID_BENEFICIARIO] [varchar](30) NOT NULL,
	[MONTO_PRIORIDADES] [decimal](25, 2) NULL,
 CONSTRAINT [PK_GARANTIA_OPERACION_PRIORIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC,
	[COD_GRADO_PRIORIDADES] ASC,
	[COD_TIPO_PERSONA_BENEFICIARIO] ASC,
	[ID_BENEFICIARIO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_PRIORIDAD_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_PRIORIDAD_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[COD_GRADO_PRIORIDADES] [int] NOT NULL,
	[COD_TIPO_PERSONA_BENEFICIARIO] [int] NOT NULL,
	[ID_BENEFICIARIO] [varchar](30) NOT NULL,
	[MONTO_PRIORIDADES] [decimal](25, 2) NULL,
 CONSTRAINT [PK_GARANTIA_OPERACION_PRIORIDAD_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC,
	[COD_GRADO_PRIORIDADES] ASC,
	[COD_TIPO_PERSONA_BENEFICIARIO] ASC,
	[ID_BENEFICIARIO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_PRIORIDAD_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_PRIORIDAD_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[COD_GRADO_PRIORIDADES] [int] NOT NULL,
	[COD_TIPO_PERSONA_BENEFICIARIO] [int] NOT NULL,
	[ID_BENEFICIARIO] [varchar](30) NOT NULL,
	[MONTO_PRIORIDADES] [decimal](25, 2) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIA_OPERACION_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIA_OPERACION_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[GARANTIA_ANTERIOR_NO_APLICA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_CARTA_CREDITO]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_CARTA_CREDITO](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[FECHA_CONSTITUCION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_ENTIDAD_CARTA_CREDITO] [varchar](30) NULL,
	[VALOR_NOMINAL] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL] [int] NULL,
	[COD_TIPO_ASIGNACION_CALIFICACION] [int] NULL,
	[COD_CATEGORIA_CALIFICACION] [int] NULL,
	[COD_CALIFICACION_RIESGO] [varchar](30) NULL,
	[COD_EMPRESA_CALIFICADORA] [int] NULL,
 CONSTRAINT [PK_GARANTIAS_CARTA_CREDITO] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_CARTA_CREDITO_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_CARTA_CREDITO_ENTIDAD](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[FECHA_CONSTITUCION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_ENTIDAD_CARTA_CREDITO] [varchar](30) NULL,
	[VALOR_NOMINAL] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL] [int] NULL,
	[COD_TIPO_ASIGNACION_CALIFICACION] [int] NULL,
	[COD_CATEGORIA_CALIFICACION] [int] NULL,
	[COD_CALIFICACION_RIESGO] [varchar](30) NULL,
	[COD_EMPRESA_CALIFICADORA] [int] NULL,
 CONSTRAINT [PK_GARANTIAS_CARTA_CREDITO_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_CARTAS_CREDITO_IMPORTACION]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_CARTAS_CREDITO_IMPORTACION](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_BIEN] [int] NULL,
	[FECHA_CONSTITUCION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[VALOR_NOMINAL_GARANTIA] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL] [int] NULL,
	[IND_POLIZA] [varchar](1) NULL,
 CONSTRAINT [PK_GARANTIAS_CARTAS_CREDITO_IMPORTACION] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_CARTAS_CREDITO_IMPORTACION_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_CARTAS_CREDITO_IMPORTACION_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_BIEN] [int] NULL,
	[FECHA_CONSTITUCION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[VALOR_NOMINAL_GARANTIA] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL] [int] NULL,
 CONSTRAINT [PK_GARANTIAS_CARTAS_CREDITO_IMPORTACION_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_POLIZA] [int] NOT NULL,
	[MONTO_POLIZA] [decimal](25, 2) NOT NULL,
	[FECHA_VENCIMIENTO] [date] NOT NULL,
	[IND_COBERTURA] [varchar](1) NOT NULL,
	[COD_TIPO_PESONA_BENEFICIARIO] [int] NOT NULL,
	[ID_BENEFICIARIO] [varchar](30) NOT NULL,
 CONSTRAINT [PK_GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_POLIZA] ASC,
	[MONTO_POLIZA] ASC,
	[FECHA_VENCIMIENTO] ASC,
	[IND_COBERTURA] ASC,
	[COD_TIPO_PESONA_BENEFICIARIO] ASC,
	[ID_BENEFICIARIO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_POLIZA] [int] NOT NULL,
	[MONTO_POLIZA] [decimal](25, 2) NOT NULL,
	[FECHA_VENCIMIENTO] [date] NOT NULL,
	[IND_COBERTURA] [varchar](1) NOT NULL,
	[COD_TIPO_PESONA_BENEFICIARIO] [int] NOT NULL,
	[ID_BENEFICIARIO] [varchar](30) NOT NULL,
 CONSTRAINT [PK_GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_POLIZA] ASC,
	[MONTO_POLIZA] ASC,
	[FECHA_VENCIMIENTO] ASC,
	[IND_COBERTURA] ASC,
	[COD_TIPO_PESONA_BENEFICIARIO] ASC,
	[ID_BENEFICIARIO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_FACTURAS_CEDIDAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_FACTURAS_CEDIDAS](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[FECHA_CONSTITUCION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_OBLIGADO] [varchar](30) NULL,
	[VALOR_NOMINAL] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL] [int] NULL,
	[COD_TIPO_ASIGNACION_CALIFICACION] [int] NULL,
	[COD_CATEGORIA_CALIFICACION] [int] NULL,
	[COD_CALIFICACION_RIESGO] [varchar](30) NULL,
	[COD_EMPRESA_CALIFICADORA] [int] NULL,
 CONSTRAINT [PK_GARANTIAS_FACTURAS_CEDIDAS] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_FACTURAS_CEDIDAS_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_FACTURAS_CEDIDAS_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[FECHA_CONSTITUCION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_OBLIGADO] [varchar](30) NULL,
	[VALOR_NOMINAL] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL] [int] NULL,
	[COD_TIPO_ASIGNACION_CALIFICACION] [int] NULL,
	[COD_CATEGORIA_CALIFICACION] [int] NULL,
	[COD_CALIFICACION_RIESGO] [varchar](30) NULL,
	[COD_EMPRESA_CALIFICADORA] [int] NULL,
 CONSTRAINT [PK_GARANTIAS_FACTURAS_CEDIDAS_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_FIDEICOMISO]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_FIDEICOMISO](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_LIMITACION] [int] NULL,
	[FECHA_CONSTITUCION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[VALOR_NOMINAL] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL] [int] NULL,
 CONSTRAINT [PK_GARANTIAS_FIDEICOMISO] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_FIDEICOMISO_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_FIDEICOMISO_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_LIMITACION] [int] NULL,
	[FECHA_CONSTITUCION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[VALOR_NOMINAL] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL] [int] NULL,
 CONSTRAINT [PK_GARANTIAS_FIDEICOMISO_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_GARANTIA] [int] NOT NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[IND_INSCRIPCION_FAVOR_FIDUCIARIO] [int] NOT NULL,
	[FECHA_PRESENTACION] [date] NULL,
	[PCJ_ACEPTACION] [decimal](7, 2) NOT NULL,
	[VALOR_NOMINAL] [decimal](22, 0) NOT NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
 CONSTRAINT [PK_GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC,
	[ID_GARANTIA_FIDEICOMETIDA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_GARANTIA] [int] NOT NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[IND_INSCRIPCION_FAVOR_FIDUCIARIO] [int] NOT NULL,
	[FECHA_PRESENTACION] [date] NULL,
	[PCJ_ACEPTACION] [decimal](7, 2) NOT NULL,
	[VALOR_NOMINAL] [decimal](22, 0) NOT NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
 CONSTRAINT [PK_GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC,
	[ID_GARANTIA_FIDEICOMETIDA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[COD_GRADO_GRAVAMEN] [int] NOT NULL,
	[COD_TIPO_PERSONA_ACREEDOR] [int] NOT NULL,
	[ID_ACREEDOR] [varchar](30) NOT NULL,
	[MONTO_GRADO_GRAVAMEN] [decimal](25, 2) NOT NULL,
 CONSTRAINT [PK_GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC,
	[ID_GARANTIA_FIDEICOMETIDA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC,
	[COD_GRADO_GRAVAMEN] ASC,
	[COD_TIPO_PERSONA_ACREEDOR] ASC,
	[ID_ACREEDOR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[COD_GRADO_GRAVAMEN] [int] NOT NULL,
	[COD_TIPO_PERSONA_ACREEDOR] [int] NOT NULL,
	[ID_ACREEDOR] [varchar](30) NOT NULL,
	[MONTO_GRADO_GRAVAMEN] [decimal](25, 2) NOT NULL,
 CONSTRAINT [PK_GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC,
	[ID_GARANTIA_FIDEICOMETIDA] ASC,
	[COD_TIPO_MITIGADOR] ASC,
	[COD_TIPO_DOCUMENTO_LEGAL] ASC,
	[COD_GRADO_GRAVAMEN] ASC,
	[COD_TIPO_PERSONA_ACREEDOR] ASC,
	[ID_ACREEDOR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_FIDUCIARIAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_FIDUCIARIAS](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_FIADOR] [varchar](30) NULL,
	[COD_TIPO_ASIGNACION_CALIFICACION] [int] NULL,
	[COD_CATEGORIA_CALIFICACION] [int] NULL,
	[COD_CALIFICACION_RIESGO] [varchar](30) NULL,
	[COD_EMPRESA_CALIFICADORA] [int] NULL,
	[SALARIO_NETO_FIADOR] [decimal](25, 2) NULL,
	[FECHA_VERIFICACION_ASALARIADO] [date] NULL,
 CONSTRAINT [PK_GARANTIAS_FIDUCIARIAS] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_FIDUCIARIAS_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_FIDUCIARIAS_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_FIADOR] [varchar](30) NULL,
	[COD_TIPO_ASIGNACION_CALIFICACION] [int] NULL,
	[COD_CATEGORIA_CALIFICACION] [int] NULL,
	[COD_CALIFICACION_RIESGO] [varchar](30) NULL,
	[COD_EMPRESA_CALIFICADORA] [int] NULL,
	[SALARIO_NETO_FIADOR] [decimal](25, 2) NULL,
	[FECHA_VERIFICACION_ASALARIADO] [datetime] NULL,
 CONSTRAINT [PK_GARANTIAS_FIDUCIARIAS_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_REALES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_REALES](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_BIEN] [int] NULL,
	[ID_BIEN] [varchar](25) NULL,
	[MONTO_ULTIMA_TASACION_TERRENO] [decimal](25, 2) NULL,
	[MONTO_ULTIMA_TASACION_NO_TERRENO] [decimal](25, 2) NULL,
	[FECHA_ULTIMA_TASACION_GARANTIA] [date] NULL,
	[MONTO_TASACION_ACTUALIZADA_TERRENO] [decimal](25, 2) NULL,
	[MONTO_TASACION_ACTUALIZADA_NO_TERRENO] [decimal](25, 2) NULL,
	[FECHA_ULTIMO_SEGUIMIENTO] [date] NULL,
	[FECHA_CONSTRUCCION] [date] NULL,
	[COD_TIPO_PERSONA_TASADOR] [int] NULL,
	[ID_TASADOR] [varchar](30) NULL,
	[COD_TIPO_PERSONA_EMPRESA_TASADORA] [int] NULL,
	[ID_EMPRESA_TASADORA] [varchar](30) NULL,
	[IND_POLIZA] [varchar](1) NULL,
 CONSTRAINT [PK_GARANTIAS_REALES] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_REALES_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_REALES_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_BIEN] [int] NULL,
	[ID_BIEN] [varchar](25) NULL,
	[MONTO_ULTIMA_TASACION_TERRENO] [decimal](25, 2) NULL,
	[MONTO_ULTIMA_TASACION_NO_TERRENO] [decimal](25, 2) NULL,
	[FECHA_ULTIMA_TASACION_GARANTIA] [date] NULL,
	[FECHA_ULTIMO_SEGUIMIENTO] [date] NULL,
	[FECHA_CONSTRUCCION] [date] NULL,
	[COD_TIPO_PERSONA_TASADOR] [int] NULL,
	[ID_TASADOR] [varchar](30) NULL,
	[COD_TIPO_PERSONA_EMPRESA_TASADORA] [int] NULL,
	[ID_EMPRESA_TASADORA] [varchar](30) NULL,
 CONSTRAINT [PK_GARANTIAS_REALES_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_REALES_POLIZA]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_REALES_POLIZA](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_POLIZA] [int] NOT NULL,
	[MONTO_POLIZA] [decimal](25, 2) NOT NULL,
	[FECHA_VENCIMIENTO] [date] NOT NULL,
	[IND_COBERTURA_POLIZA] [varchar](1) NOT NULL,
	[COD_TIPO_PERSONA_BENEFICIARIO] [int] NOT NULL,
	[ID_BENEFICIARIO] [varchar](30) NOT NULL,
 CONSTRAINT [PK_GARANTIAS_REALES_POLIZA] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_POLIZA] ASC,
	[MONTO_POLIZA] ASC,
	[FECHA_VENCIMIENTO] ASC,
	[IND_COBERTURA_POLIZA] ASC,
	[COD_TIPO_PERSONA_BENEFICIARIO] ASC,
	[ID_BENEFICIARIO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_REALES_POLIZA_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_REALES_POLIZA_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_POLIZA] [int] NOT NULL,
	[MONTO_POLIZA] [decimal](25, 2) NOT NULL,
	[FECHA_VENCIMIENTO] [date] NOT NULL,
	[IND_COBERTURA_POLIZA] [varchar](1) NOT NULL,
	[COD_TIPO_PERSONA_BENEFICIARIO] [int] NOT NULL,
	[ID_BENEFICIARIO] [varchar](30) NOT NULL,
 CONSTRAINT [PK_GARANTIAS_REALES_POLIZA_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC,
	[COD_TIPO_POLIZA] ASC,
	[MONTO_POLIZA] ASC,
	[FECHA_VENCIMIENTO] ASC,
	[IND_COBERTURA_POLIZA] ASC,
	[COD_TIPO_PERSONA_BENEFICIARIO] ASC,
	[ID_BENEFICIARIO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_REALES_POLIZA_RESP_SP]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_REALES_POLIZA_RESP_SP](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_POLIZA] [int] NOT NULL,
	[MONTO_POLIZA] [decimal](25, 2) NOT NULL,
	[FECHA_VENCIMIENTO] [date] NOT NULL,
	[IND_COBERTURA_POLIZA] [varchar](1) NOT NULL,
	[COD_TIPO_PERSONA_BENEFICIARIO] [int] NOT NULL,
	[ID_BENEFICIARIO] [varchar](30) NOT NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_REALES_RESP_SP]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_REALES_RESP_SP](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_BIEN] [int] NULL,
	[ID_BIEN] [varchar](25) NULL,
	[MONTO_ULTIMA_TASACION_TERRENO] [decimal](25, 2) NULL,
	[MONTO_ULTIMA_TASACION_NO_TERRENO] [decimal](25, 2) NULL,
	[FECHA_ULTIMA_TASACION_GARANTIA] [date] NULL,
	[MONTO_TASACION_ACTUALIZADA_TERRENO] [decimal](25, 2) NULL,
	[MONTO_TASACION_ACTUALIZADA_NO_TERRENO] [decimal](25, 2) NULL,
	[FECHA_ULTIMO_SEGUIMIENTO] [date] NULL,
	[FECHA_CONSTRUCCION] [date] NULL,
	[COD_TIPO_PERSONA_TASADOR] [int] NULL,
	[ID_TASADOR] [varchar](30) NULL,
	[COD_TIPO_PERSONA_EMPRESA_TASADORA] [int] NULL,
	[ID_EMPRESA_TASADORA] [varchar](30) NULL,
	[IND_POLIZA] [varchar](1) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_VALORES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_VALORES](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_CLASIFICACION_INSTRUMENTO] [int] NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_EMISOR] [varchar](30) NULL,
	[ID_INSTRUMENTO] [varchar](25) NULL,
	[SERIE_INSTRUMENTO] [varchar](20) NULL,
	[PREMIO] [decimal](7, 2) NULL,
	[CODISIN] [varchar](25) NULL,
	[COD_TIPO_ASIGNACION_CALIFICACION] [int] NULL,
	[COD_CATEGORIA_CALIFICACION] [int] NULL,
	[COD_CALIFICACION_RIESGO] [varchar](30) NULL,
	[COD_EMPRESA_CALIFICADORA] [int] NULL,
	[VALOR_FACIAL] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_VALOR_FACIAL] [int] NULL,
	[VALOR_MERCADO] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_VALOR_MERCADO] [int] NULL,
	[FECHA_CONSTITUCION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
 CONSTRAINT [PK_GARANTIAS_VALORES] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GARANTIAS_VALORES_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GARANTIAS_VALORES_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_CLASIFICACION_INSTRUMENTO] [int] NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_EMISOR] [varchar](30) NULL,
	[ID_INSTRUMENTO] [varchar](25) NULL,
	[SERIE_INSTRUMENTO] [varchar](20) NULL,
	[PREMIO] [decimal](7, 2) NULL,
	[CODISIN] [varchar](25) NULL,
	[COD_TIPO_ASIGNACION_CALIFICACION] [int] NULL,
	[COD_CATEGORIA_CALIFICACION] [int] NULL,
	[COD_CALIFICACION_RIESGO] [varchar](30) NULL,
	[COD_EMPRESA_CALIFICADORA] [int] NULL,
	[VALOR_FACIAL] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_VALOR_FACIAL] [int] NULL,
	[VALOR_MERCADO] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_VALOR_MERCADO] [int] NULL,
	[FECHA_CONSTITUCION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
 CONSTRAINT [PK_GARANTIAS_VALORES_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[GENERAL_BV]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[GENERAL_BV](
	[N_VALIDACION] [int] NOT NULL,
	[DESCRIPCION_VALIDACION] [varchar](1000) NOT NULL,
	[CUENTA_CONTABLE] [varchar](2000) NOT NULL,
	[CONTABILIDAD_SALDO] [decimal](38, 2) NOT NULL,
	[SICAD_SALDO] [decimal](38, 2) NOT NULL,
	[DIFERENCIA] [decimal](38, 2) NOT NULL,
	[EMPRESA] [int] NULL,
	[CUENTA] [bigint] NULL,
	[DESCRIPCION_CUENTA] [varchar](100) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[LOG_GARANTIAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[LOG_GARANTIAS](
	[EMPRESA] [int] NULL,
	[COD_FALTA_GARANTIA] [int] NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[ID_GARANTIA] [varchar](25) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MONTO_MITIGADOR_CALCULADO]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[MONTO_MITIGADOR_CALCULADO](
	[ID_OPERACION] [varchar](30) NULL,
	[MONTO_MITIGADOR_CALCULADO] [decimal](25, 2) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[MORA_DEUDOR]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[MORA_DEUDOR](
	[ID_DEUDOR] [varchar](30) NULL,
	[EMPRESA] [int] NULL,
	[MAX_DIAS] [int] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_LINEA] [varchar](25) NULL,
	[COD_TIPO_OPERACION] [int] NULL,
	[COD_TIPO_CATALOGO_SUGEF] [int] NULL,
	[COD_PAIS_DESTINO_CREDITO] [varchar](4) NULL,
	[COD_PROVINCIA_DESTINO_CREDITO] [int] NULL,
	[COD_CANTON_DESTINO_CREDITO] [int] NULL,
	[COD_PROVINCIA_DEPENDENCIA_CREDITO] [int] NULL,
	[COD_CANTON_DEPENDENCIA_CREDITO] [int] NULL,
	[COD_TIPO_CARTERA] [int] NULL,
	[COD_TIPO_ESTADO_OPERACION] [int] NULL,
	[COD_TIPO_MONEDA_MONTO] [int] NULL,
	[MONTO_OPERACION_AUTORIZADO] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_PRINCIPAL_SUGEF] [bigint] NULL,
	[SALDO_PRINCIPAL] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_SUGEF] [bigint] NULL,
	[SALDO_PRINCIPAL_DEPOSITO_PREVIO] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_PRODUCTO_SUGEF] [bigint] NULL,
	[SALDO_PRODUCTO] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESTRUCTURAL] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_SUGEF] [bigint] NULL,
	[SALDO_DESEMBOLSAR_COMPROMISO] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_COMISIONES_SUGEF] [bigint] NULL,
	[SALDO_COMISIONES] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_SUGEF] [bigint] NULL,
	[SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO] [decimal](25, 2) NULL,
	[MONTO_DESEMBOLSADO] [decimal](25, 2) NULL,
	[FECHA_FORMALIZACION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[FRECUENCIA_PAGO_ACTUAL_PRINCIPAL] [int] NULL,
	[FRECUENCIA_PAGO_ACTUAL_INTERESES] [int] NULL,
	[FECHA_VENCIMIENTO_PERIODO_GRACIA_PRINCIPAL] [date] NULL,
	[COD_TASA_INTERES_NOMINAL_VIGENTE] [decimal](7, 2) NULL,
	[COD_TIPO_TASA] [varchar](2) NULL,
	[FACTOR_TIEMPO] [varchar](1) NULL,
	[COD_FORMA_PAGO_VIGENTE_PRINCIPAL] [varchar](1) NULL,
	[COD_FORMA_PAGO_VIGENTE_INTERESES] [varchar](1) NULL,
	[FECHA_CORTE_OPERACION] [date] NULL,
	[FECHA_PROXIMO_PAGO_PRINCIPAL] [date] NULL,
	[FECHA_PROXIMO_PAGO_INTERESES] [date] NULL,
	[FECHA_AMORTIZACION_HASTA] [date] NULL,
	[FECHA_INTERESES_HASTA] [date] NULL,
	[FECHA_PAGO_PACTADO_PRINCIPAL] [date] NULL,
	[FECHA_PAGO_PACTADO_INTERESES] [date] NULL,
	[PLAZO_OPERACION] [int] NULL,
	[COD_TIPO_CUOTA_PRINCIPAL] [int] NULL,
	[MONTO_CUOTA_PRINCIPAL_ACTUAL] [decimal](25, 2) NULL,
	[MONTO_CUOTA_INTERESES_ACTUAL] [decimal](25, 2) NULL,
	[IND_OPERACION_NUEVA] [varchar](3) NULL,
	[RECUPERACION_PRINCIPAL] [decimal](25, 2) NULL,
	[OTROS_AUMENTOS_PRINCIPAL] [decimal](25, 2) NULL,
	[OTRAS_DISMINUCIONES_PRINCIPAL] [decimal](25, 2) NULL,
	[IND_BACK_TO_BACK] [varchar](1) NULL,
	[IND_CREDITO_SINDICADO] [varchar](1) NULL,
	[IND_OPERACION_ESPECIAL] [varchar](2) NULL,
	[PCJ_RESPONSABILIDAD_LINEA] [decimal](7, 2) NULL,
	[CLAUSULA_LIMITE_CREDITO] [int] NULL,
	[COD_SISTEMA] [int] NULL,
	[COD_OFICINA] [varchar](5) NULL,
	[COD_PRODUCTO] [varchar](5) NULL,
	[ID_OPERACION_INTERNO] [varchar](25) NULL,
	[CUENTA_CONTABLE_PRINCIPAL_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_PRODUCTOS_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_COMISIONES_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_ENTIDAD] [bigint] NULL,
	[ATRASO_CAPITAL] [int] NULL,
	[ATRASO_INTERES] [int] NULL,
	[FECHA_CAMBIO_TIPO_TASA] [date] NULL,
	[FRECUENCIA_AJUSTE_TASA_INTERES_VARIABLE] [int] NULL,
	[PARAMETRO_REFERENCIA_TASA_INTERES_VARIABLE] [int] NULL,
	[COMPONENTE_VARIABLE_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[COMPONENTE_FIJO_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[LIMITE_INFERIOR_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[LIMITE_SUPERIOR_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[MONTO_ESTIMACION_GENERICA_DIRECTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_GENERICA_CONTINGENTE] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_CUBIERTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_DESCUBIERTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_CUBIERTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_DESCUBIERTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_CONTRA_CICLICA_DIRECTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_CONTRA_CICLICA_CONTINGENTE] [decimal](25, 2) NULL,
	[TIPO_SOBREGIRO] [int] NULL,
	[MONTO_INTERES_HASTA_180] [decimal](25, 2) NULL,
	[CANTIDAD_DIAS_HASTA_180] [int] NULL,
	[CANTIDAD_DIAS_MAS_180] [int] NULL,
	[MONTO_INTERES_ADELANTADO] [decimal](25, 2) NULL,
	[CANTIDAD_DIAS_ADELANTADO] [int] NULL,
	[FRECUENCIA_PAGO_ACTUAL_PRINCIPAL_FUENTE] [int] NULL,
	[FRECUENCIA_PAGO_ACTUAL_INTERESES_FUENTE] [int] NULL,
	[ID_DEUDOR_ENTIDAD] [varchar](50) NULL,
	[MONTO_ESTIMACION_REGISTRADA_OPERACION] [decimal](26, 4) NULL,
 CONSTRAINT [PK_OPERACIONES] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_ACTIVIDAD_ECONOMICA]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_ACTIVIDAD_ECONOMICA](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_ACTIVIDAD_ECONOMICA] [varchar](14) NOT NULL,
	[COD_ACTIVIDAD_ECONOMICA_FUENTE] [varchar](14) NOT NULL,
	[PCJ_ACTIVIDAD_ECONOMICA] [int] NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_ACTIVIDAD_ECONOMICA] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_ACTIVIDAD_ECONOMICA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_ACTIVIDAD_ECONOMICA_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_ACTIVIDAD_ECONOMICA_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_ACTIVIDAD_ECONOMICA] [varchar](14) NOT NULL,
	[PCJ_ACTIVIDAD_ECONOMICA] [int] NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_ACTIVIDAD_ECONOMICA_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_ACTIVIDAD_ECONOMICA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_ACTIVIDAD_ECONOMICA_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_ACTIVIDAD_ECONOMICA_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_ACTIVIDAD_ECONOMICA] [varchar](14) NOT NULL,
	[COD_ACTIVIDAD_ECONOMICA_FUENTE] [varchar](14) NOT NULL,
	[PCJ_ACTIVIDAD_ECONOMICA] [int] NULL,
	[COD_SISTEMA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_CODEUDORES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_CODEUDORES](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_PERSONA_CODEUDOR] [int] NOT NULL,
	[ID_CODEUDOR] [varchar](30) NOT NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_CODEUDORES] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[ID_CODEUDOR] ASC,
	[COD_TIPO_PERSONA_CODEUDOR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_CODEUDORES_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_CODEUDORES_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_PERSONA_CODEUDOR] [int] NOT NULL,
	[ID_CODEUDOR] [varchar](30) NOT NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_CODEUDORES_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[ID_CODEUDOR] ASC,
	[COD_TIPO_PERSONA_CODEUDOR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_CODEUDORES_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_CODEUDORES_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_PERSONA_CODEUDOR] [int] NOT NULL,
	[ID_CODEUDOR] [varchar](30) NOT NULL,
	[COD_SISTEMA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_CREDITO_SINDICADO]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_CREDITO_SINDICADO](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO] [int] NOT NULL,
	[ID_ENTIDAD_CREDITO_SINDICADO] [varchar](30) NOT NULL,
	[ID_OPERACION_ENTIDAD_CREDITO_SINDICADO] [varchar](25) NOT NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_CREDITO_SINDICADO] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO] ASC,
	[ID_ENTIDAD_CREDITO_SINDICADO] ASC,
	[ID_OPERACION_ENTIDAD_CREDITO_SINDICADO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_CREDITO_SINDICADO_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_CREDITO_SINDICADO_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO] [int] NOT NULL,
	[ID_ENTIDAD_CREDITO_SINDICADO] [varchar](30) NOT NULL,
	[ID_OPERACION_ENTIDAD_CREDITO_SINDICADO] [varchar](25) NOT NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_CREDITO_SINDICADO_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO] ASC,
	[ID_ENTIDAD_CREDITO_SINDICADO] ASC,
	[ID_OPERACION_ENTIDAD_CREDITO_SINDICADO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_CREDITO_SINDICADO_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_CREDITO_SINDICADO_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO] [int] NOT NULL,
	[ID_ENTIDAD_CREDITO_SINDICADO] [varchar](30) NOT NULL,
	[ID_OPERACION_ENTIDAD_CREDITO_SINDICADO] [varchar](25) NOT NULL,
	[COD_SISTEMA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_ENTIDAD](
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_LINEA] [varchar](25) NULL,
	[COD_TIPO_OPERACION] [int] NULL,
	[COD_PROVINCIA_DESTINO_CREDITO] [int] NULL,
	[COD_CANTON_DESTINO_CREDITO] [int] NULL,
	[COD_PROVINCIA_DEPENDENCIA_CREDITO] [int] NULL,
	[COD_CANTON_DEPENDENCIA_CREDITO] [int] NULL,
	[COD_TIPO_CARTERA] [int] NULL,
	[COD_TIPO_ESTADO_OPERACION] [int] NULL,
	[COD_TIPO_MONEDA_MONTO] [int] NULL,
	[MONTO_OPERACION_AUTORIZADO] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_PRINCIPAL_SUGEF] [bigint] NULL,
	[SALDO_PRINCIPAL] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_SUGEF] [bigint] NULL,
	[SALDO_PRINCIPAL_DEPOSITO_PREVIO] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_PRODUCTO_SUGEF] [bigint] NULL,
	[SALDO_PRODUCTO] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_SUGEF] [bigint] NULL,
	[SALDO_DESEMBOLSAR_COMPROMISO] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_COMISIONES_SUGEF] [bigint] NULL,
	[SALDO_COMISIONES] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_SUGEF] [bigint] NULL,
	[SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO] [decimal](25, 2) NULL,
	[MONTO_DESEMBOLSADO] [decimal](25, 2) NULL,
	[FECHA_FORMALIZACION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[FRECUENCIA_PAGO_ACTUAL_PRINCIPAL] [int] NULL,
	[FRECUENCIA_PAGO_ACTUAL_INTERESES] [int] NULL,
	[FECHA_VENCIMIENTO_PERIODO_GRACIA_PRINCIPAL] [date] NULL,
	[COD_TASA_INTERES_NOMINAL_VIGENTE] [decimal](7, 2) NULL,
	[COD_TIPO_TASA] [varchar](2) NULL,
	[FACTOR_TIEMPO] [varchar](1) NULL,
	[COD_FORMA_PAGO_VIGENTE_PRINCIPAL] [varchar](1) NULL,
	[COD_FORMA_PAGO_VIGENTE_INTERESES] [varchar](1) NULL,
	[FECHA_CORTE_OPERACION] [date] NULL,
	[FECHA_PROXIMO_PAGO_PRINCIPAL] [date] NULL,
	[FECHA_PROXIMO_PAGO_INTERESES] [date] NULL,
	[FECHA_AMORTIZACION_HASTA] [date] NULL,
	[FECHA_INTERESES_HASTA] [date] NULL,
	[FECHA_PAGO_PACTADO_PRINCIPAL] [date] NULL,
	[FECHA_PAGO_PACTADO_INTERESES] [date] NULL,
	[COD_TIPO_CUOTA_PRINCIPAL] [int] NULL,
	[MONTO_CUOTA_PRINCIPAL_ACTUAL] [decimal](25, 2) NULL,
	[MONTO_CUOTA_INTERESES_ACTUAL] [decimal](25, 2) NULL,
	[RECUPERACION_PRINCIPAL] [decimal](25, 2) NULL,
	[OTROS_AUMENTOS_PRINCIPAL] [decimal](25, 2) NULL,
	[OTRAS_DISMINUCIONES_PRINCIPAL] [decimal](25, 2) NULL,
	[IND_BACK_TO_BACK] [varchar](1) NULL,
	[CLAUSULA_LIMITE_CREDITO] [int] NULL,
	[COD_SISTEMA] [int] NULL,
	[COD_OFICINA] [varchar](5) NULL,
	[COD_PRODUCTO] [varchar](5) NULL,
	[ID_OPERACION_INTERNO] [varchar](25) NULL,
	[CUENTA_CONTABLE_PRINCIPAL_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_PRODUCTOS_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_COMISIONES_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_ENTIDAD] [bigint] NULL,
	[ATRASO_CAPITAL] [int] NULL,
	[ATRASO_INTERES] [int] NULL,
	[FECHA_CAMBIO_TIPO_TASA] [date] NULL,
	[FRECUENCIA_AJUSTE_TASA_INTERES_VARIABLE] [int] NULL,
	[PARAMETRO_REFERENCIA_TASA_INTERES_VARIABLE] [int] NULL,
	[COMPONENTE_VARIABLE_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[COMPONENTE_FIJO_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[LIMITE_INFERIOR_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[LIMITE_SUPERIOR_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
 CONSTRAINT [PK_OPERACIONES_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_MODIFICACION]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_MODIFICACION](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[FECHA_MODIFICACION] [date] NOT NULL,
	[COD_TIPO_MODIFICACION] [int] NOT NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_MODIFICACION] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[FECHA_MODIFICACION] ASC,
	[COD_TIPO_MODIFICACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_MODIFICACION_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_MODIFICACION_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[FECHA_MODIFICACION] [date] NOT NULL,
	[COD_TIPO_MODIFICACION] [int] NOT NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_MODIFICACION_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[FECHA_MODIFICACION] ASC,
	[COD_TIPO_MODIFICACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_MODIFICACION] [int] NOT NULL,
	[FECHA_MODIFICACION] [date] NOT NULL,
	[COD_TIPO_PERSONA_ENTIDAD_OPERACION_CANCELADA] [int] NOT NULL,
	[ID_ENTIDAD_OPERACION_CANCELADA] [varchar](30) NOT NULL,
	[COD_TIPO_PERSONA_DEUDOR_CANCELADO] [int] NULL,
	[ID_DEUDOR_CANCELADO] [varchar](30) NULL,
	[ID_OPERACION_CANCELADA] [varchar](25) NOT NULL,
	[FECHA_DESEMBOLSO_DEUDOR] [date] NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_TIPO_MODIFICACION] ASC,
	[FECHA_MODIFICACION] ASC,
	[COD_TIPO_PERSONA_ENTIDAD_OPERACION_CANCELADA] ASC,
	[ID_ENTIDAD_OPERACION_CANCELADA] ASC,
	[ID_OPERACION_CANCELADA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_MODIFICACION] [int] NOT NULL,
	[FECHA_MODIFICACION] [date] NOT NULL,
	[COD_TIPO_PERSONA_ENTIDAD_OPERACION_CANCELADA] [int] NOT NULL,
	[ID_ENTIDAD_OPERACION_CANCELADA] [varchar](30) NOT NULL,
	[COD_TIPO_PERSONA_DEUDOR_CANCELADO] [int] NOT NULL,
	[ID_DEUDOR_CANCELADO] [varchar](30) NOT NULL,
	[ID_OPERACION_CANCELADA] [varchar](25) NOT NULL,
	[FECHA_DESEMBOLSO_DEUDOR] [date] NOT NULL,
	[COD_SISTEMA] [int] NOT NULL,
 CONSTRAINT [PK_OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_TIPO_MODIFICACION] ASC,
	[FECHA_MODIFICACION] ASC,
	[COD_TIPO_PERSONA_ENTIDAD_OPERACION_CANCELADA] ASC,
	[ID_ENTIDAD_OPERACION_CANCELADA] ASC,
	[COD_TIPO_PERSONA_DEUDOR_CANCELADO] ASC,
	[ID_DEUDOR_CANCELADO] ASC,
	[ID_OPERACION_CANCELADA] ASC,
	[FECHA_DESEMBOLSO_DEUDOR] ASC,
	[COD_SISTEMA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_MODIFICACION] [int] NOT NULL,
	[FECHA_MODIFICACION] [date] NOT NULL,
	[COD_TIPO_PERSONA_ENTIDAD_OPERACION_CANCELADA] [int] NOT NULL,
	[ID_ENTIDAD_OPERACION_CANCELADA] [varchar](30) NOT NULL,
	[COD_TIPO_PERSONA_DEUDOR_CANCELADO] [int] NULL,
	[ID_DEUDOR_CANCELADO] [varchar](30) NULL,
	[ID_OPERACION_CANCELADA] [varchar](25) NOT NULL,
	[FECHA_DESEMBOLSO_DEUDOR] [date] NULL,
	[COD_SISTEMA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_MODIFICACION_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_MODIFICACION_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[FECHA_MODIFICACION] [date] NOT NULL,
	[COD_TIPO_MODIFICACION] [int] NOT NULL,
	[COD_SISTEMA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_NATURALEZA_GASTO]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_NATURALEZA_GASTO](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_NATURALEZA_GASTO] [int] NOT NULL,
	[PCJ_NATURALEZA_GASTO] [int] NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_NATURALEZA_GASTO] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_NATURALEZA_GASTO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_NATURALEZA_GASTO_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_NATURALEZA_GASTO_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_NATURALEZA_GASTO] [int] NOT NULL,
	[PCJ_NATURALEZA_GASTO] [int] NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_NATURALEZA_GASTO_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_NATURALEZA_GASTO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_NATURALEZA_GASTO_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_NATURALEZA_GASTO_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_NATURALEZA_GASTO] [int] NOT NULL,
	[PCJ_NATURALEZA_GASTO] [int] NULL,
	[COD_SISTEMA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_NO_REPORTADAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_NO_REPORTADAS](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_MOTIVO_LIQUIDACION] [int] NOT NULL,
	[FECHA_LIQUIDACION] [date] NULL,
	[SALDO_PRINCIPAL_LIQUIDADO] [decimal](25, 2) NULL,
	[SALDO_PRODUCTOS_LIQUIDADO] [decimal](25, 2) NULL,
	[ID_OPERACION_NUEVA] [varchar](25) NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_NO_REPORTADAS] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_TIPO_MOTIVO_LIQUIDACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_NO_REPORTADAS_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_NO_REPORTADAS_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_MOTIVO_LIQUIDACION] [int] NOT NULL,
	[FECHA_LIQUIDACION] [date] NULL,
	[SALDO_PRINCIPAL_LIQUIDADO] [decimal](25, 2) NULL,
	[SALDO_PRODUCTOS_LIQUIDADO] [decimal](25, 2) NULL,
	[ID_OPERACION_NUEVA] [varchar](25) NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_NO_REPORTADAS_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_TIPO_MOTIVO_LIQUIDACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_OPERACION_ESPECIAL]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_OPERACION_ESPECIAL](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_OPERACION_ESPECIAL] [int] NOT NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_OPERACION_ESPECIAL] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_TIPO_OPERACION_ESPECIAL] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_OPERACION_ESPECIAL_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_OPERACION_ESPECIAL_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_OPERACION_ESPECIAL] [int] NOT NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OOPERACIONES_OPERACION_ESPECIAL_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_TIPO_OPERACION_ESPECIAL] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_OPERACION_ESPECIAL_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_OPERACION_ESPECIAL_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_TIPO_OPERACION_ESPECIAL] [int] NOT NULL,
	[COD_SISTEMA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_ORIGEN_RECURSOS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_ORIGEN_RECURSOS](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_ORIGEN_RECURSOS] [int] NOT NULL,
	[PCJ_ORIGEN_RECURSOS] [int] NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_ORIGEN_RECURSOS] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_ORIGEN_RECURSOS] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_ORIGEN_RECURSOS_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_ORIGEN_RECURSOS_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_ORIGEN_RECURSOS] [int] NOT NULL,
	[PCJ_ORIGEN_RECURSOS] [int] NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_ORIGEN_RECURSOS_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[COD_ORIGEN_RECURSOS] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_ORIGEN_RECURSOS_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_ORIGEN_RECURSOS_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[COD_ORIGEN_RECURSOS] [int] NOT NULL,
	[PCJ_ORIGEN_RECURSOS] [int] NULL,
	[COD_SISTEMA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_LINEA] [varchar](25) NULL,
	[COD_TIPO_OPERACION] [int] NULL,
	[COD_TIPO_CATALOGO_SUGEF] [int] NULL,
	[COD_PAIS_DESTINO_CREDITO] [varchar](4) NULL,
	[COD_PROVINCIA_DESTINO_CREDITO] [int] NULL,
	[COD_CANTON_DESTINO_CREDITO] [int] NULL,
	[COD_PROVINCIA_DEPENDENCIA_CREDITO] [int] NULL,
	[COD_CANTON_DEPENDENCIA_CREDITO] [int] NULL,
	[COD_TIPO_CARTERA] [int] NULL,
	[COD_TIPO_ESTADO_OPERACION] [int] NULL,
	[COD_TIPO_MONEDA_MONTO] [int] NULL,
	[MONTO_OPERACION_AUTORIZADO] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_PRINCIPAL_SUGEF] [bigint] NULL,
	[SALDO_PRINCIPAL] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_SUGEF] [bigint] NULL,
	[SALDO_PRINCIPAL_DEPOSITO_PREVIO] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_PRODUCTO_SUGEF] [bigint] NULL,
	[SALDO_PRODUCTO] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESTRUCTURAL] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_SUGEF] [bigint] NULL,
	[SALDO_DESEMBOLSAR_COMPROMISO] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_COMISIONES_SUGEF] [bigint] NULL,
	[SALDO_COMISIONES] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_SUGEF] [bigint] NULL,
	[SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO] [decimal](25, 2) NULL,
	[MONTO_DESEMBOLSADO] [decimal](25, 2) NULL,
	[FECHA_FORMALIZACION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[FRECUENCIA_PAGO_ACTUAL_PRINCIPAL] [int] NULL,
	[FRECUENCIA_PAGO_ACTUAL_INTERESES] [int] NULL,
	[FECHA_VENCIMIENTO_PERIODO_GRACIA_PRINCIPAL] [date] NULL,
	[COD_TASA_INTERES_NOMINAL_VIGENTE] [decimal](7, 2) NULL,
	[COD_TIPO_TASA] [varchar](2) NULL,
	[FACTOR_TIEMPO] [varchar](1) NULL,
	[COD_FORMA_PAGO_VIGENTE_PRINCIPAL] [varchar](1) NULL,
	[COD_FORMA_PAGO_VIGENTE_INTERESES] [varchar](1) NULL,
	[FECHA_CORTE_OPERACION] [date] NULL,
	[FECHA_PROXIMO_PAGO_PRINCIPAL] [date] NULL,
	[FECHA_PROXIMO_PAGO_INTERESES] [date] NULL,
	[FECHA_AMORTIZACION_HASTA] [date] NULL,
	[FECHA_INTERESES_HASTA] [date] NULL,
	[FECHA_PAGO_PACTADO_PRINCIPAL] [date] NULL,
	[FECHA_PAGO_PACTADO_INTERESES] [date] NULL,
	[PLAZO_OPERACION] [int] NULL,
	[COD_TIPO_CUOTA_PRINCIPAL] [int] NULL,
	[MONTO_CUOTA_PRINCIPAL_ACTUAL] [decimal](25, 2) NULL,
	[MONTO_CUOTA_INTERESES_ACTUAL] [decimal](25, 2) NULL,
	[IND_OPERACION_NUEVA] [varchar](3) NULL,
	[RECUPERACION_PRINCIPAL] [decimal](25, 2) NULL,
	[OTROS_AUMENTOS_PRINCIPAL] [decimal](25, 2) NULL,
	[OTRAS_DISMINUCIONES_PRINCIPAL] [decimal](25, 2) NULL,
	[IND_BACK_TO_BACK] [varchar](1) NULL,
	[IND_CREDITO_SINDICADO] [varchar](1) NULL,
	[IND_OPERACION_ESPECIAL] [varchar](2) NULL,
	[PCJ_RESPONSABILIDAD_LINEA] [decimal](7, 2) NULL,
	[CLAUSULA_LIMITE_CREDITO] [int] NULL,
	[COD_SISTEMA] [int] NULL,
	[COD_OFICINA] [varchar](5) NULL,
	[COD_PRODUCTO] [varchar](5) NULL,
	[ID_OPERACION_INTERNO] [varchar](25) NULL,
	[CUENTA_CONTABLE_PRINCIPAL_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_PRODUCTOS_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_COMISIONES_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_ENTIDAD] [bigint] NULL,
	[ATRASO_CAPITAL] [int] NULL,
	[ATRASO_INTERES] [int] NULL,
	[FECHA_CAMBIO_TIPO_TASA] [date] NULL,
	[FRECUENCIA_AJUSTE_TASA_INTERES_VARIABLE] [int] NULL,
	[PARAMETRO_REFERENCIA_TASA_INTERES_VARIABLE] [int] NULL,
	[COMPONENTE_VARIABLE_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[COMPONENTE_FIJO_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[LIMITE_INFERIOR_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[LIMITE_SUPERIOR_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[MONTO_ESTIMACION_GENERICA_DIRECTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_GENERICA_CONTINGENTE] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_CUBIERTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_DESCUBIERTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_CUBIERTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_DESCUBIERTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_CONTRA_CICLICA_DIRECTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_CONTRA_CICLICA_CONTINGENTE] [decimal](25, 2) NULL,
	[TIPO_SOBREGIRO] [int] NULL,
	[MONTO_INTERES_HASTA_180] [decimal](25, 2) NULL,
	[CANTIDAD_DIAS_HASTA_180] [int] NULL,
	[CANTIDAD_DIAS_MAS_180] [int] NULL,
	[MONTO_INTERES_ADELANTADO] [decimal](25, 2) NULL,
	[CANTIDAD_DIAS_ADELANTADO] [int] NULL,
	[FRECUENCIA_PAGO_ACTUAL_PRINCIPAL_FUENTE] [int] NULL,
	[FRECUENCIA_PAGO_ACTUAL_INTERESES_FUENTE] [int] NULL,
	[ID_DEUDOR_ENTIDAD] [varchar](50) NULL,
	[MONTO_ESTIMACION_REGISTRADA_OPERACION] [decimal](26, 4) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_SALDOS_CUENTAS_COBRAR]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_SALDOS_CUENTAS_COBRAR](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[CUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF] [bigint] NOT NULL,
	[SALDO_CUENTAS_COBRAR] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_CUENTAS_COBRAR] [int] NOT NULL,
	[ATRASO_CUENTAS_COBRAR] [int] NOT NULL,
	[CUENTA_CONTABLE_CUENTAS_COBRAR_ENTIDAD] [bigint] NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_SALDOS_CUENTAS_COBRAR] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[CUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF] ASC,
	[COD_TIPO_MONEDA_CUENTAS_COBRAR] ASC,
	[ATRASO_CUENTAS_COBRAR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_SALDOS_CUENTAS_COBRAR_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_SALDOS_CUENTAS_COBRAR_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[CUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF] [bigint] NOT NULL,
	[SALDO_CUENTAS_COBRAR] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_CUENTAS_COBRAR] [int] NOT NULL,
	[ATRASO_CUENTAS_COBRAR] [int] NOT NULL,
	[CUENTA_CONTABLE_CUENTAS_COBRAR_ENTIDAD] [bigint] NULL,
	[COD_SISTEMA] [int] NULL,
 CONSTRAINT [PK_OPERACIONES_SALDOS_CUENTAS_COBRAR_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_OPERACION] ASC,
	[CUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF] ASC,
	[COD_TIPO_MONEDA_CUENTAS_COBRAR] ASC,
	[ATRASO_CUENTAS_COBRAR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[OPERACIONES_SALDOS_CUENTAS_COBRAR_RESP_SB]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[OPERACIONES_SALDOS_CUENTAS_COBRAR_RESP_SB](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[CUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF] [bigint] NOT NULL,
	[SALDO_CUENTAS_COBRAR] [decimal](25, 2) NULL,
	[COD_TIPO_MONEDA_CUENTAS_COBRAR] [int] NOT NULL,
	[ATRASO_CUENTAS_COBRAR] [int] NOT NULL,
	[CUENTA_CONTABLE_CUENTAS_COBRAR_ENTIDAD] [bigint] NULL,
	[COD_SISTEMA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PADRON]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[PADRON](
	[ID_PERSONA] [varchar](40) NULL,
	[P_APELLIDO] [varchar](60) NULL,
	[S_APELLIDO] [varchar](60) NULL,
	[NOMBRE] [varchar](150) NULL,
	[RAZON_SOC] [varchar](150) NULL,
	[TIPO_PER] [int] NULL,
	[FECHA_NAC] [date] NULL,
	[PAIS_NAC] [varchar](3) NULL,
	[GENERO] [varchar](1) NULL,
	[IDENTIFICACION_TITULAS] [varchar](30) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PERSONAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[PERSONAS](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA] [int] NOT NULL,
	[ID_PERSONA] [varchar](30) NOT NULL,
	[PRIMER_APELLIDO] [varchar](20) NULL,
	[SEGUNDO_APELLIDO] [varchar](20) NULL,
	[NOMBRE] [varchar](35) NULL,
	[RAZON_SOCIAL] [varchar](150) NULL,
	[COD_GENERO] [int] NULL,
	[FECHA_NACIMIENTO] [date] NULL,
	[PAIS_NACIMIENTO] [varchar](4) NULL,
	[COD_ESTADO] [varchar](3) NULL,
 CONSTRAINT [PK_PERSONAS] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_PERSONA] ASC,
	[COD_TIPO_PERSONA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PERSONAS_ENTIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[PERSONAS_ENTIDAD](
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA] [int] NOT NULL,
	[ID_PERSONA] [varchar](30) NOT NULL,
 CONSTRAINT [PK_PERSONAS_ENTIDAD] PRIMARY KEY CLUSTERED 
(
	[EMPRESA] ASC,
	[ID_PERSONA] ASC,
	[COD_TIPO_PERSONA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PLANO_BCR]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[PLANO_BCR](
	[OFICINA] [varchar](3) NULL,
	[MONEDA] [varchar](1) NULL,
	[DEPART] [varchar](2) NULL,
	[OPERA] [varchar](7) NULL,
	[NATURA] [varchar](1) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PRIDEUCTL]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[PRIDEUCTL](
	[CEDULA] [varchar](15) NULL,
	[INDJUDIC] [varchar](1) NULL,
	[TIPOSOB] [varchar](1) NULL,
	[MONEDA] [varchar](2) NULL,
	[NUMOPER] [varchar](11) NULL,
	[CODOFI] [varchar](4) NULL,
	[DEPTO] [varchar](2) NULL,
	[SALDOTOT] [decimal](38, 2) NULL,
	[PRODXCOB] [decimal](38, 2) NULL,
	[SALDOPRI] [decimal](38, 2) NULL,
	[FECONST] [varchar](8) NULL,
	[FEVEN] [varchar](8) NULL,
	[TASASOB] [decimal](20, 2) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SICAD_SALDO_BV]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[SICAD_SALDO_BV](
	[N_VALIDACION] [int] NOT NULL,
	[EMPRESA] [int] NULL,
	[SICAD_SALDO] [decimal](38, 2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)

GO
/****** Object:  Table [dbo].[SISACT]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[SISACT](
	[EMPRESA] [int] NOT NULL,
	[TIPPER] [varchar](2) NULL,
	[IDEDEU] [varchar](30) NULL,
	[OFIEMI] [varchar](4) NULL,
	[NUMTAR] [varchar](16) NULL,
	[IDEOPE] [varchar](25) NULL,
	[IDELIN] [varchar](25) NULL,
	[TIPOPE] [varchar](1) NULL,
	[ESTOPE] [varchar](1) NULL,
	[CTACOM] [varchar](15) NULL,
	[CTASALP] [varchar](15) NULL,
	[FECCOR] [varchar](10) NULL,
	[FECPACP] [varchar](10) NULL,
	[FECFOR] [varchar](10) NULL,
	[FECVEN] [varchar](10) NULL,
	[FREPPRI] [varchar](2) NULL,
	[FREPINT] [varchar](2) NULL,
	[TASINT] [varchar](6) NULL,
	[TIPTAS] [varchar](2) NULL,
	[FACTIE] [varchar](1) NULL,
	[FORPAGP] [varchar](1) NULL,
	[FORPAGI] [varchar](1) NULL,
	[FECPROP] [varchar](10) NULL,
	[FECPROI] [varchar](10) NULL,
	[FECAMOH] [varchar](10) NULL,
	[FECINTH] [varchar](10) NULL,
	[FECPACI] [varchar](10) NULL,
	[PLAOPE] [varchar](6) NULL,
	[TIPCUOP] [varchar](2) NULL,
	[ORIREC] [varchar](3) NULL,
	[PROORI] [varchar](3) NULL,
	[OPENUE] [varchar](3) NULL,
	[INDBACK] [varchar](1) NULL,
	[INDSIND] [varchar](1) NULL,
	[PRODES] [varchar](2) NULL,
	[CANDES] [varchar](2) NULL,
	[PRODEP] [varchar](2) NULL,
	[CANDEP] [varchar](2) NULL,
	[COD_PROVINCIA_SUGEF] [int] NULL,
	[COD_CANTON_SUGEF] [int] NULL,
	[COD_TIPO_MONEDA_SUGEF] [int] NULL,
	[MONEDA] [int] NULL,
	[VALOR] [decimal](15, 2) NULL,
	[SALPRI] [decimal](38, 2) NULL,
	[SALPRO] [decimal](38, 2) NULL,
	[SALDESC] [decimal](38, 2) NULL,
	[SALCOM] [decimal](38, 2) NULL,
	[SALPENS] [decimal](38, 2) NULL,
	[MONDES] [decimal](38, 2) NULL,
	[MONCUOP] [decimal](38, 2) NULL,
	[MONCUOI] [decimal](38, 2) NULL,
	[MONREC] [decimal](38, 2) NULL,
	[MONAUM] [decimal](38, 2) NULL,
	[MONDIS] [decimal](38, 2) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SUGEF_COMPORTAMIENTO_PAGO_HISTORICO]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[SUGEF_COMPORTAMIENTO_PAGO_HISTORICO](
	[ID_PERSONA] [varchar](30) NOT NULL,
	[COD_TIPO_PERSONA] [int] NOT NULL,
	[INDICADOR_NUMERICO_DEUDOR] [int] NULL,
	[NIVEL_CPH] [int] NULL,
	[INDICADOR_REQ_AUT1_05] [varchar](1) NULL,
	[INDICADOR_AUTORIZACION] [varchar](1) NULL,
	[FECHA_INICIO_REQ_AUTORIZACION] [date] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = ROW
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SUGEF_PADRON_EMISION]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[SUGEF_PADRON_EMISION](
	[EMISOR] [varchar](30) NULL,
	[INSTRUMENTO] [varchar](25) NULL,
	[SERIE] [varchar](20) NULL,
	[ISIN] [varchar](25) NULL,
	[CLASIFICACION_INSTRUMENTO] [int] NULL,
	[MONEDA] [int] NULL,
	[PREMIO] [decimal](10, 2) NULL,
	[FECHA_VENCIMIENTO] [date] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = ROW
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SUGEF_PADRON_EMISOR]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[SUGEF_PADRON_EMISOR](
	[NEM_EMI] [varchar](30) NULL,
	[DES_EMISOR] [varchar](150) NULL,
	[COD_SEC] [int] NULL,
	[COD_PAIS] [varchar](2) NULL,
	[ES_BANCO_MULTILATERAL_DESARROLLO] [int] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = ROW
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SUGEF_PADRON_FISICA]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[SUGEF_PADRON_FISICA](
	[TIPO] [int] NULL,
	[IDENTIFICACION] [varchar](40) NULL,
	[PRIMER_APELLIDO] [varchar](60) NULL,
	[SEGUNDO_APELLIDO] [varchar](60) NULL,
	[NOMBRE] [varchar](150) NULL,
	[GENERO] [int] NULL,
	[PAIS_NACIMIENTO] [varchar](3) NULL,
	[FECHA_NACIMIENTO] [date] NULL,
	[IDENTIFICACION_TITULAR] [varchar](30) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = ROW
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SUGEF_PADRON_INSTRUMENTO]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[SUGEF_PADRON_INSTRUMENTO](
	[COD_INSTRUMENTO] [varchar](25) NULL,
	[DES_INSTRUMENTO] [varchar](150) NULL,
	[MONEDA_INSTRUMENTO] [int] NULL,
	[MONEDA_LIQUIDACION] [int] NULL,
	[TIPO_INSTRUMENTO] [varchar](50) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = ROW
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[SUGEF_PADRON_JURIDICA]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[SUGEF_PADRON_JURIDICA](
	[TIPO] [int] NULL,
	[IDENTIFICACION] [varchar](40) NULL,
	[RAZON_SOCIAL] [varchar](150) NULL,
	[PAISREGISTRO] [varchar](3) NULL,
	[FECHA_CONSTITUCION] [date] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = ROW
)

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TEMP_MES_ACTUAL]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TEMP_MES_ACTUAL](
	[ID_OPERA] [varchar](25) NULL,
	[CODIGO_SISTEMA] [int] NULL,
	[SALDO_PRINCIPAL] [decimal](22, 2) NULL,
	[AJUST_PRINCIPAL] [decimal](26, 4) NULL,
	[RECUPERACION_PRINCIPAL] [decimal](26, 4) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TEMP_MES_ANTERIOR]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TEMP_MES_ANTERIOR](
	[ID_OPERA] [varchar](25) NULL,
	[SALDO_PRINCIPAL] [decimal](22, 2) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_ADEUDADOS_FIDEICOMISO]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_ADEUDADOS_FIDEICOMISO](
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[MONTO_TOTAL_ADEUDADO] [decimal](26, 4) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_CASTIGOS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_CASTIGOS](
	[EMPRESA] [int] NULL,
	[ID_GARANTIA] [varchar](25) NULL,
	[COD_TIPO_GARANTIA] [int] NULL,
	[CASTIGO] [decimal](6, 4) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_EQUIVALENCIAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_EQUIVALENCIAS](
	[EMPRESA] [int] NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[ID_PERSONA] [varchar](25) NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[PCJ_EQ_PRINCIPAL] [decimal](5, 2) NULL,
	[SALDO_EQ_PRINCIPAL] [decimal](25, 2) NULL,
	[PCJ_EQ_DESEMBOLSAR] [decimal](5, 2) NULL,
	[SALDO_EQ_DESEMBOLSAR] [decimal](25, 2) NULL,
	[SALDO_TOTAL] [decimal](25, 2) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_ESTIMACION]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_ESTIMACION](
	[ID_OPERACION] [varchar](25) NOT NULL,
	[MONTO_TOTAL_ADEUDADO] [decimal](26, 4) NULL,
	[VAPG] [decimal](26, 4) NULL,
	[PCJ_RESPONSABILIDAD_GARANTIA] [decimal](9, 6) NULL,
	[CATEGORIA_RIESGO] [varchar](4) NULL,
	[ATRASO] [int] NULL,
	[PCJ_ESTIMACION] [decimal](26, 4) NULL,
	[ESTIMACION] [decimal](26, 4) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_GAR_DUPLICADAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_GAR_DUPLICADAS](
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_GARANTIA] [int] NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_GAR_UNICAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_GAR_UNICAS](
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_GARANTIA] [int] NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_GARANTIA_FIDEICOMETIDAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_GARANTIA_FIDEICOMETIDAS](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_GARANTIA_FIDEICOMISO] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMISO] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMISO] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[SALDO_TOTAL_ADEUDADO] [decimal](26, 4) NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDO] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO] [int] NOT NULL,
	[MONTO_GARANTIA_FIDEICOMETIDO] [decimal](26, 4) NOT NULL,
	[MONTO_GRAVAMEN_FIDEICOMETIDO] [decimal](26, 4) NOT NULL,
	[MONTO_TOTAL_ADEUDADO] [decimal](26, 4) NOT NULL,
	[TOTAL_GARANTIA_FIDEICOMETIDA] [decimal](26, 4) NOT NULL,
	[UNICA] [varchar](1) NOT NULL,
	[PCJ_FIDEICOMISO] [decimal](5, 2) NULL,
	[RESPONSABILIDAD] [decimal](5, 2) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_GARANTIA_FIDEICOMETIDAS_RESPONSABILIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_GARANTIA_FIDEICOMETIDAS_RESPONSABILIDAD](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_GARANTIA_FIDEICOMISO] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMISO] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMISO] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[SALDO_TOTAL_ADEUDADO] [decimal](26, 4) NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDO] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO] [int] NOT NULL,
	[MONTO_GARANTIA_FIDEICOMETIDO] [decimal](26, 4) NOT NULL,
	[MONTO_GRAVAMEN_FIDEICOMETIDO] [decimal](26, 4) NOT NULL,
	[MONTO_TOTAL_ADEUDADO] [decimal](26, 4) NOT NULL,
	[TOTAL_GARANTIA_FIDEICOMETIDA] [decimal](26, 4) NOT NULL,
	[UNICA] [varchar](1) NOT NULL,
	[PCJ_FIDEICOMISO] [varchar](10) NULL,
	[RESPONSABILIDAD] [decimal](5, 2) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_GARANTIA_FIDEICOMISOS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_GARANTIA_FIDEICOMISOS](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_GARANTIA_FIDEICOMISO] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMISO] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMISO] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[SALDO_TOTAL_ADEUDADO] [decimal](26, 4) NOT NULL,
	[MONTO_TOTAL_ADEUDADO] [decimal](26, 4) NULL,
	[TOTAL_GARANTIA_FIDEICOMETIDA] [decimal](26, 4) NOT NULL,
	[PORCENTAJE_FSO] [decimal](5, 2) NOT NULL,
	[RESPONSABILIDAD] [decimal](5, 2) NULL,
	[UNICA] [varchar](1) NOT NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_GARANTIA_FTIDAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_GARANTIA_FTIDAS](
	[ID_GARANTIA_FIDEICOMISO] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMISO] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMISO] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[SALDO_TOTAL_ADEUDADO] [decimal](26, 4) NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDO] [int] NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO] [int] NULL,
	[MONTO_GARANTIA_FIDEICOMETIDO] [decimal](26, 4) NOT NULL,
	[MONTO_GRAVAMEN_FIDEICOMETIDO] [decimal](26, 4) NOT NULL,
	[MONTO_TOTAL_ADEUDADO] [decimal](26, 4) NOT NULL,
	[TOTAL_GARANTIA_FIDEICOMETIDA] [int] NOT NULL,
	[UNICA] [varchar](1) NOT NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_GARANTIA_GRAVAMEN]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_GARANTIA_GRAVAMEN](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_GARANTIA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[MONTO_ID_GARANTIA] [decimal](26, 4) NOT NULL,
	[MONTO_GRADO_GRAVAMEN] [decimal](26, 4) NOT NULL,
	[GRADO_GRAVAMEN] [decimal](6, 0) NOT NULL,
	[TOTAL_MONTO_GRADO_GRAVAMEN] [decimal](26, 4) NOT NULL,
	[UNICA] [varchar](1) NOT NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_GARANTIA_RESPONSABILIDAD]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_GARANTIA_RESPONSABILIDAD](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_GARANTIA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[MONTO_ID_GARANTIA] [decimal](26, 4) NOT NULL,
	[MONTO_GRADO_GRAVAMEN] [decimal](26, 4) NOT NULL,
	[GRADO_GRAVAMEN] [decimal](6, 0) NOT NULL,
	[TOTAL_MONTO_GRADO_GRAVAMEN] [decimal](26, 4) NOT NULL,
	[RESPONSABILIDAD] [decimal](5, 2) NOT NULL,
	[UNICA] [varchar](1) NOT NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_GENERICA_ESPECIFICA]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_GENERICA_ESPECIFICA](
	[EMPRESA] [int] NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[GENERICA_DIRECTA] [decimal](25, 2) NULL,
	[GENERICA_CONTINGENTE] [decimal](25, 2) NULL,
	[ESPECIFICA_DIRECTA_CUBIERTA] [decimal](25, 2) NULL,
	[ESPECIFICA_DIRECTA_DESCUBIERTA] [decimal](25, 2) NULL,
	[ESPECIFICA_CONTINGENTE_CUBIERTA] [decimal](25, 2) NULL,
	[ESPECIFICA_CONTINGENTE_DESCUBIERTA] [decimal](25, 2) NULL,
	[CONTRA_CICLICA_DIRECTA] [decimal](25, 2) NULL,
	[CONTRA_CICLICA_CONTINGENTE] [decimal](25, 2) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_GIROS_LINEA]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_GIROS_LINEA](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_LINEA] [varchar](25) NULL,
	[TOTAL_ADEUDADO_GIROS] [decimal](26, 4) NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[PCJ_RESPONSABILIDAD_GARANTIA] [decimal](5, 2) NULL,
	[MONTO_TOTAL_ADEUDADO_GIROS] [decimal](26, 4) NULL,
	[UNICA] [varchar](1) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_MONTO_TOTAL_ADEUDADO]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_MONTO_TOTAL_ADEUDADO](
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[MONTO_TOTAL_ADEUDADO] [decimal](26, 4) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_OPE_DUPLICADAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_OPE_DUPLICADAS](
	[ID_OPERACION] [varchar](25) NOT NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_OPE_UNICAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_OPE_UNICAS](
	[ID_OPERACION] [varchar](25) NOT NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_REEVALUACION]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_REEVALUACION](
	[EMPRESA] [int] NULL,
	[ID_GARANTIA] [varchar](25) NULL,
	[MONTO_TERRENO] [decimal](26, 4) NULL,
	[MONTO_NO_TERRENO] [decimal](26, 4) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_RESPONSABILIDAD_LINEA]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_RESPONSABILIDAD_LINEA](
	[EMPRESA] [int] NULL,
	[ORDEN] [int] IDENTITY(1,1) NOT NULL,
	[ID_LINEA] [varchar](25) NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[MONTO_TOTAL_ADEUDADO_GIROS] [decimal](26, 4) NULL,
	[TOTAL_ADEUDADO_GIROS] [decimal](26, 4) NULL,
	[UNICA] [varchar](1) NULL,
	[PCJ_RESPONSABILIDAD_GARANTIA] [decimal](5, 2) NULL,
	[RESPONSBILIDAD] [decimal](5, 2) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_SALDOS_ESTIMACION]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_SALDOS_ESTIMACION](
	[EMPRESA] [int] NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[ID_GARANTIA] [varchar](25) NULL,
	[SALDO_CUBIERTO_DIRECTO] [decimal](25, 2) NULL,
	[SALDO_CUBIERTO_CONTINGENTE] [decimal](25, 2) NULL,
	[SALDO_DESCUBIERTO_DIRECTO] [decimal](25, 2) NULL,
	[SALDO_DESCUBIERTO_CONTINGENTE] [decimal](25, 2) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_SEMESTRES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_SEMESTRES](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[EMPRESA] [int] NULL,
	[ID_GARANTIA] [varchar](25) NULL,
	[SEMESTRES] [int] NULL,
	[TIPO] [varchar](1) NULL,
	[PORCENTAJE] [decimal](6, 4) NULL,
	[FACTOR_REEVALUACION] [decimal](14, 12) NULL,
	[MONTO_TERRENO] [decimal](26, 4) NULL,
	[MONTO_NO_TERRENO] [decimal](26, 4) NULL,
	[FECHA_PROXIMO_AVALUO] [datetime] NULL,
	[COD_TIPO_MONEDA] [int] NULL,
	[COD_TIPO_BIEN] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_SEMESTRES_CONTROL]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_SEMESTRES_CONTROL](
	[EMPRESA] [int] NULL,
	[ID_GARANTIA] [varchar](25) NULL,
	[SEMESTRES] [int] NULL,
	[TIPO] [varchar](1) NULL,
	[PORCENTAJE] [decimal](6, 4) NULL,
	[FACTOR_REEVALUACION] [decimal](14, 12) NULL,
	[MONTO_TERRENO] [decimal](26, 4) NULL,
	[MONTO_NO_TERRENO] [decimal](26, 4) NULL,
	[FECHA_PROXIMO_AVALUO] [datetime] NULL,
	[COD_TIPO_MONEDA] [int] NULL,
	[COD_TIPO_BIEN] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_VAG]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_VAG](
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_GARANTIA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[VALOR_AJUSTADO_GARANTIA] [decimal](26, 4) NULL,
	[PCJ_ACEPTACION] [decimal](9, 6) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_VAPG]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_VAPG](
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_GARANTIA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[MONTO_MITIGADOR] [decimal](22, 2) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NULL,
	[COD_CATEGORIA_RIESGO] [varchar](4) NULL,
	[PPSCR] [decimal](3, 2) NOT NULL,
	[VAPG] [decimal](26, 4) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_CALCULOS_VAPG_FIDAS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_CALCULOS_VAPG_FIDAS](
	[EMPRESA] [int] NULL,
	[COD_TIPO_GARANTIA] [int] NULL,
	[ID_GARANTIA] [varchar](25) NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NULL,
	[COD_TIPO_MITIGADOR] [int] NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDO] [int] NULL,
	[MONTO_MITIGADOR] [decimal](22, 2) NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NULL,
	[COD_CATEGORIA_RIESGO] [varchar](4) NULL,
	[PPSCR] [decimal](3, 2) NULL,
	[VAPG] [decimal](26, 4) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_DEUDOR_GIE]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_DEUDOR_GIE](
	[ID_DEUDOR] [varchar](30) NULL,
	[GRUPO] [int] NULL,
	[EMPRESA] [int] NULL,
	[TIPO_DEUDOR] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_DEUDORES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_DEUDORES](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA] [int] NOT NULL,
	[ID_DEUDOR] [varchar](30) NOT NULL,
	[COD_SECTOR_ECONOMICO] [int] NULL,
	[COD_GRUPO_CLASIFICACION] [varchar](4) NULL,
	[COD_CATEGORIA_RIESGO] [varchar](4) NULL,
	[COD_CAPACIDAD_PAGO] [int] NULL,
	[COD_CONDICIONES_ESPECIALES_DEUDOR] [int] NULL,
	[FECHA_CALIFICACION_RIESGO] [date] NULL,
	[COD_CATEGORIA_ANTERIOR] [varchar](4) NULL,
	[IND_GENERADOR_DIVISAS] [varchar](1) NULL,
	[COD_TIPO_ASIGNACION_CALIFICACION] [int] NULL,
	[COD_CATEGORIA_CALIFICACION] [int] NULL,
	[COD_CALIFICACION_RIESGO] [varchar](30) NULL,
	[COD_EMPRESA_CALIFICADORA] [int] NULL,
	[IND_VINCULADO_ENTIDAD] [varchar](1) NULL,
	[IND_VINCULADO_GRUPO_FINANCIERO] [varchar](1) NULL,
	[ID_GRUPO] [int] NULL,
	[COD_TIPO_COMPORTAMIENTO_PAGO] [int] NULL,
	[COD_TIPO_ACTIVIDAD_ECONOMICA_DEUDOR] [varchar](14) NULL,
	[AUTORIZACION] [varchar](1) NULL,
	[COD_SISTEMA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_DEUDORES_RECALIFICADOS]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_DEUDORES_RECALIFICADOS](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NULL,
	[COD_TIPO_PERSONA] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[COD_CATEGORIA_ASIGNADA] [varchar](4) NULL,
	[COD_GRUPO_ASIGNADO] [varchar](4) NULL,
	[COD_ENTIDAD_RECALIFICA] [int] NULL,
	[FECHA_RECALIFICACION] [date] NULL,
	[FECHA_RECALIFICACION_HASTA] [date] NULL,
	[ESTADO] [varchar](1) NULL,
	[COD_CATEGORIA_REEMPLAZA] [varchar](4) NULL,
	[COD_GRUPO_REEMPLAZA] [varchar](4) NULL,
	[PERIODICIDAD] [decimal](8, 2) NULL,
	[OBSERVACIONES] [varchar](255) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[ID_GARANTIA] [varchar](25) NULL,
	[COD_TIPO_MITIGADOR] [int] NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NULL,
	[ID_GARANTIA_FIDEICOMETIDA] [varchar](25) NULL,
	[COD_TIPO_MITIGADOR_FIDEICOMETIDO] [int] NULL,
	[MONTO_MITIGADOR_FIDEICOMETIDO] [decimal](25, 2) NULL,
	[VALOR_NOMINAL_FIDEICOMETIDO] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL_FIDEICOMETIDO] [int] NULL,
	[COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO] [int] NULL,
	[PORC_RESPONSABILIDAD_FIDEICOMETIDO] [decimal](5, 2) NULL,
	[FECHA_CONSTITUCION_GARANTIA_FIDEICOMETIDA] [date] NULL,
	[FECHA_VENCIMIENTO_GARANTIA_FIDEICOMETIDA] [date] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_GARANTIA_OPERACION_LISTA]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_GARANTIA_OPERACION_LISTA](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[N_REGISTRO_HIJO] [int] NULL,
	[EMPRESA] [int] NULL,
	[ID_OPERACION] [varchar](25) NULL,
	[COD_TIPO_GARANTIA] [int] NULL,
	[ID_GARANTIA] [varchar](25) NULL,
	[COD_TIPO_MITIGADOR] [int] NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[MONTO_MITIGADOR_FUENTE] [decimal](25, 2) NULL,
	[MONTO_MITIGADOR_CALCULADO] [decimal](25, 2) NULL,
	[IND_INSCRIPCION_GARANTIA] [int] NULL,
	[FECHA_PRESENTACION_REGISTRO_GARANTIA] [date] NULL,
	[PORC_RESPONSABILIDAD_GARANTIA] [decimal](7, 2) NULL,
	[MONTO_VALOR_NOMINAL_GARANTIA] [decimal](22, 0) NULL,
	[COD_TIPO_MONEDA_VALOR_NOMINAL_GARANTIA] [int] NULL,
	[PORC_ACEPTACION_FUENTE] [decimal](7, 2) NULL,
	[PORC_ACEPTACION_CALCULADO] [decimal](7, 2) NULL,
	[FECHA_CONSTITUCION_GARANTIA] [date] NULL,
	[FECHA_VENCIMIENTO_GARANTIA] [date] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_GARANTIAS_REALES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_GARANTIAS_REALES](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NULL,
	[ID_GARANTIA] [varchar](25) NULL,
	[COD_TIPO_BIEN] [int] NULL,
	[ID_BIEN] [varchar](25) NULL,
	[MONTO_ULTIMA_TASACION_TERRENO] [decimal](25, 2) NULL,
	[MONTO_ULTIMA_TASACION_NO_TERRENO] [decimal](25, 2) NULL,
	[FECHA_ULTIMA_TASACION_GARANTIA] [date] NULL,
	[MONTO_TASACION_ACTUALIZADA_TERRENO] [decimal](25, 2) NULL,
	[MONTO_TASACION_ACTUALIZADA_NO_TERRENO] [decimal](25, 2) NULL,
	[FECHA_ULTIMO_SEGUIMIENTO] [date] NULL,
	[FECHA_CONSTRUCCION] [date] NULL,
	[COD_TIPO_PERSONA_TASADOR] [int] NULL,
	[ID_TASADOR] [varchar](30) NULL,
	[COD_TIPO_PERSONA_EMPRESA_TASADORA] [int] NULL,
	[ID_EMPRESA_TASADORA] [varchar](30) NULL,
	[IND_POLIZA] [varchar](1) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_GRUPO_DEUDORES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_GRUPO_DEUDORES](
	[ID_DEUDOR] [varchar](30) NULL,
	[TIPO_DEUDOR] [int] NULL,
	[GRUPO] [int] NULL,
	[OPERACION] [varchar](25) NULL,
	[SALDO] [decimal](26, 4) NULL,
	[EMPRESA] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_GRUPO_INTEGRANTES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TMP_GRUPO_INTEGRANTES](
	[GRUPO] [int] NULL,
	[SALDO_GRUPO] [decimal](38, 4) NULL,
	[INTEGRANTES] [int] NULL,
	[EMPRESA] [int] NULL
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TMP_OPERACIONES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_OPERACIONES](
	[ID_ROW] [int] IDENTITY(1,1) NOT NULL,
	[N_REGISTRO] [int] NULL,
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_LINEA] [varchar](25) NULL,
	[COD_TIPO_OPERACION] [int] NULL,
	[COD_TIPO_CATALOGO_SUGEF] [int] NULL,
	[COD_PAIS_DESTINO_CREDITO] [varchar](4) NULL,
	[COD_PROVINCIA_DESTINO_CREDITO] [int] NULL,
	[COD_CANTON_DESTINO_CREDITO] [int] NULL,
	[COD_PROVINCIA_DEPENDENCIA_CREDITO] [int] NULL,
	[COD_CANTON_DEPENDENCIA_CREDITO] [int] NULL,
	[COD_TIPO_CARTERA] [int] NULL,
	[COD_TIPO_ESTADO_OPERACION] [int] NULL,
	[COD_TIPO_MONEDA_MONTO] [int] NULL,
	[MONTO_OPERACION_AUTORIZADO] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_PRINCIPAL_SUGEF] [bigint] NULL,
	[SALDO_PRINCIPAL] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_SUGEF] [bigint] NULL,
	[SALDO_PRINCIPAL_DEPOSITO_PREVIO] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_PRODUCTO_SUGEF] [bigint] NULL,
	[SALDO_PRODUCTO] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESTRUCTURAL] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_SUGEF] [bigint] NULL,
	[SALDO_DESEMBOLSAR_COMPROMISO] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_COMISIONES_SUGEF] [bigint] NULL,
	[SALDO_COMISIONES] [decimal](25, 2) NULL,
	[CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_SUGEF] [bigint] NULL,
	[SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO] [decimal](25, 2) NULL,
	[MONTO_DESEMBOLSADO] [decimal](25, 2) NULL,
	[FECHA_FORMALIZACION] [date] NULL,
	[FECHA_VENCIMIENTO] [date] NULL,
	[FRECUENCIA_PAGO_ACTUAL_PRINCIPAL] [int] NULL,
	[FRECUENCIA_PAGO_ACTUAL_INTERESES] [int] NULL,
	[FECHA_VENCIMIENTO_PERIODO_GRACIA_PRINCIPAL] [date] NULL,
	[COD_TASA_INTERES_NOMINAL_VIGENTE] [decimal](7, 2) NULL,
	[COD_TIPO_TASA] [varchar](2) NULL,
	[FACTOR_TIEMPO] [varchar](1) NULL,
	[COD_FORMA_PAGO_VIGENTE_PRINCIPAL] [varchar](1) NULL,
	[COD_FORMA_PAGO_VIGENTE_INTERESES] [varchar](1) NULL,
	[FECHA_CORTE_OPERACION] [date] NULL,
	[FECHA_PROXIMO_PAGO_PRINCIPAL] [date] NULL,
	[FECHA_PROXIMO_PAGO_INTERESES] [date] NULL,
	[FECHA_AMORTIZACION_HASTA] [date] NULL,
	[FECHA_INTERESES_HASTA] [date] NULL,
	[FECHA_PAGO_PACTADO_PRINCIPAL] [date] NULL,
	[FECHA_PAGO_PACTADO_INTERESES] [date] NULL,
	[PLAZO_OPERACION] [int] NULL,
	[COD_TIPO_CUOTA_PRINCIPAL] [int] NULL,
	[MONTO_CUOTA_PRINCIPAL_ACTUAL] [decimal](25, 2) NULL,
	[MONTO_CUOTA_INTERESES_ACTUAL] [decimal](25, 2) NULL,
	[IND_OPERACION_NUEVA] [varchar](3) NULL,
	[RECUPERACION_PRINCIPAL] [decimal](25, 2) NULL,
	[OTROS_AUMENTOS_PRINCIPAL] [decimal](25, 2) NULL,
	[OTRAS_DISMINUCIONES_PRINCIPAL] [decimal](25, 2) NULL,
	[IND_BACK_TO_BACK] [varchar](1) NULL,
	[IND_CREDITO_SINDICADO] [varchar](1) NULL,
	[IND_OPERACION_ESPECIAL] [varchar](2) NULL,
	[PCJ_RESPONSABILIDAD_LINEA] [decimal](7, 2) NULL,
	[CLAUSULA_LIMITE_CREDITO] [int] NULL,
	[COD_SISTEMA] [int] NULL,
	[COD_OFICINA] [varchar](5) NULL,
	[COD_PRODUCTO] [varchar](5) NULL,
	[ID_OPERACION_INTERNO] [varchar](25) NULL,
	[CUENTA_CONTABLE_PRINCIPAL_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_PRODUCTOS_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_COMISIONES_ENTIDAD] [bigint] NULL,
	[CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_ENTIDAD] [bigint] NULL,
	[ATRASO_CAPITAL] [int] NULL,
	[ATRASO_INTERES] [int] NULL,
	[FECHA_CAMBIO_TIPO_TASA] [date] NULL,
	[FRECUENCIA_AJUSTE_TASA_INTERES_VARIABLE] [int] NULL,
	[PARAMETRO_REFERENCIA_TASA_INTERES_VARIABLE] [int] NULL,
	[COMPONENTE_VARIABLE_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[COMPONENTE_FIJO_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[LIMITE_INFERIOR_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[LIMITE_SUPERIOR_TASA_INTERES_VARIABLE] [decimal](5, 2) NULL,
	[MONTO_ESTIMACION_GENERICA_DIRECTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_GENERICA_CONTINGENTE] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_CUBIERTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_DESCUBIERTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_CUBIERTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_DESCUBIERTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_CONTRA_CICLICA_DIRECTA] [decimal](25, 2) NULL,
	[MONTO_ESTIMACION_CONTRA_CICLICA_CONTINGENTE] [decimal](25, 2) NULL,
	[TIPO_SOBREGIRO] [int] NULL,
	[MONTO_INTERES_HASTA_180] [decimal](25, 2) NULL,
	[CANTIDAD_DIAS_HASTA_180] [int] NULL,
	[CANTIDAD_DIAS_MAS_180] [int] NULL,
	[MONTO_INTERES_ADELANTADO] [decimal](25, 2) NULL,
	[CANTIDAD_DIAS_ADELANTADO] [int] NULL,
	[FRECUENCIA_PAGO_ACTUAL_PRINCIPAL_FUENTE] [int] NULL,
	[FRECUENCIA_PAGO_ACTUAL_INTERESES_FUENTE] [int] NULL,
	[ID_DEUDOR_ENTIDAD] [varchar](50) NULL,
	[MONTO_ESTIMACION_REGISTRADA_OPERACION] [decimal](26, 4) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_RESP_CALCULOS_MONTO_TOTAL_ADEUDADO]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_RESP_CALCULOS_MONTO_TOTAL_ADEUDADO](
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[MONTO_TOTAL_ADEUDADO] [decimal](26, 4) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_RESP_CALCULOS_VAG]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_RESP_CALCULOS_VAG](
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_GARANTIA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[VALOR_AJUSTADO_GARANTIA] [decimal](26, 4) NULL,
	[PCJ_ACEPTACION] [decimal](9, 6) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_RESP_CALCULOS_VAPG]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_RESP_CALCULOS_VAPG](
	[EMPRESA] [int] NOT NULL,
	[COD_TIPO_GARANTIA] [int] NOT NULL,
	[ID_GARANTIA] [varchar](25) NOT NULL,
	[COD_TIPO_MITIGADOR] [int] NOT NULL,
	[COD_TIPO_DOCUMENTO_LEGAL] [int] NOT NULL,
	[MONTO_MITIGADOR] [decimal](22, 2) NULL,
	[ID_OPERACION] [varchar](25) NOT NULL,
	[ID_DEUDOR] [varchar](30) NULL,
	[COD_TIPO_PERSONA_DEUDOR] [int] NULL,
	[COD_CATEGORIA_RIESGO] [varchar](4) NULL,
	[PPSCR] [decimal](3, 2) NOT NULL,
	[VAPG] [decimal](26, 4) NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[TMP_SALDO_DEUDOR]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TMP_SALDO_DEUDOR](
	[ID_DEUDOR] [varchar](30) NULL,
	[GRUPO] [int] NULL,
	[SUMA_SALDO] [decimal](38, 4) NULL,
	[EMPRESA] [int] NULL,
	[TIPO_DEUDOR] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[VOFTEMP]    Script Date: 17/05/2016 03:43:32 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[VOFTEMP](
	[EMPRESA] [int] NOT NULL,
	[TipoPersona] [varchar](8) NULL,
	[IdDeudor] [varchar](15) NOT NULL,
	[IdOperacion] [numeric](8, 0) NOT NULL,
	[IdLinea] [numeric](8, 0) NOT NULL,
	[ActividadEconomica] [varchar](60) NULL,
	[EstadoOperacion] [varchar](7) NOT NULL,
	[MontoOriginalGirosLinea] [numeric](18, 2) NULL,
	[CuentaContableGirosLinea] [varchar](25) NULL,
	[SaldoGiro] [numeric](38, 2) NULL,
	[CuentaContableIngresosAsociados] [varchar](25) NULL,
	[SaldoIngresosAsociados] [int] NOT NULL,
	[MonedaGirosdeLinea] [varchar](4) NULL,
	[FechaFormalizacionGiro] [datetime] NOT NULL,
	[FechaVencimientoGiro] [datetime] NULL,
	[TasaInteresGiros] [numeric](5, 2) NULL,
	[TipoTasa] [varchar](4) NOT NULL,
	[FormaPagoPrincipal] [varchar](7) NOT NULL,
	[FormaPagoInteres] [varchar](10) NOT NULL,
	[RecuperacionPrincipalGiro] [numeric](38, 2) NULL,
	[MonFactura] [numeric](38, 2) NULL,
	[FechaCambioTipoTasa] [datetime] NULL,
	[FrecuenciaAjusteTasaInteresVariable] [int] NULL,
	[ParametroReferenciaTasaInteresVariable] [int] NULL,
	[ComponenteVariableTasaInteresVariable] [numeric](38, 2) NULL,
	[ComponenteFijoTasaInteresVariable] [numeric](38, 2) NULL,
	[LimiteInferiorTasaInteresVariable] [numeric](38, 2) NULL,
	[LimiteSuperiorTasaInteresVariable] [numeric](38, 2) NULL,
	[MIN_VENCIMIENTO] [date] NULL,
	[MAX_VENCIMIENTO] [date] NULL,
	[COD_CANTON_SUGEF] [int] NULL,
	[COD_PROVINCIA_SUGEF] [int] NULL,
	[COD_TIPO_MONEDA_SUGEF] [int] NULL,
	[VALOR] [decimal](15, 2) NULL,
	[FECHA_CORTE] [date] NULL,
	[FECHA_CORTE_ANTERIOR] [date] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [AUX_CUOTAS_MAX_DIAS_ATRASO_CAPITAL_LLAVES]    Script Date: 17/05/2016 03:43:32 p.m. ******/
CREATE CLUSTERED INDEX [AUX_CUOTAS_MAX_DIAS_ATRASO_CAPITAL_LLAVES] ON [dbo].[AUX_CUOTAS_MAX_DIAS_ATRASO_CAPITAL]
(
	[ID_DEUDOR] ASC,
	[ID_OPERACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [AUX_CUOTAS_MAX_DIAS_ATRASO_INTERES_LLAVES]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE CLUSTERED INDEX [AUX_CUOTAS_MAX_DIAS_ATRASO_INTERES_LLAVES] ON [dbo].[AUX_CUOTAS_MAX_DIAS_ATRASO_INTERES]
(
	[ID_DEUDOR] ASC,
	[ID_OPERACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [AUX_SICAD_TH_CREDITO_PRINCIPAL_DIRECTO_MES_ANTERIOR_COD_OPERA]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE CLUSTERED INDEX [AUX_SICAD_TH_CREDITO_PRINCIPAL_DIRECTO_MES_ANTERIOR_COD_OPERA] ON [dbo].[AUX_SICAD_TH_CREDITO_PRINCIPAL_DIRECTO_MES_ANTERIOR]
(
	[COD_OPERACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [AUX_SUMA_SALDOS_COD_OPERA]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE CLUSTERED INDEX [AUX_SUMA_SALDOS_COD_OPERA] ON [dbo].[AUX_SUMA_SALDOS]
(
	[COD_OPERACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [AUX_TD_CLIENTE_CLIENTE]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE CLUSTERED INDEX [AUX_TD_CLIENTE_CLIENTE] ON [dbo].[AUX_TD_CLIENTE]
(
	[COD_CLIENTE] ASC,
	[COD_TIPO_CLIENTE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Index [AUX_TIPO_CAMBIO_FINAL]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE CLUSTERED INDEX [AUX_TIPO_CAMBIO_FINAL] ON [dbo].[AUX_TIPO_CAMBIO]
(
	[FECHA_CORTE] ASC,
	[MONEDA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Index [AUX_TIPO_CAMBIO_CONTEO_AGRUPAR]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE CLUSTERED INDEX [AUX_TIPO_CAMBIO_CONTEO_AGRUPAR] ON [dbo].[AUX_TIPO_CAMBIO_CONTEO]
(
	[FECHA] ASC,
	[MONEDA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Index [AUX_TIPO_CAMBIO_LLAVES_FINAL]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE CLUSTERED INDEX [AUX_TIPO_CAMBIO_LLAVES_FINAL] ON [dbo].[AUX_TIPO_CAMBIO_LLAVES]
(
	[CONTADOR] ASC,
	[FECHA] ASC,
	[MONEDA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [AUX_PROVISION_OPERACIONES_01]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE NONCLUSTERED INDEX [AUX_PROVISION_OPERACIONES_01] ON [dbo].[AUX_PROVISION_OPERACIONES]
(
	[ID_OPERAC] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [AUX_PROVISION_OPERACIONES_02]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE NONCLUSTERED INDEX [AUX_PROVISION_OPERACIONES_02] ON [dbo].[AUX_PROVISION_OPERACIONES]
(
	[NUMERO_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [AUX_PROVISION_OPERACIONES_03]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE NONCLUSTERED INDEX [AUX_PROVISION_OPERACIONES_03] ON [dbo].[AUX_PROVISION_OPERACIONES]
(
	[ID_OPERAC] ASC,
	[NUMERO_GARANTIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO
/****** Object:  Index [AUX_TIPO_CAMBIO_CONTEO_FINAL]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE NONCLUSTERED INDEX [AUX_TIPO_CAMBIO_CONTEO_FINAL] ON [dbo].[AUX_TIPO_CAMBIO_CONTEO]
(
	[CONTADOR] ASC,
	[FECHA] ASC,
	[MONEDA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [IDX_CuotasOperacion]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE NONCLUSTERED INDEX [IDX_CuotasOperacion] ON [dbo].[CuotasOperacion]
(
	[ID_OPERACION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Index [IDX_GENERAL_BV_01]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE NONCLUSTERED INDEX [IDX_GENERAL_BV_01] ON [dbo].[GENERAL_BV]
(
	[N_VALIDACION] ASC,
	[EMPRESA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [IDX_1]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE NONCLUSTERED INDEX [IDX_1] ON [dbo].[MORA_DEUDOR]
(
	[ID_DEUDOR] ASC,
	[EMPRESA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Index [IDX_2]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE NONCLUSTERED INDEX [IDX_2] ON [dbo].[MORA_DEUDOR]
(
	[EMPRESA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Index [IDX_SICAD_SALDO_BV_01]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE NONCLUSTERED INDEX [IDX_SICAD_SALDO_BV_01] ON [dbo].[SICAD_SALDO_BV]
(
	[N_VALIDACION] ASC,
	[EMPRESA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Index [IX_TMP_CALCULOS_RESPONSABILIDAD_LINEA_01]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE NONCLUSTERED INDEX [IX_TMP_CALCULOS_RESPONSABILIDAD_LINEA_01] ON [dbo].[TMP_CALCULOS_RESPONSABILIDAD_LINEA]
(
	[ORDEN] ASC,
	[EMPRESA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [IX_TMP_CALCULOS_RESPONSABILIDAD_LINEA_02]    Script Date: 17/05/2016 03:43:33 p.m. ******/
CREATE NONCLUSTERED INDEX [IX_TMP_CALCULOS_RESPONSABILIDAD_LINEA_02] ON [dbo].[TMP_CALCULOS_RESPONSABILIDAD_LINEA]
(
	[ID_LINEA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'BIENES_REALIZABLES_NO_REPORTADOS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'BIENES_REALIZABLES_NO_REPORTADOS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_BIEN_REALIZABLE'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'CUOTAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'CUOTAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'CUOTAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_CUOTA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'CUOTAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'NUM_CUOTA_ATRASADA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DEUDORES_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DEUDORES_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_PERSONA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DEUDORES_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_DEUDOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DEUDORES_RECALIFICADOS', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DEUDORES_RECALIFICADOS', @level2type=N'COLUMN',@level2name=N'COD_TIPO_PERSONA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DEUDORES_RECALIFICADOS', @level2type=N'COLUMN',@level2name=N'ID_DEUDOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'DEUDORES_RECALIFICADOS', @level2type=N'COLUMN',@level2name=N'COD_ENTIDAD_RECALIFICA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_MITIGADOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_DOCUMENTO_LEGAL'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA_FIDEICOMETIDA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_MITIGADOR_FIDEICOMETIDO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_MITIGADOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_DOCUMENTO_LEGAL'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA_FIDEICOMETIDA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_MITIGADOR_FIDEICOMETIDA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_GRADO_GRAVAMENES_FIDEICOMETIDA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_PERSONA_ACREEDOR_FIDEICOMETIDA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_ACREEDOR_FIDEICOMETIDA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_MITIGADOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_DOCUMENTO_LEGAL'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_GRADO_GRAVAMENES'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_PERSONA_ACREEDOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_ACREEDOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_LISTA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_LISTA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_LISTA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_LISTA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_MITIGADOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_LISTA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_DOCUMENTO_LEGAL'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_PRIORIDAD_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_PRIORIDAD_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_PRIORIDAD_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_PRIORIDAD_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_MITIGADOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_PRIORIDAD_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_DOCUMENTO_LEGAL'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_PRIORIDAD_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_GRADO_PRIORIDADES'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_PRIORIDAD_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_PERSONA_BENEFICIARIO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIA_OPERACION_PRIORIDAD_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_BENEFICIARIO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_CARTA_CREDITO_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_CARTA_CREDITO_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_CARTAS_CREDITO_IMPORTACION_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_CARTAS_CREDITO_IMPORTACION_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_POLIZA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'MONTO_POLIZA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'FECHA_VENCIMIENTO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'IND_COBERTURA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_PESONA_BENEFICIARIO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_BENEFICIARIO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA_ENTIDAD'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FACTURAS_CEDIDAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FACTURAS_CEDIDAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA_FIDEICOMETIDA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_MITIGADOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_DOCUMENTO_LEGAL'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA_FIDEICOMETIDA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_MITIGADOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_DOCUMENTO_LEGAL'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_GRADO_GRAVAMEN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_PERSONA_ACREEDOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_ACREEDOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDUCIARIAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_FIDUCIARIAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_REALES_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_REALES_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_REALES_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_REALES_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_REALES_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_POLIZA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_REALES_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'MONTO_POLIZA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_REALES_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'FECHA_VENCIMIENTO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_REALES_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'IND_COBERTURA_POLIZA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_REALES_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_PERSONA_BENEFICIARIO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_REALES_POLIZA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_BENEFICIARIO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_VALORES_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'GARANTIAS_VALORES_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_GARANTIA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_ACTIVIDAD_ECONOMICA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_ACTIVIDAD_ECONOMICA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_ACTIVIDAD_ECONOMICA_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_ACTIVIDAD_ECONOMICA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_CODEUDORES_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_CODEUDORES_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_CODEUDORES_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_PERSONA_CODEUDOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_CODEUDORES_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_CODEUDOR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_CREDITO_SINDICADO_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_CREDITO_SINDICADO_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_CREDITO_SINDICADO_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_CREDITO_SINDICADO_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_ENTIDAD_CREDITO_SINDICADO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_CREDITO_SINDICADO_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION_ENTIDAD_CREDITO_SINDICADO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_MODIFICACION_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_MODIFICACION_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_MODIFICACION_ENTIDAD', @level2type=N'COLUMN',@level2name=N'FECHA_MODIFICACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_MODIFICACION_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_MODIFICACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_MODIFICACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'FECHA_MODIFICACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_PERSONA_ENTIDAD_OPERACION_CANCELADA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_ENTIDAD_OPERACION_CANCELADA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION_CANCELADA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_NATURALEZA_GASTO_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_NATURALEZA_GASTO_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_NATURALEZA_GASTO_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_NATURALEZA_GASTO'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_OPERACION_ESPECIAL_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_OPERACION_ESPECIAL_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_OPERACION_ESPECIAL_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_OPERACION_ESPECIAL'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_ORIGEN_RECURSOS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_ORIGEN_RECURSOS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_ORIGEN_RECURSOS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_ORIGEN_RECURSOS'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_SALDOS_CUENTAS_COBRAR_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_SALDOS_CUENTAS_COBRAR_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_OPERACION'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_SALDOS_CUENTAS_COBRAR_ENTIDAD', @level2type=N'COLUMN',@level2name=N'CUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_SALDOS_CUENTAS_COBRAR_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_MONEDA_CUENTAS_COBRAR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'OPERACIONES_SALDOS_CUENTAS_COBRAR_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ATRASO_CUENTAS_COBRAR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'PERSONAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'EMPRESA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'PERSONAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'COD_TIPO_PERSONA'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Llave primaria de la tabla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'PERSONAS_ENTIDAD', @level2type=N'COLUMN',@level2name=N'ID_PERSONA'
GO



PRINT N'Creating VIEWS...';
GO


/****** Object:  View [dbo].[VW_SALDO_BASE_PROV]    Script Date: 17/05/2016 03:44:26 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW [dbo].[VW_SALDO_BASE_PROV]
AS

SELECT SALDO = CASE 

 	            --TARJETA  
   	            WHEN LEFT(O.CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_SUGEF, 5) = '61502' 
	            THEN CASE   
    		              WHEN (LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61103' 
    		                   AND RIGHT(RTRIM(LTRIM(LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 8))), 2) = '02')   
			              THEN ((ISNULL(O.SALDO_PRINCIPAL, 0) * 0.05)
			                   + ISNULL(O.SALDO_PRODUCTO, 0)
			                   + ISNULL(OSCC.SALDO_CUENTAS_COBRAR, 0))  

     		              WHEN (LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61202'
     		                    OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61204')
			              THEN ((ISNULL(O.SALDO_PRINCIPAL * 0.05, 0))
			                   + ISNULL(O.SALDO_PRODUCTO, 0)
			                   + ISNULL(OSCC.SALDO_CUENTAS_COBRAR, 0))  

     		              WHEN ((LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61102'
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61101'
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61104'
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61301')
     		                   AND RIGHT(RTRIM(LTRIM(LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 8))), 2) = '02') 
     		                   OR LEFT (CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61701' 
			              THEN ((ISNULL(O.SALDO_PRINCIPAL, 0) * 0.25)
			                   + ISNULL(O.SALDO_PRODUCTO, 0)
			                   + ISNULL(OSCC.SALDO_CUENTAS_COBRAR, 0))  

     		              WHEN ((LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61101'
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61102'
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61103'
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61104' 
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61301') 
     		                     AND RIGHT(RTRIM(LTRIM(LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 8))), 2) = '01') 
     		                   OR (LEFT (CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61201' 
     		                       OR LEFT (CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61203')
			              THEN (ISNULL(O.SALDO_PRODUCTO, 0)
			                   + ISNULL(OSCC.SALDO_CUENTAS_COBRAR, 0))  

     		              ELSE (ISNULL(O.SALDO_PRINCIPAL, 0) 
     		                   + ISNULL(O.SALDO_PRODUCTO, 0)
     		                   + ISNULL(OSCC.SALDO_CUENTAS_COBRAR, 0))  
                      END   
               
	            --NO TARJETA  
	            ELSE CASE   
     		              WHEN (LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61103' 
     		                    AND RIGHT(RTRIM(LTRIM(LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 8))), 2) = '02')  
			              THEN ((ISNULL(O.SALDO_PRINCIPAL, 0) * 0.05)
			                   + ISNULL(O.SALDO_PRODUCTO, 0)
			                   + ISNULL(OSCC.SALDO_CUENTAS_COBRAR, 0)
			                   + (ISNULL(O.SALDO_DESEMBOLSAR_COMPROMISO, 0)))  

     		              WHEN (LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61202'
     		                    OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61204')
			              THEN ((ISNULL(O.SALDO_PRINCIPAL * 0.05, 0))
			                   + ISNULL(O.SALDO_PRODUCTO, 0)
			                   + ISNULL(OSCC.SALDO_CUENTAS_COBRAR, 0))  

     		              WHEN ((LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61102'
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61101'
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61104'
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61301')
     		                     AND RIGHT(RTRIM(LTRIM(LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 8))), 2) = '02') 
     		                   OR LEFT (CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61701' 
			              THEN ((ISNULL(O.SALDO_PRINCIPAL, 0) * 0.25)
			                   + ISNULL(O.SALDO_PRODUCTO, 0)
			                   + ISNULL(OSCC.SALDO_CUENTAS_COBRAR, 0)
			                   + (ISNULL(O.SALDO_DESEMBOLSAR_COMPROMISO, 0)))   

     		              WHEN ((LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61101'
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61102'
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61103'
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61104' 
     		                     OR LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61301') 
     		                     AND RIGHT(RTRIM(LTRIM(LEFT(CUENTA_CONTABLE_PRINCIPAL_SUGEF, 8))), 2)='01') 
     		                   OR (LEFT (CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61201' 
     		                        OR LEFT (CUENTA_CONTABLE_PRINCIPAL_SUGEF, 5) = '61203')
			              THEN (ISNULL(O.SALDO_PRODUCTO, 0)
			                   + ISNULL(OSCC.SALDO_CUENTAS_COBRAR, 0)
			                   + (ISNULL(O.SALDO_DESEMBOLSAR_COMPROMISO, 0)))         

     		              ELSE (ISNULL(O.SALDO_PRINCIPAL, 0) 
     		                   + ISNULL(O.SALDO_PRODUCTO, 0)
     		                   + ISNULL(OSCC.SALDO_CUENTAS_COBRAR, 0)
     		                   + (ISNULL(O.SALDO_DESEMBOLSAR_COMPROMISO, 0)))  
                      END
               
                END, 
                ID_DEUDOR, 
                O.ID_OPERACION,
                O.EMPRESA
    
  FROM dbo.OPERACIONES O
  LEFT JOIN dbo.OPERACIONES_SALDOS_CUENTAS_COBRAR OSCC
	ON OSCC.ID_OPERACION = O.ID_OPERACION
	AND OSCC.EMPRESA = O.EMPRESA



GO


PRINT N'Creating STORED PROCEDURES...';
GO


/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla BIENES_REALIZABLES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_Actualiza]
	@piID_ROW											INT = NULL,	
	@psIND_GARANTIA										VARCHAR(6) = NULL,
	@psID_GARANTIA										VARCHAR(25) = NULL,
	@psID_BIEN											VARCHAR(25) = NULL,
	@piCOD_TIPO_BIEN									INT = NULL,
	@pdtFECHA_ADJUDICACION_DACION_BIEN					DATE = NULL,
	@pdSALDO_REGISTRO_CONTABLE							DECIMAL(25,2) = NULL,
	@piCOD_TIPO_MONEDA_SALDO_REGISTRO_CONTABLE			INT= NULL ,
	@piCUENTA_CATALOGO_SUGEF							INT= NULL,
	@piCOD_TIPO_CATALOGO_SUGEF							INT= NULL,
	@pdtFECHA_ULTIMA_TASACION_BIEN						DATE= NULL,
	@pdMONTO_TASACION									DECIMAL(25,2)= NULL,
	@piCOD_TIPO_MONEDA_MONTO_TASACION					INT= NULL,
	@piCOD_TIPO_PERSONA_TASADOR							INT= NULL,
	@psID_TASADOR										VARCHAR(30)= NULL,
	@piCOD_TIPO_PERSONA_EMPRESA_TASADORA				INT= NULL,
	@psID_EMPRESA_TASADORA								VARCHAR(30)= NULL,
	@pdSALDO_CONTABLE_CREDITO_CANCELADO					DECIMAL(25,2)= NULL,
	@pdCOD_TIPO_MONEDA_SALDO_CONTABLE_CREDITO_CANCELADO	INT= NULL,
	@pdMONTO_ESTIMACION									DECIMAL(25,2)= NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE dbo.BIENES_REALIZABLES
		SET		IND_GARANTIA										= @psIND_GARANTIA,
				ID_GARANTIA											= @psID_GARANTIA,
				ID_BIEN												= @psID_BIEN,
				COD_TIPO_BIEN										= @piCOD_TIPO_BIEN,
				FECHA_ADJUDICACION_DACION_BIEN						= @pdtFECHA_ADJUDICACION_DACION_BIEN,
				SALDO_REGISTRO_CONTABLE								= @pdSALDO_REGISTRO_CONTABLE,
				COD_TIPO_MONEDA_SALDO_REGISTRO_CONTABLE				= @piCOD_TIPO_MONEDA_SALDO_REGISTRO_CONTABLE,
				CUENTA_CATALOGO_SUGEF								= @piCUENTA_CATALOGO_SUGEF,
				COD_TIPO_CATALOGO_SUGEF								= @piCOD_TIPO_CATALOGO_SUGEF,
				FECHA_ULTIMA_TASACION_BIEN							= @pdtFECHA_ULTIMA_TASACION_BIEN,
				MONTO_TASACION										= @pdMONTO_TASACION,
				COD_TIPO_MONEDA_MONTO_TASACION						= @piCOD_TIPO_MONEDA_MONTO_TASACION,
				COD_TIPO_PERSONA_TASADOR							= @piCOD_TIPO_PERSONA_TASADOR,
				ID_TASADOR											= @psID_TASADOR,
				COD_TIPO_PERSONA_EMPRESA_TASADORA					= @piCOD_TIPO_PERSONA_EMPRESA_TASADORA,
				ID_EMPRESA_TASADORA									= @psID_EMPRESA_TASADORA,
				SALDO_CONTABLE_CREDITO_CANCELADO					= @pdSALDO_CONTABLE_CREDITO_CANCELADO,
				COD_TIPO_MONEDA_SALDO_CONTABLE_CREDITO_CANCELADO	= @pdCOD_TIPO_MONEDA_SALDO_CONTABLE_CREDITO_CANCELADO,
				MONTO_ESTIMACION = @pdMONTO_ESTIMACION
		WHERE	ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Bienes_Realizables_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla BIENES_REALIZABLES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   
	ID INT IDENTITY(0,1),
	ID_ROW INT
)
 DECLARE @maxRow INT
DECLARE @vsSQL VARCHAR(4000)
SET @filterValue = UPPER('%' + @filterValue + '%')

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_BIEN_REALIZABLE' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow

SET @vsSQL = (SELECT 'SELECT ID_ROW FROM dbo.BIENES_REALIZABLES
				WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(')

SET @vsSQL = @vsSQL + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_ADJUDICACION_DACION_BIEN' THEN 'CONVERT(VARCHAR,FECHA_ADJUDICACION_DACION_BIEN,103)' 
							ELSE +@filterColumn END )

SET @vsSQL = @vsSQL + ( ','''')) LIKE ''' + @filterValue + '''
							ORDER BY ' + @sortColumn)

INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL)
--EXECUTE('SELECT ID_ROW 
--           FROM dbo.BIENES_REALIZABLES BR
--WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(' + @filterColumn + ') LIKE ''' + @filterValue + '''
--ORDER BY ' + @sortColumn)
SET ROWCOUNT @maximumRows
	SELECT 
		BR.ID_ROW, 
		BR.EMPRESA,
		BR.N_REGISTRO,
		BR.COD_FORMA_ADQUISICION_BIEN,
		BR.ID_BIEN_REALIZABLE,
		BR.IND_GARANTIA,
		BR.ID_GARANTIA,
		BR.ID_BIEN,
		BR.COD_TIPO_BIEN,
		BR.FECHA_ADJUDICACION_DACION_BIEN,
		BR.SALDO_REGISTRO_CONTABLE,
		BR.COD_TIPO_MONEDA_SALDO_REGISTRO_CONTABLE,
		BR.CUENTA_CATALOGO_SUGEF,
		BR.COD_TIPO_CATALOGO_SUGEF,
		BR.FECHA_ULTIMA_TASACION_BIEN,
		BR.MONTO_TASACION,
		BR.COD_TIPO_MONEDA_MONTO_TASACION,
		BR.COD_TIPO_PERSONA_TASADOR,
		BR.ID_TASADOR,
		BR.COD_TIPO_PERSONA_EMPRESA_TASADORA,
		BR.ID_EMPRESA_TASADORA,
		BR.SALDO_CONTABLE_CREDITO_CANCELADO,
		BR.COD_TIPO_MONEDA_SALDO_CONTABLE_CREDITO_CANCELADO,
		BR.MONTO_ESTIMACION
	FROM @TempItems T 
		INNER JOIN dbo.BIENES_REALIZABLES BR
			ON BR.ID_ROW = T.ID_ROW 
	WHERE ID >= @startRowIndex		
SET ROWCOUNT 0




GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla BIENES_REALIZABLES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT	ID_ROW,
			EMPRESA,
			N_REGISTRO,
			COD_FORMA_ADQUISICION_BIEN,
			ID_BIEN_REALIZABLE,
			IND_GARANTIA,
			ID_GARANTIA,
			ID_BIEN,
			COD_TIPO_BIEN,
			FECHA_ADJUDICACION_DACION_BIEN,
			SALDO_REGISTRO_CONTABLE,
			COD_TIPO_MONEDA_SALDO_REGISTRO_CONTABLE,
			CUENTA_CATALOGO_SUGEF,
			COD_TIPO_CATALOGO_SUGEF,
			FECHA_ULTIMA_TASACION_BIEN,
			MONTO_TASACION,
			COD_TIPO_MONEDA_MONTO_TASACION,
			COD_TIPO_PERSONA_TASADOR,
			ID_TASADOR,
			COD_TIPO_PERSONA_EMPRESA_TASADORA,
			ID_EMPRESA_TASADORA,
			SALDO_CONTABLE_CREDITO_CANCELADO,
			COD_TIPO_MONEDA_SALDO_CONTABLE_CREDITO_CANCELADO,
			MONTO_ESTIMACION
	FROM	dbo.BIENES_REALIZABLES
	WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Bienes_Realizables_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla BIENES_REALIZABLES.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = UPPER('%' + @filterValue + '%')

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.BIENES_REALIZABLES BR 
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL('

SET @StrSQL = @StrSQL + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_ADJUDICACION_DACION_BIEN' THEN 'CONVERT(VARCHAR,FECHA_ADJUDICACION_DACION_BIEN,103)' 							
							ELSE +@filterColumn END )

SET @StrSQL = @StrSQL + ( ','''')) LIKE ''' + @filterValue + '''' )

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount




GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla BIENES_REALIZABLES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM dbo.BIENES_REALIZABLES
		WHERE ID_ROW = @piID_ROW
		
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla BIENES_REALIZABLES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_Inserta]	
	@piEMPRESA											INT = NULL, 
	@piCOD_FORMA_ADQUISICION_BIEN						INT = NULL,
	@psID_BIEN_REALIZABLE								VARCHAR(25) = NULL,
	@psIND_GARANTIA										VARCHAR(6) = NULL,
	@psID_GARANTIA										VARCHAR(25) = NULL,
	@psID_BIEN											VARCHAR(25) = NULL,
	@piCOD_TIPO_BIEN									INT = NULL,
	@pdtFECHA_ADJUDICACION_DACION_BIEN					DATE = NULL,
	@pdSALDO_REGISTRO_CONTABLE							DECIMAL(25,2) = NULL,
	@piCOD_TIPO_MONEDA_SALDO_REGISTRO_CONTABLE			INT = NULL,
	@piCUENTA_CATALOGO_SUGEF							INT = NULL,
	@piCOD_TIPO_CATALOGO_SUGEF							INT = NULL,
	@pdtFECHA_ULTIMA_TASACION_BIEN						DATE = NULL,
	@pdMONTO_TASACION									DECIMAL(25,2) = NULL,
	@piCOD_TIPO_MONEDA_MONTO_TASACION					INT = NULL,
	@piCOD_TIPO_PERSONA_TASADOR							INT = NULL,
	@psID_TASADOR										VARCHAR(30) = NULL,
	@piCOD_TIPO_PERSONA_EMPRESA_TASADORA				INT = NULL,
	@psID_EMPRESA_TASADORA								VARCHAR(30) = NULL,
	@pdSALDO_CONTABLE_CREDITO_CANCELADO					DECIMAL(25,2) = NULL,
	@piCOD_TIPO_MONEDA_SALDO_CONTABLE_CREDITO_CANCELADO	INT = NULL,
	@pdMONTO_ESTIMACION									DECIMAL(25,2) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.BIENES_REALIZABLES (
					EMPRESA,
					COD_FORMA_ADQUISICION_BIEN,
					ID_BIEN_REALIZABLE,
					IND_GARANTIA,
					ID_GARANTIA,
					ID_BIEN,
					COD_TIPO_BIEN,
					FECHA_ADJUDICACION_DACION_BIEN,
					SALDO_REGISTRO_CONTABLE,
					COD_TIPO_MONEDA_SALDO_REGISTRO_CONTABLE,
					CUENTA_CATALOGO_SUGEF,
					COD_TIPO_CATALOGO_SUGEF,
					FECHA_ULTIMA_TASACION_BIEN,
					MONTO_TASACION,
					COD_TIPO_MONEDA_MONTO_TASACION,
					COD_TIPO_PERSONA_TASADOR,
					ID_TASADOR,
					COD_TIPO_PERSONA_EMPRESA_TASADORA,
					ID_EMPRESA_TASADORA,
					SALDO_CONTABLE_CREDITO_CANCELADO,
					COD_TIPO_MONEDA_SALDO_CONTABLE_CREDITO_CANCELADO,
					MONTO_ESTIMACION)

		SELECT 		@piEMPRESA,
					@piCOD_FORMA_ADQUISICION_BIEN,
					@psID_BIEN_REALIZABLE,
					@psIND_GARANTIA,
					@psID_GARANTIA,
					@psID_BIEN,
					@piCOD_TIPO_BIEN,
					@pdtFECHA_ADJUDICACION_DACION_BIEN,
					@pdSALDO_REGISTRO_CONTABLE,
					@piCOD_TIPO_MONEDA_SALDO_REGISTRO_CONTABLE,
					@piCUENTA_CATALOGO_SUGEF,
					@piCOD_TIPO_CATALOGO_SUGEF,
					@pdtFECHA_ULTIMA_TASACION_BIEN,
					@pdMONTO_TASACION,
					@piCOD_TIPO_MONEDA_MONTO_TASACION,
					@piCOD_TIPO_PERSONA_TASADOR,
					@psID_TASADOR,
					@piCOD_TIPO_PERSONA_EMPRESA_TASADORA,
					@psID_EMPRESA_TASADORA,
					@pdSALDO_CONTABLE_CREDITO_CANCELADO,
					@piCOD_TIPO_MONEDA_SALDO_CONTABLE_CREDITO_CANCELADO,
					@pdMONTO_ESTIMACION	

			COMMIT TRANSACTION TRA_Control
			SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_No_Reportados_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_No_Reportados_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla BIENES_REALIZABLES_NO_REPORTADOS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_No_Reportados_Actualiza]
	@piID_ROW								INT =NULL,
	@psIND_GARANTIA							VARCHAR(6) =NULL,
	@psID_GARANTIA							VARCHAR(25) =NULL,
	@psID_BIEN								VARCHAR(25) =NULL,
	@piCOD_TIPO_BIEN						INT =NULL,
	@piCOD_TIPO_MOTIVO_BIEN_NO_REPORTADO	INT =NULL,
	@pdULTIMO_VALOR_CONTABLE				DECIMAL(25,2) =NULL,
	@pdVALOR_RECUPERADO_NETO				DECIMAL(25,2) =NULL,
	@psID_OPERACION_FINANCIAMIENTO			VARCHAR(25) =NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.BIENES_REALIZABLES_NO_REPORTADOS
		SET 	IND_GARANTIA						= @psIND_GARANTIA,
				ID_GARANTIA							= @psID_GARANTIA,
				ID_BIEN								= @psID_BIEN,
				COD_TIPO_BIEN						= @piCOD_TIPO_BIEN,
				COD_TIPO_MOTIVO_BIEN_NO_REPORTADO	= @piCOD_TIPO_MOTIVO_BIEN_NO_REPORTADO,
				ULTIMO_VALOR_CONTABLE				= @pdULTIMO_VALOR_CONTABLE,
				VALOR_RECUPERADO_NETO				= @pdVALOR_RECUPERADO_NETO,
				ID_OPERACION_FINANCIAMIENTO			= @psID_OPERACION_FINANCIAMIENTO
		WHERE	ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_No_Reportados_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/*
Bienes_Realizables_No_Reportados_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla BIENES_REALIZABLES_NO_REPORTADOS
Sistema(s): SICAD

Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_No_Reportados_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   
	ID INT IDENTITY(0,1),
	ID_ROW INT
)
 DECLARE @maxRow INT
 DECLARE @vsSQL VARCHAR(4000)

SET @vsSQL = ('SELECT ID_ROW
				FROM dbo.BIENES_REALIZABLES_NO_REPORTADOS BRNR
				WHERE EMPRESA = ' + CAST(@filtroEmpresa AS VARCHAR)+ ' AND ')


 IF @filterColumn = 'ULTIMO_VALOR_CONTABLE' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))
	SET @vsSQL = @vsSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	SET @vsSQL = @vsSQL + ' UPPER(ISNULL('  + @filterColumn + ',''''))   LIKE ''' + @filterValue + ''''
END

SET @vsSQL = @vsSQL + ' ORDER BY ' + CASE WHEN @sortColumn = '' THEN 'ID_BIEN_REALIZABLE' ELSE @sortColumn END

--IF @filterColumn = 'ULTIMO_VALOR_CONTABLE'
--BEGIN
--	SET @filterColumn = ' format('+@filterColumn+',''N'','''+(SICAD_CONFIGURACION.dbo.Valor_Parametro(1))+''')'
--END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL)

SET ROWCOUNT @maximumRows

SELECT BRNR.ID_ROW,
	   BRNR.EMPRESA,
       BRNR.N_REGISTRO,
       BRNR.ID_BIEN_REALIZABLE,
       BRNR.IND_GARANTIA,
       BRNR.ID_GARANTIA,
       BRNR.ID_BIEN,
       BRNR.COD_TIPO_BIEN,
       BRNR.COD_TIPO_MOTIVO_BIEN_NO_REPORTADO,
       BRNR.ULTIMO_VALOR_CONTABLE,
       BRNR.VALOR_RECUPERADO_NETO,
       BRNR.ID_OPERACION_FINANCIAMIENTO
  FROM @TempItems TEMP
        INNER JOIN dbo.BIENES_REALIZABLES_NO_REPORTADOS BRNR
                ON BRNR.ID_ROW = TEMP.ID_ROW 
 WHERE TEMP.ID >= @startRowIndex
 
SET ROWCOUNT 0



GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_no_Reportados_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_no_Reportados_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla BIENES_REALIZABLES_NO_REPORTADOS
Sistema(s): SICAD

Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_no_Reportados_Consulta_Detalle]
	(@piID_ROW INT)
AS

SELECT ID_ROW,
	   EMPRESA,
       N_REGISTRO,
       ID_BIEN_REALIZABLE,
       IND_GARANTIA,
       ID_GARANTIA,
       ID_BIEN,
       COD_TIPO_BIEN,
       COD_TIPO_MOTIVO_BIEN_NO_REPORTADO,
       ULTIMO_VALOR_CONTABLE,
       VALOR_RECUPERADO_NETO,
       ID_OPERACION_FINANCIAMIENTO
  FROM dbo.BIENES_REALIZABLES_NO_REPORTADOS
 WHERE ID_ROW = @piID_ROW





GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_No_Reportados_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Bienes_Realizables_no_Reportados_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla BIENES_REALIZABLES_NO_REPORTADOS
Sistema(s): SICAD

Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_No_Reportados_Consulta_Detalle]
	(@piID_ROW INT)
AS

SELECT ID_ROW,
	   EMPRESA,
       N_REGISTRO,
       ID_BIEN_REALIZABLE,
       IND_GARANTIA,
       ID_GARANTIA,
       ID_BIEN,
       COD_TIPO_BIEN,
       COD_TIPO_MOTIVO_BIEN_NO_REPORTADO,
       ULTIMO_VALOR_CONTABLE,
       VALOR_RECUPERADO_NETO,
       ID_OPERACION_FINANCIAMIENTO
  FROM dbo.BIENES_REALIZABLES_NO_REPORTADOS
 WHERE ID_ROW = @piID_ROW




GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_No_Reportados_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_No_Reportados_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla BIENES_REALIZABLES_NO_REPORTADOS.
Sistema(s): SICAD

Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_No_Reportados_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
				  FROM dbo.BIENES_REALIZABLES_NO_REPORTADOS BRNR 
				 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND '


 IF @filterColumn = 'ULTIMO_VALOR_CONTABLE' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))

	SET @StrSQL = @StrSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')

	SET @StrSQL = @StrSQL + ' UPPER(ISNULL('  + @filterColumn + ',''''))   LIKE ''' + @filterValue + ''''
END



EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount





GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_No_Reportados_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_No_Reportados_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla BIENES_REALIZABLES_NO_REPORTADOS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_No_Reportados_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE
		FROM	dbo.BIENES_REALIZABLES_NO_REPORTADOS
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_No_Reportados_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_No_Reportados_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla BIENES_REALIZABLES_NO_REPORTADOS
Sistema(s): SICAD
Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_No_Reportados_Inserta]	
    @piEMPRESA							 INT = NULL,
    @psID_BIEN_REALIZABLE				 VARCHAR(25) = NULL,
    @psIND_GARANTIA						 VARCHAR(6) = NULL,
    @psID_GARANTIA						 VARCHAR(25) = NULL,
    @psID_BIEN							 VARCHAR(25) = NULL,
    @piCOD_TIPO_BIEN					 INT = NULL,
    @piCOD_TIPO_MOTIVO_BIEN_NO_REPORTADO INT = NULL,
    @pdULTIMO_VALOR_CONTABLE			 DECIMAL(25,2) = NULL,
    @pdVALOR_RECUPERADO_NETO			 DECIMAL(25,2) = NULL,
    @psID_OPERACION_FINANCIAMIENTO		 VARCHAR(25)  = NULL
AS
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO	dbo.BIENES_REALIZABLES_NO_REPORTADOS (
					EMPRESA,
					ID_BIEN_REALIZABLE,
					IND_GARANTIA,
					ID_GARANTIA,
					ID_BIEN,
					COD_TIPO_BIEN,
					COD_TIPO_MOTIVO_BIEN_NO_REPORTADO,
					ULTIMO_VALOR_CONTABLE,
					VALOR_RECUPERADO_NETO,
					ID_OPERACION_FINANCIAMIENTO)
		SELECT		@piEMPRESA,
					@psID_BIEN_REALIZABLE,
					@psIND_GARANTIA,
					@psID_GARANTIA,
					@psID_BIEN,
					@piCOD_TIPO_BIEN,
					@piCOD_TIPO_MOTIVO_BIEN_NO_REPORTADO,
					@pdULTIMO_VALOR_CONTABLE,
					@pdVALOR_RECUPERADO_NETO,
					@psID_OPERACION_FINANCIAMIENTO	

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_Operaciones_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_Operaciones_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla BIENES_REALIZABLES_OPERACIONES
Sistema(s): SICAD
Historial de cambios:

*/
CREATE PROCEDURE [dbo].[Bienes_Realizables_Operaciones_Actualiza]
	@piID_ROW					INT =NULL,	
	@psID_BIEN_REALIZABLE		VARCHAR(25) =NULL,
	@piCOD_TIPO_PERSONA_DEUDOR	INT =NULL,
	@psID_DEUDOR				VARCHAR(30) =NULL,
	@psID_OPERACION				VARCHAR(25) =NULL

AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.BIENES_REALIZABLES_OPERACIONES
		SET		ID_BIEN_REALIZABLE		= @psID_BIEN_REALIZABLE,
				COD_TIPO_PERSONA_DEUDOR = @piCOD_TIPO_PERSONA_DEUDOR,
				ID_DEUDOR				= @psID_DEUDOR,
				ID_OPERACION			= @psID_OPERACION
		WHERE	ID_ROW					= @piID_ROW
		
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_Operaciones_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_Operaciones_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla BIENES_REALIZABLES_OPERACIONES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_Operaciones_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(  ID INT IDENTITY(0,1),
   ID_ROW INT)
 DECLARE @maxRow INT
 SET @filterValue = '%' + @filterValue + '%'

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_BIEN_REALIZABLE' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT 
			ID_ROW
		FROM dbo.BIENES_REALIZABLES_OPERACIONES
WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
ORDER BY ' + @sortColumn)
SET ROWCOUNT @maximumRows
	SELECT 
		E.ID_ROW,
		E.EMPRESA,
		E.N_REGISTRO,
		E.ID_BIEN_REALIZABLE,
		E.COD_TIPO_PERSONA_DEUDOR,
		E.ID_DEUDOR,
		E.ID_OPERACION
	FROM @TempItems T 
		INNER JOIN dbo.BIENES_REALIZABLES_OPERACIONES E 
			ON E.ID_ROW = T.ID_ROW 
	WHERE ID >= @startRowIndex		

SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_Operaciones_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_Operaciones_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla BIENES_REALIZABLES_OPERACIONES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_Operaciones_Consulta_Detalle]
   (@piID_ROW INT)
AS
	SELECT  ID_ROW,
			EMPRESA,
			N_REGISTRO,
			ID_BIEN_REALIZABLE,
			COD_TIPO_PERSONA_DEUDOR,
			ID_DEUDOR,
			ID_OPERACION
	FROM	dbo.BIENES_REALIZABLES_OPERACIONES
	WHERE	ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_Operaciones_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_Operaciones_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla BIENES_REALIZABLES_OPERACIONES.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_Operaciones_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.BIENES_REALIZABLES_OPERACIONES BR0
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_Operaciones_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_Operaciones_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla BIENES_REALIZABLES_OPERACIONES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_Operaciones_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM	dbo.BIENES_REALIZABLES_OPERACIONES
		WHERE	ID_ROW = @piID_ROW 

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Bienes_Realizables_Operaciones_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Bienes_Realizables_Operaciones_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla BIENES_REALIZABLES_OPERACIONES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Bienes_Realizables_Operaciones_Inserta]	
	@piEMPRESA					INT = NULL, 
	@psID_BIEN_REALIZABLE		VARCHAR(25)= NULL,
	@piCOD_TIPO_PERSONA_DEUDOR	INT= NULL,
	@psID_DEUDOR				VARCHAR(30)= NULL,
	@psID_OPERACION				VARCHAR(25)= NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.BIENES_REALIZABLES_OPERACIONES (
					EMPRESA,
					ID_BIEN_REALIZABLE,
					COD_TIPO_PERSONA_DEUDOR,
					ID_DEUDOR,
					ID_OPERACION)
		SELECT 		@piEMPRESA,
					@psID_BIEN_REALIZABLE,
					@piCOD_TIPO_PERSONA_DEUDOR,
					@psID_DEUDOR,
					@psID_OPERACION

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Cuentas_Cobrar_No_Asociadas_Operaciones_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Cuentas_Cobrar_No_Asociadas_Operaciones_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Cuentas_Cobrar_No_Asociadas_Operaciones_Actualiza]
	@piID_ROW									INT = NULL,
	@psID_OPERACION								VARCHAR(25) = NULL,
	@piCOD_TIPO_PERSONA							INT = NULL,
	@psID_PERSONA								VARCHAR(30) = NULL,
	@piCOD_TIPO_MONEDA_MONTO					INT = NULL,
	@pdMONTO_ORIGINAL							DECIMAL(25,2) = NULL,
	@piCOD_TIPO_CATALOGO_SUGEF					INT = NULL,
	@piCUENTA_CONTABLE_SALDO_PRINCIPAL			BIGINT = NULL,
	@pdSALDO_PRINCIPAL							DECIMAL(25,2) = NULL,
	@piCUENTA_CONTABLE_SALDO_PRODUCTOS_COBRAR	BIGINT = NULL,
	@pdSALDO_PRODUCTOS_COBRAR					DECIMAL(25,2) = NULL,
	@pdtFECHA_REGISTRO_CONTABLE					DATE = NULL,
	@pdtFECHA_EXIGIBILIDAD						DATE = NULL,
	@pdtFECHA_VENCIMIENTO						DATE = NULL,
	@pdESTIMACION_REGISTRADA					DECIMAL(25,2) = NULL,
	@piID_DEPENDENCIA							INT = NULL,
	@piDIAS_MORA								INT = NULL
AS 
 	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES
		   SET	ID_OPERACION							= @psID_OPERACION,
				COD_TIPO_PERSONA						= @piCOD_TIPO_PERSONA,
				ID_PERSONA								= @psID_PERSONA,
				COD_TIPO_MONEDA_MONTO					= @piCOD_TIPO_MONEDA_MONTO,
				MONTO_ORIGINAL							= @pdMONTO_ORIGINAL,
				COD_TIPO_CATALOGO_SUGEF					= @piCOD_TIPO_CATALOGO_SUGEF,
				CUENTA_CONTABLE_SALDO_PRINCIPAL			= @piCUENTA_CONTABLE_SALDO_PRINCIPAL,
				SALDO_PRINCIPAL							= @pdSALDO_PRINCIPAL,
				CUENTA_CONTABLE_SALDO_PRODUCTOS_COBRAR	= @piCUENTA_CONTABLE_SALDO_PRODUCTOS_COBRAR,
				SALDO_PRODUCTOS_COBRAR					= @pdSALDO_PRODUCTOS_COBRAR,
				FECHA_REGISTRO_CONTABLE					= @pdtFECHA_REGISTRO_CONTABLE,
				FECHA_EXIGIBILIDAD						= @pdtFECHA_EXIGIBILIDAD,
				FECHA_VENCIMIENTO						= @pdtFECHA_VENCIMIENTO,
				ESTIMACION_REGISTRADA					= @pdESTIMACION_REGISTRADA,
				ID_DEPENDENCIA							= @piID_DEPENDENCIA,
				DIAS_MORA								= @piDIAS_MORA
		 WHERE	ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Cuentas_Cobrar_No_Asociadas_Operaciones_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



/*
Cuentas_Cobrar_No_Asociadas_Operaciones_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Cuentas_Cobrar_No_Asociadas_Operaciones_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS

  DECLARE @TempItems TABLE
  (
    ID INT IDENTITY(0,1),
    ID_ROW INT
  )
       
DECLARE @maxRow INT
DECLARE @vsSQL NVARCHAR(MAX)

SET @vsSQL = N'SELECT ID_ROW
			FROM dbo.CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES
			WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ' 

 IF (@filterColumn = 'MONTO_ORIGINAL' OR @filterColumn = 'DIAS_MORA') AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))
	SET @vsSQL = @vsSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	--SET @vsSQL = @vsSQL + ' UPPER(' + @filterColumn + ') LIKE ''' + @filterValue + ''''
SET @vsSQL = @vsSQL +' UPPER(ISNULL('  + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_REGISTRO_CONTABLE' THEN 'CONVERT(VARCHAR,FECHA_REGISTRO_CONTABLE,103)'  
							--WHEN 'MONTO_ORIGINAL' THEN ' format('+@filterColumn+',''N'','''+(SICAD_CONFIGURACION.dbo.Valor_Parametro(1))+''')'
							ELSE +@filterColumn END )

SET @vsSQL = @vsSQL + ( + ','''')) LIKE ''' + @filterValue + '''')
END

SET @vsSQL = @vsSQL +  ' ORDER BY ' +  CASE WHEN @sortColumn = '' THEN ' ID_OPERACION ' ELSE @sortColumn END

--IF @filterColumn = 'MONTO_ORIGINAL'
--BEGIN
--SET @filterColumn = ' format('+@filterColumn+',''N'','''+(SICAD_CONFIGURACION.dbo.Valor_Parametro(1))+''')'
--END

  SET @maxRow = (@startRowIndex + @maximumRows)
  SET ROWCOUNT @maxRow

  INSERT INTO @TempItems (ID_ROW)
  EXECUTE (@vsSQL)
  --EXECUTE('SELECT ID_ROW
  --         FROM dbo.CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES
  --         WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(' + @filterColumn + ') LIKE ''' + @filterValue + '''
  --         ORDER BY ' + @sortColumn)

  SET ROWCOUNT @maximumRows

  SELECT CCNA.ID_ROW,
		 CCNA.EMPRESA,
         CCNA.N_REGISTRO,
         CCNA.ID_OPERACION,
         CCNA.COD_TIPO_PERSONA,
         CCNA.ID_PERSONA,
         CCNA.COD_TIPO_MONEDA_MONTO,		 
         CCNA.MONTO_ORIGINAL,
         CCNA.COD_TIPO_CATALOGO_SUGEF,
         CCNA.CUENTA_CONTABLE_SALDO_PRINCIPAL,
         CCNA.SALDO_PRINCIPAL,
         CCNA.CUENTA_CONTABLE_SALDO_PRODUCTOS_COBRAR,
         CCNA.SALDO_PRODUCTOS_COBRAR,
         CCNA.FECHA_REGISTRO_CONTABLE,
         CCNA.FECHA_EXIGIBILIDAD,
         CCNA.FECHA_VENCIMIENTO,
         CCNA.ESTIMACION_REGISTRADA,
         CCNA.ID_DEPENDENCIA,
         CCNA.DIAS_MORA,
		 TME.DES_TIPO_MONEDA_ENTIDAD

    FROM @TempItems TEMP
         INNER JOIN dbo.CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES CCNA
                 ON CCNA.ID_ROW = TEMP.ID_ROW
		 LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_MONEDA_ENTIDAD TME 
				ON CCNA.COD_TIPO_MONEDA_MONTO = TME.COD_TIPO_MONEDA_ENTIDAD

   WHERE ID >= @startRowIndex

  SET ROWCOUNT 0





GO
/****** Object:  StoredProcedure [dbo].[Cuentas_Cobrar_No_Asociadas_Operaciones_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Cuentas_Cobrar_No_Asociadas_Operaciones_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Cuentas_Cobrar_No_Asociadas_Operaciones_Consulta_Detalle]
   @piID_ROW INT

AS
   SELECT ID_ROW,
		  EMPRESA,
          N_REGISTRO,
          ID_OPERACION,
          COD_TIPO_PERSONA,
          ID_PERSONA,
          COD_TIPO_MONEDA_MONTO,
          MONTO_ORIGINAL,
          COD_TIPO_CATALOGO_SUGEF,
          CUENTA_CONTABLE_SALDO_PRINCIPAL,
          SALDO_PRINCIPAL,
          CUENTA_CONTABLE_SALDO_PRODUCTOS_COBRAR,
          SALDO_PRODUCTOS_COBRAR,
          FECHA_REGISTRO_CONTABLE,
          FECHA_EXIGIBILIDAD,
          FECHA_VENCIMIENTO,
          ESTIMACION_REGISTRADA,
          ID_DEPENDENCIA,
          DIAS_MORA
     FROM dbo.CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES
    WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Cuentas_Cobrar_No_Asociadas_Operaciones_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/*
Cuentas_Cobrar_No_Asociadas_Operaciones_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Cuentas_Cobrar_No_Asociadas_Operaciones_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
 
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND '


 IF (@filterColumn = 'MONTO_ORIGINAL' OR @filterColumn = 'DIAS_MORA') AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
--	SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))

	SET @StrSQL = @StrSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')

	SET @StrSQL = @StrSQL + ' UPPER(ISNULL(' + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_REGISTRO_CONTABLE' THEN 'CONVERT(VARCHAR,FECHA_REGISTRO_CONTABLE,103)'
							ELSE +@filterColumn END ) + + ','''')) LIKE ''' + @filterValue + ''''
END

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount




/************************************************************************************************/
/************************************************************************************************/
/************************************************************************************************/
/*****************************ESTE SP ES NUEVO, NECESITA GRANT**********************************/
/************************************************************************************************/
/************************************************************************************************/
/************************************************************************************************/
/************************************************************************************************/





GO
/****** Object:  StoredProcedure [dbo].[Cuentas_Cobrar_No_Asociadas_Operaciones_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Cuentas_Cobrar_No_Asociadas_Operaciones_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Cuentas_Cobrar_No_Asociadas_Operaciones_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE
		FROM	dbo.CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES
		WHERE	ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Cuentas_Cobrar_No_Asociadas_Operaciones_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Cuentas_Cobrar_No_Asociadas_Operaciones_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Cuentas_Cobrar_No_Asociadas_Operaciones_Inserta]	
      @piEMPRESA								INT = NULL,
      @psID_OPERACION							VARCHAR(25) = NULL,
      @piCOD_TIPO_PERSONA						INT = NULL,
      @psID_PERSONA								VARCHAR(30) = NULL,
      @piCOD_TIPO_MONEDA_MONTO					INT = NULL,
      @pdMONTO_ORIGINAL							DECIMAL(25,2) = NULL,
      @piCOD_TIPO_CATALOGO_SUGEF				INT = NULL,
      @piCUENTA_CONTABLE_SALDO_PRINCIPAL		BIGINT = NULL,
      @pdSALDO_PRINCIPAL						DECIMAL(25,2) = NULL,
      @piCUENTA_CONTABLE_SALDO_PRODUCTOS_COBRAR	BIGINT = NULL,
      @pdSALDO_PRODUCTOS_COBRAR					DECIMAL(25,2) = NULL,
      @pdtFECHA_REGISTRO_CONTABLE				DATE = NULL,
      @pdtFECHA_EXIGIBILIDAD					DATE = NULL,
      @pdtFECHA_VENCIMIENTO						DATE = NULL,
      @pdESTIMACION_REGISTRADA					DECIMAL(25,2) = NULL,
      @piID_DEPENDENCIA							INT = NULL,
      @piDIAS_MORA								INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.CUENTAS_COBRAR_NO_ASOCIADAS_OPERACIONES(
					EMPRESA,
					ID_OPERACION,
					COD_TIPO_PERSONA,
					ID_PERSONA,
					COD_TIPO_MONEDA_MONTO,
					MONTO_ORIGINAL,
					COD_TIPO_CATALOGO_SUGEF,
					CUENTA_CONTABLE_SALDO_PRINCIPAL,
					SALDO_PRINCIPAL,
					CUENTA_CONTABLE_SALDO_PRODUCTOS_COBRAR,
					SALDO_PRODUCTOS_COBRAR,
					FECHA_REGISTRO_CONTABLE,
					FECHA_EXIGIBILIDAD,
					FECHA_VENCIMIENTO,
					ESTIMACION_REGISTRADA,
					ID_DEPENDENCIA,
					DIAS_MORA)
		SELECT		@piEMPRESA,
					@psID_OPERACION,
					@piCOD_TIPO_PERSONA,
					@psID_PERSONA,
				    @piCOD_TIPO_MONEDA_MONTO,
				    @pdMONTO_ORIGINAL,
				    @piCOD_TIPO_CATALOGO_SUGEF,
				    @piCUENTA_CONTABLE_SALDO_PRINCIPAL,
				    @pdSALDO_PRINCIPAL,
				    @piCUENTA_CONTABLE_SALDO_PRODUCTOS_COBRAR,
				    @pdSALDO_PRODUCTOS_COBRAR,
				    @pdtFECHA_REGISTRO_CONTABLE,
				    @pdtFECHA_EXIGIBILIDAD,
				    @pdtFECHA_VENCIMIENTO,
				    @pdESTIMACION_REGISTRADA,
				    @piID_DEPENDENCIA,
				    @piDIAS_MORA

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Cuotas_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Cuotas_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla CUOTAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Cuotas_Actualiza]
	@piID_ROW				INT = NULL,	
	@piCOD_TIPO_PERSONA		INT = NULL,
	@psID_DEUDOR			VARCHAR(30) = NULL,
	@psID_OPERACION			VARCHAR(25) = NULL,
	@piCOD_TIPO_CUOTA		INT = NULL,
	@piNUM_CUOTA_ATRASADA	INT = NULL,
	@piDIAS_ATRASO			INT = NULL,
	@pdMONTO_CUOTA_ATRASADA DECIMAL(25,2) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE dbo.CUOTAS
		SET	   COD_TIPO_PERSONA		= @piCOD_TIPO_PERSONA,
			   ID_DEUDOR			= @psID_DEUDOR,
			   ID_OPERACION			= @psID_OPERACION,
			   COD_TIPO_CUOTA		= @piCOD_TIPO_CUOTA,
			   NUM_CUOTA_ATRASADA	= @piNUM_CUOTA_ATRASADA,
			   DIAS_ATRASO			= @piDIAS_ATRASO,
			   MONTO_CUOTA_ATRASADA = @pdMONTO_CUOTA_ATRASADA
		WHERE  ID_ROW = @piID_ROW 

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Cuotas_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



/*
Cuotas_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla CUOTAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Cuotas_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   ID INT IDENTITY(0,1),
	ID_ROW INT)
 
DECLARE @maxRow INT
DECLARE @vsSQL VARCHAR(4000)

SET @vsSQL = ('SELECT 
					ID_ROW 
				FROM dbo.CUOTAS
				WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ')

 IF @filterColumn = 'DIAS_ATRASO' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))
	SET @vsSQL = @vsSQL + ' FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	SET @vsSQL = @vsSQL + ' UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''
END

SET @vsSQL = @vsSQL + ' ORDER BY '
SET @vsSQL = @vsSQL +  CASE WHEN @sortColumn = '' THEN 'NUM_CUOTA_ATRASADA' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow

INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL)


SET ROWCOUNT @maximumRows
	SELECT 
		C.ID_ROW, 
		C.N_REGISTRO,
		C.EMPRESA,
		C.COD_TIPO_PERSONA,
		C.ID_DEUDOR,
		C.ID_OPERACION,
		C.COD_TIPO_CUOTA,
		C.NUM_CUOTA_ATRASADA,
		C.DIAS_ATRASO,
		C.MONTO_CUOTA_ATRASADA,
		TC.DES_TIPO_CUOTA
	FROM @TempItems T 
		INNER JOIN dbo.CUOTAS C 
			ON C.ID_ROW = T.ID_ROW 
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_CUOTA TC
			ON C.COD_TIPO_CUOTA = TC.COD_TIPO_CUOTA
	WHERE ID >= @startRowIndex		

SET ROWCOUNT 0




GO
/****** Object:  StoredProcedure [dbo].[Cuotas_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Cuotas_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla CUOTAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Cuotas_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT ID_ROW
		  ,N_REGISTRO
		  ,EMPRESA
		  ,COD_TIPO_PERSONA
		  ,ID_DEUDOR
		  ,ID_OPERACION
		  ,COD_TIPO_CUOTA
		  ,NUM_CUOTA_ATRASADA
		  ,DIAS_ATRASO
		  ,MONTO_CUOTA_ATRASADA
	FROM  dbo.CUOTAS
	WHERE ID_ROW = @piID_ROW
	





GO
/****** Object:  StoredProcedure [dbo].[Cuotas_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/*
Cuotas_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla CUOTAS.
Sistema(s): SICAD
Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Cuotas_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.CUOTAS
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND '

 IF @filterColumn = 'DIAS_ATRASO' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))

	SET @StrSQL = @StrSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')

	SET @StrSQL = @StrSQL + ' UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''
END

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount







GO
/****** Object:  StoredProcedure [dbo].[Cuotas_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Cuotas_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla CUOTAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Cuotas_Elimina]
	@piID_ROW INT

AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM dbo.CUOTAS
		WHERE ID_ROW = @piID_ROW 
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Cuotas_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Cuotas_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla CUOTAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Cuotas_Inserta]	
	@piEMPRESA INT = NULL,	
	@piCOD_TIPO_PERSONA INT = NULL,
	@psID_DEUDOR VARCHAR(30) = NULL,
	@psID_OPERACION VARCHAR(25) = NULL,
	@piCOD_TIPO_CUOTA INT = NULL,
	@piNUM_CUOTA_ATRASADA INT = NULL,
	@piDIAS_ATRASO INT = NULL,
	@pdMONTO_CUOTA_ATRASADA DECIMAL(25,2) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.CUOTAS (
			EMPRESA,
			COD_TIPO_PERSONA,
			ID_DEUDOR,
			ID_OPERACION,
			COD_TIPO_CUOTA,
			NUM_CUOTA_ATRASADA,
			DIAS_ATRASO,
			MONTO_CUOTA_ATRASADA)
		SELECT 
			@piEMPRESA,
			@piCOD_TIPO_PERSONA,
			@psID_DEUDOR,
			@psID_OPERACION,
			@piCOD_TIPO_CUOTA,
			@piNUM_CUOTA_ATRASADA,
			@piDIAS_ATRASO,
			@pdMONTO_CUOTA_ATRASADA
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Deudores_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Deudores_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro en la tabla DEUDORES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Deudores_Actualiza]
        @piID_ROW								INT = NULL,
        @piCOD_SECTOR_ECONOMICO					INT = NULL,
        @psCOD_GRUPO_CLASIFICACION				VARCHAR(4) = NULL,
        @psCOD_CATEGORIA_RIESGO					VARCHAR(4) = NULL,
        @piCOD_CAPACIDAD_PAGO					INT = NULL,
        @piCOD_CONDICIONES_ESPECIALES_DEUDOR	INT = NULL,
        @pdtFECHA_CALIFICACION_RIESGO			DATE = NULL,
        @psCOD_CATEGORIA_ANTERIOR				VARCHAR(4) = NULL,
        @psIND_GENERADOR_DIVISAS				VARCHAR(1) = NULL,
        @piCOD_TIPO_ASIGNACION_CALIFICACION		INT = NULL,
        @piCOD_CATEGORIA_CALIFICACION			INT = NULL,
        @psCOD_CALIFICACION_RIESGO				VARCHAR(30) = NULL,
        @piCOD_EMPRESA_CALIFICADORA				INT = NULL,
        @psIND_VINCULADO_ENTIDAD				VARCHAR(1) = NULL,
        @psIND_VINCULADO_GRUPO_FINANCIERO		VARCHAR(1) = NULL,
        @piID_GRUPO								INT = NULL,
        @piCOD_TIPO_COMPORTAMIENTO_PAGO			INT = NULL,
        @psCOD_TIPO_ACTIVIDAD_ECONOMICA_DEUDOR	VARCHAR(14) = NULL,
        @psAUTORIZACION							VARCHAR(1) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
        UPDATE	dbo.DEUDORES
           SET	COD_SECTOR_ECONOMICO				= @piCOD_SECTOR_ECONOMICO,
				COD_GRUPO_CLASIFICACION				= @psCOD_GRUPO_CLASIFICACION,
				COD_CATEGORIA_RIESGO				= @psCOD_CATEGORIA_RIESGO,
				COD_CAPACIDAD_PAGO					= @piCOD_CAPACIDAD_PAGO,
				COD_CONDICIONES_ESPECIALES_DEUDOR	= @piCOD_CONDICIONES_ESPECIALES_DEUDOR,
				FECHA_CALIFICACION_RIESGO			= @pdtFECHA_CALIFICACION_RIESGO,
				COD_CATEGORIA_ANTERIOR				= @psCOD_CATEGORIA_ANTERIOR,
				IND_GENERADOR_DIVISAS				= @psIND_GENERADOR_DIVISAS,
				COD_TIPO_ASIGNACION_CALIFICACION	= @piCOD_TIPO_ASIGNACION_CALIFICACION,
				COD_CATEGORIA_CALIFICACION			= @piCOD_CATEGORIA_CALIFICACION,
				COD_CALIFICACION_RIESGO				= @psCOD_CALIFICACION_RIESGO,
				COD_EMPRESA_CALIFICADORA			= @piCOD_EMPRESA_CALIFICADORA,
				IND_VINCULADO_ENTIDAD				= @psIND_VINCULADO_ENTIDAD,
				IND_VINCULADO_GRUPO_FINANCIERO		= @psIND_VINCULADO_GRUPO_FINANCIERO,
				ID_GRUPO							= @piID_GRUPO,
				COD_TIPO_COMPORTAMIENTO_PAGO		= @piCOD_TIPO_COMPORTAMIENTO_PAGO,
				COD_TIPO_ACTIVIDAD_ECONOMICA_DEUDOR = @psCOD_TIPO_ACTIVIDAD_ECONOMICA_DEUDOR,
				AUTORIZACION						= @psAUTORIZACION
         WHERE ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Deudores_Consecutivo_Registro]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Deudores_Consecutivo_Registro
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Devuelve el consecutivo del siguiente registro para la tabla DEUDORES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Deudores_Consecutivo_Registro]	
AS     
	DECLARE @N_REGISTRO INT
	
	SELECT	@N_REGISTRO = COUNT(*) + 1
	FROM	dbo.DEUDORES

	SELECT @N_REGISTRO






GO
/****** Object:  StoredProcedure [dbo].[Deudores_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Deudores_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo de la tabla DEUDORES, 
			 tomando en cuenta el ordenamiento, paginacin y filtros.
Sistema(s): SICAD

Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Deudores_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @TempItems TABLE
(
  ID INT IDENTITY(0,1),
  ID_ROW INT
)

DECLARE @maxRow INT

SET @filterValue = '%' + @filterValue + '%'
SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'COD_TIPO_PERSONA, ID_DEUDOR' ELSE @sortColumn END
SET @maxRow = (@startRowIndex + @maximumRows) 

SET ROWCOUNT @maxRow

INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT ID_ROW 
           FROM dbo.DEUDORES
          WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
          ORDER BY ' + @sortColumn)
         
SET ROWCOUNT @maximumRows

SELECT DEU.ID_ROW,
	   DEU.N_REGISTRO,
	   DEU.EMPRESA,
       DEU.COD_TIPO_PERSONA,
       DEU.ID_DEUDOR,
       DEU.COD_SECTOR_ECONOMICO,
       DEU.COD_GRUPO_CLASIFICACION,
       DEU.COD_CATEGORIA_RIESGO,
       DEU.COD_CAPACIDAD_PAGO,
       DEU.COD_CONDICIONES_ESPECIALES_DEUDOR,
       DEU.FECHA_CALIFICACION_RIESGO,
       DEU.COD_CATEGORIA_ANTERIOR,
       DEU.IND_GENERADOR_DIVISAS,
       DEU.COD_TIPO_ASIGNACION_CALIFICACION,
       DEU.COD_CATEGORIA_CALIFICACION,
       DEU.COD_CALIFICACION_RIESGO,
       DEU.COD_EMPRESA_CALIFICADORA,
       DEU.IND_VINCULADO_ENTIDAD,
       DEU.IND_VINCULADO_GRUPO_FINANCIERO,
       DEU.ID_GRUPO,
       DEU.COD_TIPO_COMPORTAMIENTO_PAGO,
       DEU.COD_TIPO_ACTIVIDAD_ECONOMICA_DEUDOR,
       DEU.AUTORIZACION,
	   TP.DES_TIPO_PERSONA,
	   GRD.DES_GRUPO_RIESGO_DEUDOR,
	   CRD.DES_CATEGORIA_RIESGO_DEUDOR,
	   CP.DES_TIPO_CAPACIDAD_PAGO

  FROM @TempItems TEMP
		INNER JOIN dbo.DEUDORES DEU
				ON DEU.ID_ROW = TEMP.ID_ROW
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_PERSONA TP
				ON DEU.COD_TIPO_PERSONA = TP.COD_TIPO_PERSONA
		LEFT JOIN SICAD_CONFIGURACION.dbo.GRUPO_RIESGO_DEUDOR GRD
				ON GRD.COD_GRUPO_RIESGO_DEUDOR = DEU.COD_GRUPO_CLASIFICACION
		LEFT JOIN SICAD_CONFIGURACION.dbo.CATEGORIA_RIESGO_DEUDOR CRD
				ON CRD.COD_CATEGORIA_RIESGO_DEUDOR = DEU.COD_CATEGORIA_RIESGO
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_CAPACIDAD_PAGO CP
				ON CP.COD_TIPO_CAPACIDAD_PAGO = DEU.COD_TIPO_COMPORTAMIENTO_PAGO

WHERE ID >= @startRowIndex
	
SET ROWCOUNT 0



GO
/****** Object:  StoredProcedure [dbo].[Deudores_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Deudores_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla DEUDORES
Sistema(s): SICAD

Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Deudores_Consulta_Detalle]
	@piID_ROW INT

AS

SELECT ID_ROW,
	   N_REGISTRO,
	   EMPRESA,
       COD_TIPO_PERSONA,
       ID_DEUDOR,
       COD_SECTOR_ECONOMICO,
       COD_GRUPO_CLASIFICACION,
       COD_CATEGORIA_RIESGO,
       COD_CAPACIDAD_PAGO,
       COD_CONDICIONES_ESPECIALES_DEUDOR,
       FECHA_CALIFICACION_RIESGO,
       COD_CATEGORIA_ANTERIOR,
       IND_GENERADOR_DIVISAS,
       COD_TIPO_ASIGNACION_CALIFICACION,
       COD_CATEGORIA_CALIFICACION,
       COD_CALIFICACION_RIESGO,
       COD_EMPRESA_CALIFICADORA,
       IND_VINCULADO_ENTIDAD,
       IND_VINCULADO_GRUPO_FINANCIERO,
       ID_GRUPO,
       COD_TIPO_COMPORTAMIENTO_PAGO,
       COD_TIPO_ACTIVIDAD_ECONOMICA_DEUDOR,
       AUTORIZACION
  FROM dbo.DEUDORES
 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Deudores_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Deudores_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla DEUDORES.
Sistema(s): SICAD

Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Deudores_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1) FROM 
              (SELECT DEU.ID_ROW,DEU.N_REGISTRO, DEU.EMPRESA, DEU.COD_TIPO_PERSONA,
                      DEU.ID_DEUDOR, DEU.COD_SECTOR_ECONOMICO, DEU.COD_GRUPO_CLASIFICACION,
                      DEU.COD_CATEGORIA_RIESGO, DEU.COD_CAPACIDAD_PAGO, DEU.COD_CONDICIONES_ESPECIALES_DEUDOR,
                      DEU.FECHA_CALIFICACION_RIESGO, DEU.COD_CATEGORIA_ANTERIOR, DEU.IND_GENERADOR_DIVISAS,
                      DEU.COD_TIPO_ASIGNACION_CALIFICACION, DEU.COD_CATEGORIA_CALIFICACION, DEU.COD_CALIFICACION_RIESGO,
                      DEU.COD_EMPRESA_CALIFICADORA, DEU.IND_VINCULADO_ENTIDAD, DEU.IND_VINCULADO_GRUPO_FINANCIERO,
                      DEU.ID_GRUPO, DEU.COD_TIPO_COMPORTAMIENTO_PAGO, DEU.COD_TIPO_ACTIVIDAD_ECONOMICA_DEUDOR,
                      DEU.AUTORIZACION, DEU.COD_SISTEMA, TP.DES_TIPO_PERSONA DESCRIPCION_TIPO_PERSONA, 
                      GRD.DES_GRUPO_RIESGO_DEUDOR, CRD.DES_CATEGORIA_RIESGO_DEUDOR DESCRIPCION_CATEGORIA
                 FROM dbo.DEUDORES DEU 
                      LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_PERSONA TP 
                                ON DEU.COD_TIPO_PERSONA = TP.COD_TIPO_PERSONA
                      LEFT JOIN SICAD_CONFIGURACION.dbo.GRUPO_RIESGO_DEUDOR GRD 
                                ON DEU.COD_GRUPO_CLASIFICACION COLLATE Latin1_General_CS_AS = GRD.COD_GRUPO_RIESGO_DEUDOR COLLATE Latin1_General_CS_AS
                      LEFT JOIN SICAD_CONFIGURACION.dbo.CATEGORIA_RIESGO_DEUDOR CRD 
                                ON DEU.COD_CATEGORIA_RIESGO COLLATE Latin1_General_CS_AS = CRD.COD_CATEGORIA_RIESGO_DEUDOR COLLATE Latin1_General_CS_AS) TABLA
		WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Deudores_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Deudores_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Eliina un registro de la tabla DEUDORES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Deudores_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM dbo.DEUDORES
		WHERE ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Deudores_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Deudores_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla DEUDORES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Deudores_Inserta]
        @piEMPRESA								INT = NULL, 
        @piCOD_TIPO_PERSONA						INT= NULL,
        @psID_DEUDOR							VARCHAR(30)= NULL,	
        @piCOD_SECTOR_ECONOMICO					INT= NULL,
        @psCOD_GRUPO_CLASIFICACION				VARCHAR(4)= NULL,
        @psCOD_CATEGORIA_RIESGO					VARCHAR(4)= NULL,
        @piCOD_CAPACIDAD_PAGO					INT = NULL,
        @piCOD_CONDICIONES_ESPECIALES_DEUDOR	INT = NULL,
        @pdtFECHA_CALIFICACION_RIESGO			DATE= NULL,
        @psCOD_CATEGORIA_ANTERIOR				VARCHAR(4) = NULL,
        @psIND_GENERADOR_DIVISAS				VARCHAR(1)= NULL,
        @piCOD_TIPO_ASIGNACION_CALIFICACION		INT= NULL,
        @piCOD_CATEGORIA_CALIFICACION			INT = NULL,
        @psCOD_CALIFICACION_RIESGO				VARCHAR(30) = NULL,
        @piCOD_EMPRESA_CALIFICADORA				INT = NULL,
        @psIND_VINCULADO_ENTIDAD				VARCHAR(1)= NULL,
        @psIND_VINCULADO_GRUPO_FINANCIERO		VARCHAR(1)= NULL,
        @piID_GRUPO								INT = NULL,
        @piCOD_TIPO_COMPORTAMIENTO_PAGO			INT= NULL,
        @psCOD_TIPO_ACTIVIDAD_ECONOMICA_DEUDOR	VARCHAR(14)= NULL,
        @psAUTORIZACION							VARCHAR(1)= NULL,
		@piCOD_SISTEMA							INT= NULL
AS
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.DEUDORES (
                    EMPRESA,
                    COD_TIPO_PERSONA,
                    ID_DEUDOR,
                    COD_SECTOR_ECONOMICO,
                    COD_GRUPO_CLASIFICACION,
                    COD_CATEGORIA_RIESGO,
                    COD_CAPACIDAD_PAGO,
                    COD_CONDICIONES_ESPECIALES_DEUDOR,
                    FECHA_CALIFICACION_RIESGO,
                    COD_CATEGORIA_ANTERIOR,
                    IND_GENERADOR_DIVISAS,
                    COD_TIPO_ASIGNACION_CALIFICACION,
                    COD_CATEGORIA_CALIFICACION,
                    COD_CALIFICACION_RIESGO,
                    COD_EMPRESA_CALIFICADORA,
                    IND_VINCULADO_ENTIDAD,
                    IND_VINCULADO_GRUPO_FINANCIERO,
                    ID_GRUPO,
                    COD_TIPO_COMPORTAMIENTO_PAGO	,
                    COD_TIPO_ACTIVIDAD_ECONOMICA_DEUDOR,
                    AUTORIZACION,
					COD_SISTEMA)
		SELECT 		@piEMPRESA,
					@piCOD_TIPO_PERSONA,
					@psID_DEUDOR,
					@piCOD_SECTOR_ECONOMICO,
					@psCOD_GRUPO_CLASIFICACION,
					@psCOD_CATEGORIA_RIESGO,
					@piCOD_CAPACIDAD_PAGO,
					@piCOD_CONDICIONES_ESPECIALES_DEUDOR,
					@pdtFECHA_CALIFICACION_RIESGO,
					@psCOD_CATEGORIA_ANTERIOR,
					@psIND_GENERADOR_DIVISAS,
					@piCOD_TIPO_ASIGNACION_CALIFICACION,
					@piCOD_CATEGORIA_CALIFICACION,
					@psCOD_CALIFICACION_RIESGO,
					@piCOD_EMPRESA_CALIFICADORA,
					@psIND_VINCULADO_ENTIDAD,
					@psIND_VINCULADO_GRUPO_FINANCIERO,
					@piID_GRUPO,
					@piCOD_TIPO_COMPORTAMIENTO_PAGO,
					@psCOD_TIPO_ACTIVIDAD_ECONOMICA_DEUDOR,
					@psAUTORIZACION,
					@piCOD_SISTEMA
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Deudores_Recalificados_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Deudores_Recalificados_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro en la tabla DEUDORES_RECALIFICADOS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Deudores_Recalificados_Actualiza]
	@piID_ROW						INT = NULL,
	@psCOD_CATEGORIA_ASIGNADA		VARCHAR(4) = NULL,
	@psCOD_GRUPO_ASIGNADO			VARCHAR(4) = NULL,
	@pdtFECHA_RECALIFICACION		DATE = NULL,
	@pdtFECHA_RECALIFICACION_HASTA	DATE = NULL,	
	@psESTADO						VARCHAR(1) = NULL,
	@psCOD_CATEGORIA_REEMPLAZA		VARCHAR(4) = NULL,
	@psCOD_GRUPO_REEMPLAZA			VARCHAR(4) = NULL,
	@pdPERIODICIDAD					DECIMAL(8,2) = NULL,
	@psOBSERVACIONES				VARCHAR(255) = NULL

AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.DEUDORES_RECALIFICADOS  
		SET 	COD_CATEGORIA_ASIGNADA		= @psCOD_CATEGORIA_ASIGNADA,
				COD_GRUPO_ASIGNADO			= @psCOD_GRUPO_ASIGNADO,
				FECHA_RECALIFICACION		= @pdtFECHA_RECALIFICACION,
				FECHA_RECALIFICACION_HASTA	= @pdtFECHA_RECALIFICACION_HASTA,
				ESTADO						= @psESTADO,
				COD_CATEGORIA_REEMPLAZA		= @psCOD_CATEGORIA_REEMPLAZA,
				COD_GRUPO_REEMPLAZA			= @psCOD_GRUPO_REEMPLAZA,
				PERIODICIDAD				= @pdPERIODICIDAD,
				OBSERVACIONES				= @psOBSERVACIONES
		WHERE	ID_ROW = @piID_ROW 
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Deudores_Recalificados_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[Deudores_Recalificados_Consulta]
(@startRowIndex INT,
@maximumRows INT,
@filterValue VARCHAR(MAX),
@filterColumn VARCHAR(MAX),
@sortColumn VARCHAR(MAX),
@filtroEmpresa INT)
AS
DECLARE @TempItems TABLE 
(   ID INT IDENTITY(0,1),
       ID_ROW INT
)
DECLARE @maxRow INT
SET @filterValue = '%' + @filterValue + '%'

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_DEUDOR' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT     ID_ROW 
FROM dbo.DEUDORES_RECALIFICADOS
WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
ORDER BY ' + @sortColumn)
SET ROWCOUNT @maximumRows
       SELECT
             E.ID_ROW,
             E.N_REGISTRO, 
             E.EMPRESA,
             E.COD_TIPO_PERSONA,
             E.ID_DEUDOR,
             E.COD_CATEGORIA_ASIGNADA,
             E.COD_GRUPO_ASIGNADO,
             E.COD_ENTIDAD_RECALIFICA,
             E.FECHA_RECALIFICACION,
             E.FECHA_RECALIFICACION_HASTA,
             E.ESTADO,
             E.COD_CATEGORIA_REEMPLAZA,
             E.COD_GRUPO_REEMPLAZA,
             E.PERIODICIDAD,
             E.OBSERVACIONES,
             R.DES_ENTIDAD_RECALIFICADORA  
       FROM @TempItems T 
             INNER JOIN dbo.DEUDORES_RECALIFICADOS E ON 
                                  E.ID_ROW = T.ID_ROW 
             INNER JOIN SICAD_CONFIGURACION.dbo.ENTIDAD_RECALIFICADORA R
                    ON E.COD_ENTIDAD_RECALIFICA = R.COD_ENTIDAD_RECALIFICADORA  
       WHERE ID >= @startRowIndex        

SET ROWCOUNT 0

GO
/****** Object:  StoredProcedure [dbo].[Deudores_Recalificados_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Deudores_Recalificados_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla DEUDORES_RECALIFICADOS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Deudores_Recalificados_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT 	ID_ROW,
			N_REGISTRO,
			EMPRESA,
			COD_TIPO_PERSONA,
			ID_DEUDOR,
			COD_CATEGORIA_ASIGNADA,
			COD_GRUPO_ASIGNADO,
			COD_ENTIDAD_RECALIFICA,
			FECHA_RECALIFICACION,
			FECHA_RECALIFICACION_HASTA,
			ESTADO,
			COD_CATEGORIA_REEMPLAZA,
			COD_GRUPO_REEMPLAZA,
			PERIODICIDAD,
			OBSERVACIONES
	FROM dbo.DEUDORES_RECALIFICADOS
	WHERE ID_ROW = @piID_ROW
	





GO
/****** Object:  StoredProcedure [dbo].[Deudores_Recalificados_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Deudores_Recalificados_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla DEUDORES_RECALIFICADOS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Deudores_Recalificados_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.DEUDORES_RECALIFICADOS
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Deudores_Recalificados_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Deudores_Recalificados_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro en la tabla DEUDORES_RECALIFICADOS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Deudores_Recalificados_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM	dbo.DEUDORES_RECALIFICADOS
		WHERE	ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Deudores_Recalificados_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Deudores_Recalificados_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla DEUDORES_RECALIFICADOS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Deudores_Recalificados_Inserta]	
	@piEMPRESA						INT = NULL,
	@piCOD_TIPO_PERSONA				INT = NULL,
	@psID_DEUDOR					VARCHAR(30) = NULL,
	@psCOD_CATEGORIA_ASIGNADA		VARCHAR(4) = NULL,
	@psCOD_GRUPO_ASIGNADO			VARCHAR(4) = NULL,
	@piCOD_ENTIDAD_RECALIFICA		INT = NULL,
	@pdtFECHA_RECALIFICACION		DATE = NULL,
	@pdtFECHA_RECALIFICACION_HASTA	DATE = NULL,	
	@psESTADO						VARCHAR(1) = NULL,
    @psCOD_CATEGORIA_REEMPLAZA		VARCHAR(4) = NULL,
	@psCOD_GRUPO_REEMPLAZA			VARCHAR(4) = NULL,
	@pdPERIODICIDAD					DECIMAL(8,2) = NULL,		
	@psOBSERVACIONES				VARCHAR(255) = NULL	

AS     
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.DEUDORES_RECALIFICADOS (
					EMPRESA, 
					COD_TIPO_PERSONA, 
					ID_DEUDOR, 
					COD_CATEGORIA_ASIGNADA, 
					COD_GRUPO_ASIGNADO, 
					COD_ENTIDAD_RECALIFICA, 
					FECHA_RECALIFICACION, 
					FECHA_RECALIFICACION_HASTA, 
					ESTADO, 
					COD_CATEGORIA_REEMPLAZA, 
					COD_GRUPO_REEMPLAZA, 
					PERIODICIDAD, 
					OBSERVACIONES)
		SELECT 		@piEMPRESA,
					@piCOD_TIPO_PERSONA,
					@psID_DEUDOR,	
					@psCOD_CATEGORIA_ASIGNADA,
					@psCOD_GRUPO_ASIGNADO,
					@piCOD_ENTIDAD_RECALIFICA,
					@pdtFECHA_RECALIFICACION,
					@pdtFECHA_RECALIFICACION_HASTA,
					@psESTADO,
					@psCOD_CATEGORIA_REEMPLAZA,
					@psCOD_GRUPO_REEMPLAZA,
					@pdPERIODICIDAD,
					@psOBSERVACIONES		
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIA_OPERACION
Sistema(s):SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Actualiza]
        @piID_ROW						INT = NULL,
        @psID_OPERACION					VARCHAR(25) = NULL,
        @psID_DEUDOR					VARCHAR(30) = NULL,
        @piCOD_TIPO_PERSONA_DEUDOR		INT = NULL,
        @piGARANTIA_ANTERIOR_NO_APLICA	INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.GARANTIA_OPERACION
		SET		COD_TIPO_PERSONA_DEUDOR		= @piCOD_TIPO_PERSONA_DEUDOR,
				ID_DEUDOR					= @psID_DEUDOR,
				ID_OPERACION				= @psID_OPERACION,
				GARANTIA_ANTERIOR_NO_APLICA = @piGARANTIA_ANTERIOR_NO_APLICA
		WHERE	ID_ROW = @piID_ROW 
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIA_OPERACION
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
 )
 
AS

DECLARE @TempItems TABLE
(
        ID INT IDENTITY(0,1),
        ID_ROW INT
)

DECLARE @maxRow INT

SET @filterValue = '%' + @filterValue + '%'
SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION' ELSE @sortColumn END
SET @maxRow = (@startRowIndex + @maximumRows)
 
SET ROWCOUNT @maxRow

INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT ID_ROW
FROM dbo.GARANTIA_OPERACION
WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
ORDER BY ' + @sortColumn)

SET ROWCOUNT @maximumRows

SELECT GAR.ID_ROW,
	   GAR.EMPRESA,
       GAR.N_REGISTRO,
       GAR.ID_OPERACION,
       GAR.ID_DEUDOR,
       GAR.COD_TIPO_PERSONA_DEUDOR,
       GAR.GARANTIA_ANTERIOR_NO_APLICA,
	   TP.DES_TIPO_PERSONA
  FROM @TempItems TEMP
		INNER JOIN dbo.GARANTIA_OPERACION GAR
			ON GAR.ID_ROW = TEMP.ID_ROW 
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_PERSONA TP
			ON GAR.COD_TIPO_PERSONA_DEUDOR = TP.COD_TIPO_PERSONA
 WHERE ID >= @startRowIndex
 
SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIA_OPERACION
Sistema(s):SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Consulta_Detalle]
	@piID_ROW INT
AS

SELECT ID_ROW,
	   EMPRESA,
       N_REGISTRO,
       ID_OPERACION,
       ID_DEUDOR,
       COD_TIPO_PERSONA_DEUDOR,
       GARANTIA_ANTERIOR_NO_APLICA
  FROM dbo.GARANTIA_OPERACION
 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIA_OPERACION.
Sistema(s): SICAD
Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.GARANTIA_OPERACION
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIA_OPERACION
Sistema(s): SICAD
Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
        DELETE 	 	
        FROM	dbo.GARANTIA_OPERACION
        WHERE	ID_ROW = @piID_ROW 
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Garantia_Fideicometida_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Garantia_Fideicometida_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Garantia_Fideicometida_Actualiza]
	@piID_ROW										INT = NULL,
	@pdMONTO_MITIGADOR_FIDEICOMETIDO				DECIMAL(25,2) = NULL,
	@pdVALOR_NOMINAL_FIDEICOMETIDO					DECIMAL(22,0) = NULL,
	@piCOD_TIPO_MONEDA_VALOR_NOMINAL_FIDEICOMETIDO	INT = NULL,
	@pdPORC_RESPONSABILIDAD_FIDEICOMETIDO			DECIMAL(5,2) = NULL,
	@pdtFECHA_CONSTITUCION_GARANTIA_FIDEICOMETIDA	DATE = NULL,
	@pdtFECHA_VENCIMIENTO_GARANTIA_FIDEICOMETIDA	DATE = NULL

AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA
		SET 	MONTO_MITIGADOR_FIDEICOMETIDO				= @pdMONTO_MITIGADOR_FIDEICOMETIDO,
				VALOR_NOMINAL_FIDEICOMETIDO					= @pdVALOR_NOMINAL_FIDEICOMETIDO,
				COD_TIPO_MONEDA_VALOR_NOMINAL_FIDEICOMETIDO = @piCOD_TIPO_MONEDA_VALOR_NOMINAL_FIDEICOMETIDO,
				PORC_RESPONSABILIDAD_FIDEICOMETIDO			= @pdPORC_RESPONSABILIDAD_FIDEICOMETIDO,
				FECHA_CONSTITUCION_GARANTIA_FIDEICOMETIDA	= @pdtFECHA_CONSTITUCION_GARANTIA_FIDEICOMETIDA,
				FECHA_VENCIMIENTO_GARANTIA_FIDEICOMETIDA	= @pdtFECHA_VENCIMIENTO_GARANTIA_FIDEICOMETIDA	
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Garantia_Fideicometida_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Garantia_Fideicometida_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Garantia_Fideicometida_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   ID INT IDENTITY(0,1),
	ID_ROW INT
)
 DECLARE @maxRow INT
 SET @filterValue = '%' + @filterValue + '%'

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT 
			ID_ROW 
		 FROM dbo.GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA
WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
ORDER BY ' + @sortColumn)
SET ROWCOUNT @maximumRows
	SELECT 
		E.ID_ROW, 
		E.N_REGISTRO,
		E.EMPRESA,
		E.ID_OPERACION,
		E.ID_GARANTIA,
		E.COD_TIPO_MITIGADOR,
		E.COD_TIPO_DOCUMENTO_LEGAL,
		E.ID_GARANTIA_FIDEICOMETIDA,
		E.COD_TIPO_MITIGADOR_FIDEICOMETIDO,
		E.MONTO_MITIGADOR_FIDEICOMETIDO,
		E.VALOR_NOMINAL_FIDEICOMETIDO,
		E.COD_TIPO_MONEDA_VALOR_NOMINAL_FIDEICOMETIDO,
		E.COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO,
		E.PORC_RESPONSABILIDAD_FIDEICOMETIDO,
		E.FECHA_CONSTITUCION_GARANTIA_FIDEICOMETIDA,
		E.FECHA_VENCIMIENTO_GARANTIA_FIDEICOMETIDA,
		TM.DES_TIPO_MITIGADOR_RIESGO,
		TD.DES_TIPO_DOCUMENTO_LEGAL,
		TMF.DES_TIPO_MITIGADOR_RIESGO,
		TDF.DES_TIPO_DOCUMENTO_LEGAL
	FROM @TempItems T 
		INNER JOIN dbo.GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA E 
			ON E.ID_ROW = T.ID_ROW
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_MITIGADOR_RIESGO TM
			ON E.COD_TIPO_MITIGADOR = TM.COD_TIPO_MITIGADOR_RIESGO
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_DOCUMENTO_LEGAL TD
			ON E.COD_TIPO_DOCUMENTO_LEGAL = TD.COD_TIPO_DOCUMENTO_LEGAL
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_MITIGADOR_RIESGO TMF
			ON E.COD_TIPO_MITIGADOR_FIDEICOMETIDO = TMF.COD_TIPO_MITIGADOR_RIESGO
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_DOCUMENTO_LEGAL TDF
			ON E.COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO = TDF.COD_TIPO_DOCUMENTO_LEGAL
			
	WHERE ID >= @startRowIndex		

SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Garantia_Fideicometida_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Garantia_Fideicometida_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA
Sistema(s): SICAD
Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Garantia_Fideicometida_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT 	ID_ROW,
			N_REGISTRO,
			EMPRESA,
			ID_OPERACION,
			ID_GARANTIA,
			COD_TIPO_MITIGADOR,
			COD_TIPO_DOCUMENTO_LEGAL,
			ID_GARANTIA_FIDEICOMETIDA,
			COD_TIPO_MITIGADOR_FIDEICOMETIDO,
			MONTO_MITIGADOR_FIDEICOMETIDO,
			VALOR_NOMINAL_FIDEICOMETIDO,
			COD_TIPO_MONEDA_VALOR_NOMINAL_FIDEICOMETIDO,
			COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO,
			PORC_RESPONSABILIDAD_FIDEICOMETIDO,
			FECHA_CONSTITUCION_GARANTIA_FIDEICOMETIDA,
			FECHA_VENCIMIENTO_GARANTIA_FIDEICOMETIDA
	FROM	dbo.GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA
	WHERE	ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Garantia_Fideicometida_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Garantia_Fideicometida_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Garantia_Fideicometida_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Garantia_Fideicometida_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Garantia_Fideicometida_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Garantia_Fideicometida_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM	dbo.GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Garantia_Fideicometida_Gravamen_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Garantia_Fideicometida_Gravamen_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Garantia_Fideicometida_Gravamen_Actualiza]
	@piID_ROW INT = NULL,
	@pdMONTO_GRADO_GRAVAMENES_FIDEICOMETIDA			DECIMAL(25,2) = NULL,
	@piCOD_TIPO_MONEDA_GRADO_GRAVAMEN_FIDEICOMETIDA INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN
		SET		MONTO_GRADO_GRAVAMENES_FIDEICOMETIDA		 = @pdMONTO_GRADO_GRAVAMENES_FIDEICOMETIDA,
				COD_TIPO_MONEDA_GRADO_GRAVAMEN_FIDEICOMETIDA = @piCOD_TIPO_MONEDA_GRADO_GRAVAMEN_FIDEICOMETIDA
		WHERE	ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Garantia_Fideicometida_Gravamen_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Garantia_Fideicometida_Gravamen_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Garantia_Fideicometida_Gravamen_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   ID INT IDENTITY(0,1),
	ID_ROW INT
)
 DECLARE @maxRow INT
 SET @filterValue = '%' + @filterValue + '%'

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT 
			ID_ROW
		FROM dbo.GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN
		WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
		ORDER BY ' + @sortColumn)
SET ROWCOUNT @maximumRows
	SELECT
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA,
		E.ID_OPERACION,
		E.ID_GARANTIA,
		E.COD_TIPO_MITIGADOR,
		E.COD_TIPO_DOCUMENTO_LEGAL,
		E.ID_GARANTIA_FIDEICOMETIDA,
		E.COD_TIPO_MITIGADOR_FIDEICOMETIDA,
		E.COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDA,
		E.COD_GRADO_GRAVAMENES_FIDEICOMETIDA,
		E.COD_TIPO_PERSONA_ACREEDOR_FIDEICOMETIDA,
		E.ID_ACREEDOR_FIDEICOMETIDA,
		E.MONTO_GRADO_GRAVAMENES_FIDEICOMETIDA,
		E.COD_TIPO_MONEDA_GRADO_GRAVAMEN_FIDEICOMETIDA,
		TM.DES_TIPO_MITIGADOR_RIESGO,
		TD.DES_TIPO_DOCUMENTO_LEGAL,
		TMF.DES_TIPO_MITIGADOR_RIESGO,
		TDF.DES_TIPO_DOCUMENTO_LEGAL,
		TG.DES_TIPO_GRADO
	FROM @TempItems T 
		INNER JOIN dbo.GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN E 
			ON E.ID_ROW = T.ID_ROW
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_MITIGADOR_RIESGO TM
			ON E.COD_TIPO_MITIGADOR = TM.COD_TIPO_MITIGADOR_RIESGO
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_DOCUMENTO_LEGAL TD
			ON E.COD_TIPO_DOCUMENTO_LEGAL = TD.COD_TIPO_DOCUMENTO_LEGAL
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_MITIGADOR_RIESGO TMF
			ON E.COD_TIPO_MITIGADOR_FIDEICOMETIDA = TMF.COD_TIPO_MITIGADOR_RIESGO
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_DOCUMENTO_LEGAL TDF
			ON E.COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDA = TDF.COD_TIPO_DOCUMENTO_LEGAL
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_GRADO TG
			ON E.COD_GRADO_GRAVAMENES_FIDEICOMETIDA = TG.COD_TIPO_GRADO

		WHERE ID >= @startRowIndex	
		 	

SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Garantia_Fideicometida_Gravamen_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Garantia_Fideicometida_Gravamen_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Garantia_Fideicometida_Gravamen_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT	ID_ROW,
			N_REGISTRO,
			EMPRESA,
			ID_OPERACION,
			ID_GARANTIA,
			COD_TIPO_MITIGADOR,
			COD_TIPO_DOCUMENTO_LEGAL,
			ID_GARANTIA_FIDEICOMETIDA,
			COD_TIPO_MITIGADOR_FIDEICOMETIDA,
			COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDA,
			COD_GRADO_GRAVAMENES_FIDEICOMETIDA,
			COD_TIPO_PERSONA_ACREEDOR_FIDEICOMETIDA,
			ID_ACREEDOR_FIDEICOMETIDA,
			MONTO_GRADO_GRAVAMENES_FIDEICOMETIDA,
			COD_TIPO_MONEDA_GRADO_GRAVAMEN_FIDEICOMETIDA
	FROM	dbo.GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN
	WHERE	ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Garantia_Fideicometida_Gravamen_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Garantia_Fideicometida_Gravamen_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Garantia_Fideicometida_Gravamen_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Garantia_Fideicometida_Gravamen_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Garantia_Fideicometida_Gravamen_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Garantia_Fideicometida_Gravamen_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM dbo.GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN
		WHERE ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Garantia_Fideicometida_Gravamen_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Garantia_Fideicometida_Gravamen_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Garantia_Fideicometida_Gravamen_Inserta]	
	@piEMPRESA										INT = NULL,
	@psID_OPERACION									VARCHAR(25) = NULL,
	@psID_GARANTIA									VARCHAR(25) = NULL,
	@piCOD_TIPO_MITIGADOR							INT = NULL,
	@piCOD_TIPO_DOCUMENTO_LEGAL						INT = NULL,
	@psID_GARANTIA_FIDEICOMETIDA					VARCHAR(25) = NULL,
	@piCOD_TIPO_MITIGADOR_FIDEICOMETIDA				INT = NULL,
	@piCOD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDA		INT = NULL,
	@piCOD_GRADO_GRAVAMENES_FIDEICOMETIDA			INT = NULL,
	@piCOD_TIPO_PERSONA_ACREEDOR_FIDEICOMETIDA		INT = NULL,
	@psID_ACREEDOR_FIDEICOMETIDA					VARCHAR(30) = NULL,
	@pdMONTO_GRADO_GRAVAMENES_FIDEICOMETIDA			DECIMAL(25,2) = NULL,
	@piCOD_TIPO_MONEDA_GRADO_GRAVAMEN_FIDEICOMETIDA INT = NULL

AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA_GRAVAMEN (
			EMPRESA,
			ID_OPERACION,
			ID_GARANTIA,
			COD_TIPO_MITIGADOR,
			COD_TIPO_DOCUMENTO_LEGAL,
			ID_GARANTIA_FIDEICOMETIDA,
			COD_TIPO_MITIGADOR_FIDEICOMETIDA,
			COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDA,
			COD_GRADO_GRAVAMENES_FIDEICOMETIDA,
			COD_TIPO_PERSONA_ACREEDOR_FIDEICOMETIDA,
			ID_ACREEDOR_FIDEICOMETIDA,
			MONTO_GRADO_GRAVAMENES_FIDEICOMETIDA,
			COD_TIPO_MONEDA_GRADO_GRAVAMEN_FIDEICOMETIDA)

		SELECT 
			@piEMPRESA,
			@psID_OPERACION,
			@psID_GARANTIA,
			@piCOD_TIPO_MITIGADOR,
			@piCOD_TIPO_DOCUMENTO_LEGAL,
			@psID_GARANTIA_FIDEICOMETIDA,
			@piCOD_TIPO_MITIGADOR_FIDEICOMETIDA,
			@piCOD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDA,
			@piCOD_GRADO_GRAVAMENES_FIDEICOMETIDA,
			@piCOD_TIPO_PERSONA_ACREEDOR_FIDEICOMETIDA,
			@psID_ACREEDOR_FIDEICOMETIDA,
			@pdMONTO_GRADO_GRAVAMENES_FIDEICOMETIDA,
			@piCOD_TIPO_MONEDA_GRADO_GRAVAMEN_FIDEICOMETIDA 
		
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH
		





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Garantia_Fideicometida_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Garantia_Fideicometida_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA
Sistema(s): SICAD
Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Garantia_Fideicometida_Inserta]	
	@piEMPRESA										INT = NULL,
	@psID_OPERACION									VARCHAR(25) = NULL,
	@psID_GARANTIA									VARCHAR(25) = NULL,
	@piCOD_TIPO_MITIGADOR							INT = NULL,
	@piCOD_TIPO_DOCUMENTO_LEGAL						INT = NULL,
	@psID_GARANTIA_FIDEICOMETIDA					VARCHAR(25) = NULL,
	@piCOD_TIPO_MITIGADOR_FIDEICOMETIDO				INT = NULL,
	@pdMONTO_MITIGADOR_FIDEICOMETIDO				DECIMAL(25,2) = NULL,
	@pdVALOR_NOMINAL_FIDEICOMETIDO					DECIMAL(22,0) = NULL,
	@piCOD_TIPO_MONEDA_VALOR_NOMINAL_FIDEICOMETIDO	INT = NULL ,
	@piCOD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO		INT = NULL,
	@pdPORC_RESPONSABILIDAD_FIDEICOMETIDO			DECIMAL(5,2) = NULL,
	@pdtFECHA_CONSTITUCION_GARANTIA_FIDEICOMETIDA	DATE = NULL,
	@pdtFECHA_VENCIMIENTO_GARANTIA_FIDEICOMETIDA	DATE = NULL

AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO GARANTIA_OPERACION_GARANTIA_FIDEICOMETIDA (
			EMPRESA,
			ID_OPERACION,
			ID_GARANTIA,
			COD_TIPO_MITIGADOR,
			COD_TIPO_DOCUMENTO_LEGAL,
			ID_GARANTIA_FIDEICOMETIDA,
			COD_TIPO_MITIGADOR_FIDEICOMETIDO,
			MONTO_MITIGADOR_FIDEICOMETIDO,
			VALOR_NOMINAL_FIDEICOMETIDO,
			COD_TIPO_MONEDA_VALOR_NOMINAL_FIDEICOMETIDO,
			COD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO,
			PORC_RESPONSABILIDAD_FIDEICOMETIDO,
			FECHA_CONSTITUCION_GARANTIA_FIDEICOMETIDA,
			FECHA_VENCIMIENTO_GARANTIA_FIDEICOMETIDA)
	
		SELECT 
			@piEMPRESA,
			@psID_OPERACION,
			@psID_GARANTIA,
			@piCOD_TIPO_MITIGADOR,
			@piCOD_TIPO_DOCUMENTO_LEGAL,
			@psID_GARANTIA_FIDEICOMETIDA,
			@piCOD_TIPO_MITIGADOR_FIDEICOMETIDO,
			@pdMONTO_MITIGADOR_FIDEICOMETIDO,
			@pdVALOR_NOMINAL_FIDEICOMETIDO,
			@piCOD_TIPO_MONEDA_VALOR_NOMINAL_FIDEICOMETIDO,
			@piCOD_TIPO_DOCUMENTO_LEGAL_FIDEICOMETIDO,
			@pdPORC_RESPONSABILIDAD_FIDEICOMETIDO,
			@pdtFECHA_CONSTITUCION_GARANTIA_FIDEICOMETIDA,
			@pdtFECHA_VENCIMIENTO_GARANTIA_FIDEICOMETIDA

    	COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Gravamen_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Gravamen_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIA_OPERACION_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Gravamen_Actualiza]
	@piID_ROW								INT = NULL,
	@pdMONTO_GRADO_GRAVAMEN					DECIMAL(25,2) = NULL,
	@piCOD_TIPO_MONEDA_MONTO_GRADO_GRAVAMEN INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE  dbo.GARANTIA_OPERACION_GRAVAMEN
		SET		MONTO_GRADO_GRAVAMEN				 = @pdMONTO_GRADO_GRAVAMEN,
				COD_TIPO_MONEDA_MONTO_GRADO_GRAVAMEN = @piCOD_TIPO_MONEDA_MONTO_GRADO_GRAVAMEN
		WHERE	ID_ROW = @piID_ROW 
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Gravamen_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Gravamen_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIA_OPERACION_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Gravamen_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   ID INT IDENTITY(0,1),
	ID_ROW INT    )
 DECLARE @maxRow INT
 SET @filterValue = '%' + @filterValue + '%'

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT 
			ID_ROW
		FROM dbo.GARANTIA_OPERACION_GRAVAMEN
		WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
		ORDER BY ' + @sortColumn)
SET ROWCOUNT @maximumRows
	SELECT 
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA,
		E.ID_OPERACION,
		E.ID_GARANTIA,
		E.COD_TIPO_MITIGADOR,
		E.COD_TIPO_DOCUMENTO_LEGAL,
		E.COD_GRADO_GRAVAMENES,
		E.COD_TIPO_PERSONA_ACREEDOR,
		E.ID_ACREEDOR,
		E.MONTO_GRADO_GRAVAMEN,
		E.COD_TIPO_MONEDA_MONTO_GRADO_GRAVAMEN,
		TM.DES_TIPO_MITIGADOR_RIESGO,
		TD.DES_TIPO_DOCUMENTO_LEGAL,
		TG.DES_TIPO_GRADO
	FROM @TempItems T 
		INNER JOIN dbo.GARANTIA_OPERACION_GRAVAMEN E 
			ON E.ID_ROW = T.ID_ROW
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_MITIGADOR_RIESGO TM
			ON E.COD_TIPO_MITIGADOR = TM.COD_TIPO_MITIGADOR_RIESGO
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_DOCUMENTO_LEGAL TD
			ON E.COD_TIPO_DOCUMENTO_LEGAL = TD.COD_TIPO_DOCUMENTO_LEGAL 
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_GRADO TG
			ON E.COD_GRADO_GRAVAMENES = TG.COD_TIPO_GRADO
 	WHERE ID >= @startRowIndex		
SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Gravamen_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Gravamen_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIA_OPERACION_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Gravamen_Consulta_Detalle]
	@piID_ROW INT
AS
   SELECT ID_ROW,
		  N_REGISTRO,
		  EMPRESA,
		  ID_OPERACION,
		  ID_GARANTIA,
		  COD_TIPO_MITIGADOR,
		  COD_TIPO_DOCUMENTO_LEGAL,
		  COD_GRADO_GRAVAMENES,
		  COD_TIPO_PERSONA_ACREEDOR,
		  ID_ACREEDOR,
		  MONTO_GRADO_GRAVAMEN,
		  COD_TIPO_MONEDA_MONTO_GRADO_GRAVAMEN
	FROM  dbo.GARANTIA_OPERACION_GRAVAMEN
	WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Gravamen_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Gravamen_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIA_OPERACION_GRAVAMEN.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Gravamen_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.GARANTIA_OPERACION_GRAVAMEN
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Gravamen_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Gravamen_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIA_OPERACION_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Gravamen_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM dbo.GARANTIA_OPERACION_GRAVAMEN
		WHERE ID_ROW = @piID_ROW 

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Gravamen_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Gravamen_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIA_OPERACION_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Gravamen_Inserta]	
	@piEMPRESA								INT = NULL,
	@psID_OPERACION							VARCHAR(25) = NULL,
	@psID_GARANTIA							VARCHAR(25) = NULL,
	@piCOD_TIPO_MITIGADOR					INT = NULL,
	@piCOD_TIPO_DOCUMENTO_LEGAL				INT = NULL,
	@piCOD_GRADO_GRAVAMENES					INT = NULL,
	@piCOD_TIPO_PERSONA_ACREEDOR			INT = NULL,
	@psID_ACREEDOR							VARCHAR(30) = NULL,
	@pdMONTO_GRADO_GRAVAMEN					DECIMAL(25,2) = NULL,
	@piCOD_TIPO_MONEDA_MONTO_GRADO_GRAVAMEN INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO GARANTIA_OPERACION_GRAVAMEN (
			EMPRESA,
			ID_OPERACION,
			ID_GARANTIA,
			COD_TIPO_MITIGADOR,
			COD_TIPO_DOCUMENTO_LEGAL,
			COD_GRADO_GRAVAMENES,
			COD_TIPO_PERSONA_ACREEDOR,
			ID_ACREEDOR,
			MONTO_GRADO_GRAVAMEN,
			COD_TIPO_MONEDA_MONTO_GRADO_GRAVAMEN)

		SELECT 
			@piEMPRESA,
			@psID_OPERACION,
			@psID_GARANTIA,
			@piCOD_TIPO_MITIGADOR,
			@piCOD_TIPO_DOCUMENTO_LEGAL,
			@piCOD_GRADO_GRAVAMENES,
			@piCOD_TIPO_PERSONA_ACREEDOR,
			@psID_ACREEDOR,
			@pdMONTO_GRADO_GRAVAMEN,
			@piCOD_TIPO_MONEDA_MONTO_GRADO_GRAVAMEN
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIA_OPERACION
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Inserta]
	@piEMPRESA						INT = NULL,
	@psID_OPERACION					VARCHAR(25) = NULL,
	@psID_DEUDOR					VARCHAR(30) = NULL,
	@piCOD_TIPO_PERSONA_DEUDOR		INT = NULL,
	@piGARANTIA_ANTERIOR_NO_APLICA	INT = NULL

AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO GARANTIA_OPERACION (
					EMPRESA,
					ID_OPERACION,
					ID_DEUDOR,
					COD_TIPO_PERSONA_DEUDOR,
					GARANTIA_ANTERIOR_NO_APLICA)
		SELECT		@piEMPRESA,
				    @psID_OPERACION,
				    @psID_DEUDOR,
				    @piCOD_TIPO_PERSONA_DEUDOR,
				    @piGARANTIA_ANTERIOR_NO_APLICA
       
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Lista_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Lista_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIA_OPERACION_LISTA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Lista_Actualiza]
        @piID_ROW									INT = NULL,
		@piCOD_TIPO_GARANTIA						INT = NULL,
	    @pdMONTO_MITIGADOR_FUENTE					DECIMAL(25,2) = NULL,
		@pdMONTO_MITIGADOR_CALCULADO				DECIMAL(25,2) = NULL,
        @piIND_INSCRIPCION_GARANTIA					INT = NULL,
        @pdtFECHA_PRESENTACION_REGISTRO_GARANTIA	DATE = NULL,
        @pdPORC_RESPONSABILIDAD_GARANTIA			DECIMAL(7,2) = NULL,
        @pdMONTO_VALOR_NOMINAL_GARANTIA				DECIMAL(22,0) = NULL,
        @piCOD_TIPO_MONEDA_VALOR_NOMINAL_GARANTIA	INT = NULL,
        @pdPORC_ACEPTACION_FUENTE					DECIMAL(7,2) = NULL,
		@pdPORC_ACEPTACION_CALCULADO				DECIMAL(7,2) = NULL,
        @pdtFECHA_CONSTITUCION_GARANTIA				DATE = NULL,
        @pdtFECHA_VENCIMIENTO_GARANTIA				DATE = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE dbo.GARANTIA_OPERACION_LISTA
		SET		COD_TIPO_GARANTIA						= @piCOD_TIPO_GARANTIA,
				MONTO_MITIGADOR_FUENTE					= @pdMONTO_MITIGADOR_FUENTE,
				MONTO_MITIGADOR_CALCULADO				= @pdMONTO_MITIGADOR_CALCULADO,
				IND_INSCRIPCION_GARANTIA				= @piIND_INSCRIPCION_GARANTIA,
				FECHA_PRESENTACION_REGISTRO_GARANTIA	= @pdtFECHA_PRESENTACION_REGISTRO_GARANTIA,
				PORC_RESPONSABILIDAD_GARANTIA			= @pdPORC_RESPONSABILIDAD_GARANTIA,
				MONTO_VALOR_NOMINAL_GARANTIA			= @pdMONTO_VALOR_NOMINAL_GARANTIA,
				COD_TIPO_MONEDA_VALOR_NOMINAL_GARANTIA	= @piCOD_TIPO_MONEDA_VALOR_NOMINAL_GARANTIA,
				PORC_ACEPTACION_FUENTE					= @pdPORC_ACEPTACION_FUENTE,
				PORC_ACEPTACION_CALCULADO				= @pdPORC_ACEPTACION_CALCULADO,
				FECHA_CONSTITUCION_GARANTIA				= @pdtFECHA_CONSTITUCION_GARANTIA,
				FECHA_VENCIMIENTO_GARANTIA				= @pdtFECHA_VENCIMIENTO_GARANTIA
		 WHERE	ID_ROW = @piID_ROW 
   
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Lista_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Lista_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIA_OPERACION_LISTA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Lista_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @TempItems TABLE 
(
        ID INT IDENTITY(0,1),
        ID_ROW INT
)

DECLARE @maxRow INT
SET @filterValue = '%' + @filterValue + '%'
SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION' ELSE @sortColumn END
SET @maxRow = (@startRowIndex + @maximumRows)

SET ROWCOUNT @maxRow

INSERT INTO @TempItems (
                        ID_ROW
                       )
                       
EXECUTE('SELECT ID_ROW 
           FROM dbo.GARANTIA_OPERACION_LISTA
          WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL('  + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
          ORDER BY ' + @sortColumn)
          
SET ROWCOUNT @maximumRows

SELECT GAR.ID_ROW,
	   GAR.EMPRESA,
       GAR.N_REGISTRO,
       GAR.ID_OPERACION,
       GAR.COD_TIPO_GARANTIA,
       GAR.ID_GARANTIA,
       GAR.COD_TIPO_MITIGADOR,
       GAR.COD_TIPO_DOCUMENTO_LEGAL,
       GAR.MONTO_MITIGADOR_FUENTE,
	   GAR.MONTO_MITIGADOR_CALCULADO,
       GAR.IND_INSCRIPCION_GARANTIA,
       GAR.FECHA_PRESENTACION_REGISTRO_GARANTIA,
       GAR.PORC_RESPONSABILIDAD_GARANTIA,
       GAR.MONTO_VALOR_NOMINAL_GARANTIA,
       GAR.COD_TIPO_MONEDA_VALOR_NOMINAL_GARANTIA,
       GAR.PORC_ACEPTACION_FUENTE,
	   GAR.PORC_ACEPTACION_CALCULADO,
       GAR.FECHA_CONSTITUCION_GARANTIA,
       GAR.FECHA_VENCIMIENTO_GARANTIA,
	   TG.DES_TIPO_GARANTIA,
	   TM.DES_TIPO_MITIGADOR_RIESGO,
	   TD.DES_TIPO_DOCUMENTO_LEGAL
  FROM @TempItems TEMP
		INNER JOIN dbo.GARANTIA_OPERACION_LISTA GAR
			ON GAR.ID_ROW = TEMP.ID_ROW
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_GARANTIA TG
			ON GAR.COD_TIPO_GARANTIA = TG.COD_TIPO_GARANTIA
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_MITIGADOR_RIESGO TM
			ON GAR.COD_TIPO_MITIGADOR = TM.COD_TIPO_MITIGADOR_RIESGO
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_DOCUMENTO_LEGAL TD
			ON GAR.COD_TIPO_DOCUMENTO_LEGAL = TD.COD_TIPO_DOCUMENTO_LEGAL
 WHERE TEMP.ID >= @startRowIndex
SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Lista_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Lista_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIAS_CAR_CRE_IMPORTACION
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Lista_Consulta_Detalle]
	@piID_ROW INT
AS

	SELECT ID_ROW,
		   N_REGISTRO,
		   EMPRESA,
		   ID_OPERACION,
		   COD_TIPO_GARANTIA,
		   ID_GARANTIA,
		   COD_TIPO_MITIGADOR,
		   COD_TIPO_DOCUMENTO_LEGAL,
		   MONTO_MITIGADOR_FUENTE,
		   MONTO_MITIGADOR_CALCULADO,
		   IND_INSCRIPCION_GARANTIA,
		   FECHA_PRESENTACION_REGISTRO_GARANTIA,
		   PORC_RESPONSABILIDAD_GARANTIA,
		   MONTO_VALOR_NOMINAL_GARANTIA,
		   COD_TIPO_MONEDA_VALOR_NOMINAL_GARANTIA,
		   PORC_ACEPTACION_FUENTE,
		   PORC_ACEPTACION_CALCULADO,
		   FECHA_CONSTITUCION_GARANTIA,
		   FECHA_VENCIMIENTO_GARANTIA
	  FROM dbo.GARANTIA_OPERACION_LISTA
	 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Lista_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Lista_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIA_OPERACION_LISTA.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Lista_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.GARANTIA_OPERACION_LISTA
                  WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Lista_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Lista_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIA_OPERACION_LISTA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Lista_Elimina]
	@piID_ROW INT
AS
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM	dbo.GARANTIA_OPERACION_LISTA
		WHERE	ID_ROW = @piID_ROW 
		
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Lista_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Lista_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIA_OPERACION_LISTA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Lista_Inserta]
        @piEMPRESA									INT = NULL,
        @psID_OPERACION								VARCHAR(25) = NULL,
        @piCOD_TIPO_GARANTIA						INT = NULL,
        @psID_GARANTIA								VARCHAR(25) = NULL,
        @piCOD_TIPO_MITIGADOR						INT = NULL,
        @piCOD_TIPO_DOCUMENTO_LEGAL					INT = NULL,
        @pdMONTO_MITIGADOR_FUENTE					DECIMAL(25,2) = NULL,
		@pdMONTO_MITIGADOR_CALCULADO				DECIMAL(25,2) = NULL,
        @piIND_INSCRIPCION_GARANTIA					INT = NULL,
        @pdtFECHA_PRESENTACION_REGISTRO_GARANTIA	DATE = NULL,
        @pdPORC_RESPONSABILIDAD_GARANTIA			DECIMAL(7,2) = NULL,
        @pdMONTO_VALOR_NOMINAL_GARANTIA				DECIMAL(22,0) = NULL,
        @piCOD_TIPO_MONEDA_VALOR_NOMINAL_GARANTIA	INT = NULL,
        @pdPORC_ACEPTACION_FUENTE					DECIMAL(7,2) = NULL,
		@pdPORC_ACEPTACION_CALCULADO				DECIMAL(7,2) = NULL,
        @pdtFECHA_CONSTITUCION_GARANTIA				DATE = NULL,
        @pdtFECHA_VENCIMIENTO_GARANTIA				DATE = NULL
AS 
		BEGIN TRANSACTION TRA_Control
		BEGIN TRY
			INSERT INTO GARANTIA_OPERACION_LISTA (
						EMPRESA,
						ID_OPERACION,
						COD_TIPO_GARANTIA,
						ID_GARANTIA,
						COD_TIPO_MITIGADOR,
						COD_TIPO_DOCUMENTO_LEGAL,
						MONTO_MITIGADOR_FUENTE,
						MONTO_MITIGADOR_CALCULADO,
						IND_INSCRIPCION_GARANTIA,
						FECHA_PRESENTACION_REGISTRO_GARANTIA,
						PORC_RESPONSABILIDAD_GARANTIA,
						MONTO_VALOR_NOMINAL_GARANTIA,
						COD_TIPO_MONEDA_VALOR_NOMINAL_GARANTIA,
						PORC_ACEPTACION_FUENTE,
						PORC_ACEPTACION_CALCULADO,
						FECHA_CONSTITUCION_GARANTIA,
						FECHA_VENCIMIENTO_GARANTIA)

			SELECT	   @piEMPRESA,
					   @psID_OPERACION,
					   @piCOD_TIPO_GARANTIA,
					   @psID_GARANTIA,
					   @piCOD_TIPO_MITIGADOR,
					   @piCOD_TIPO_DOCUMENTO_LEGAL,
					   @pdMONTO_MITIGADOR_FUENTE,
					   @pdMONTO_MITIGADOR_CALCULADO,
					   @piIND_INSCRIPCION_GARANTIA,
					   @pdtFECHA_PRESENTACION_REGISTRO_GARANTIA,
					   @pdPORC_RESPONSABILIDAD_GARANTIA,
					   @pdMONTO_VALOR_NOMINAL_GARANTIA,
					   @piCOD_TIPO_MONEDA_VALOR_NOMINAL_GARANTIA,
					   @pdPORC_ACEPTACION_FUENTE,
					   @pdPORC_ACEPTACION_CALCULADO,
					   @pdtFECHA_CONSTITUCION_GARANTIA,
					   @pdtFECHA_VENCIMIENTO_GARANTIA 	

			COMMIT TRANSACTION TRA_Control
			SELECT 0
		END TRY
		BEGIN CATCH
			SELECT ERROR_NUMBER()
			ROLLBACK TRANSACTION TRA_Control
		END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Prioridad_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Prioridad_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIA_OPERACION_PRIORIDAD
Sistema(s):SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Prioridad_Actualiza]
	@piID_ROW						 INT = NULL,
	@pdMONTO_PRIORIDADES			 DECIMAL(25,2) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.GARANTIA_OPERACION_PRIORIDAD
		SET		MONTO_PRIORIDADES				= @pdMONTO_PRIORIDADES
		WHERE	ID_ROW = @piID_ROW 
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Prioridad_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Prioridad_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIA_OPERACION_PRIORIDAD
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Prioridad_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   ID INT IDENTITY(0,1),
	ID_ROW INT  )
 DECLARE @maxRow INT
 SET @filterValue = '%' + @filterValue + '%'

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT 
			ID_ROW
		 FROM dbo.GARANTIA_OPERACION_PRIORIDAD
		WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ',''''))  LIKE ''' + @filterValue + '''
		ORDER BY ' + @sortColumn)
SET ROWCOUNT @maximumRows
	SELECT 
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA,
		E.ID_OPERACION,
		E.ID_GARANTIA,
		E.COD_TIPO_MITIGADOR,
		E.COD_TIPO_DOCUMENTO_LEGAL,
		E.COD_GRADO_PRIORIDADES,
		E.COD_TIPO_PERSONA_BENEFICIARIO,
		E.ID_BENEFICIARIO,
		E.MONTO_PRIORIDADES,
		TM.DES_TIPO_MITIGADOR_RIESGO,
		TD.DES_TIPO_DOCUMENTO_LEGAL,
		TG.DES_TIPO_GRADO
	FROM @TempItems T 
		INNER JOIN dbo.GARANTIA_OPERACION_PRIORIDAD E 
			ON E.ID_ROW = T.ID_ROW
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_MITIGADOR_RIESGO TM
			ON E.COD_TIPO_MITIGADOR = TM.COD_TIPO_MITIGADOR_RIESGO
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_DOCUMENTO_LEGAL TD
			ON E.COD_TIPO_DOCUMENTO_LEGAL = TD.COD_TIPO_DOCUMENTO_LEGAL
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_GRADO TG
			ON E.COD_GRADO_PRIORIDADES = TG.COD_TIPO_GRADO
	WHERE ID >= @startRowIndex		

SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Prioridad_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Prioridad_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIA_OPERACION_PRIORIDAD
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Prioridad_Consulta_Detalle]
		@piID_ROW INT
AS
	SELECT	ID_ROW,
			EMPRESA,
			N_REGISTRO,
			ID_OPERACION,
			ID_GARANTIA,
			COD_TIPO_MITIGADOR,
			COD_TIPO_DOCUMENTO_LEGAL,
			COD_GRADO_PRIORIDADES,
			COD_TIPO_PERSONA_BENEFICIARIO,
			ID_BENEFICIARIO,
			MONTO_PRIORIDADES
	FROM dbo.GARANTIA_OPERACION_PRIORIDAD
	WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Prioridad_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Prioridad_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIA_OPERACION_PRIORIDAD.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Prioridad_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.GARANTIA_OPERACION_PRIORIDAD
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ',''''))  LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Prioridad_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Prioridad_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIA_OPERACION_PRIORIDAD_IMPORTACION
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Prioridad_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM dbo.GARANTIA_OPERACION_PRIORIDAD
		WHERE ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantia_Operacion_Prioridad_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantia_Operacion_Prioridad_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIA_OPERACION_PRIORIDAD
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantia_Operacion_Prioridad_Inserta]	
	@piEMPRESA					 INT = NULL,
	@psID_OPERACION					 VARCHAR(25) = NULL,
	@psID_GARANTIA					 VARCHAR(25) = NULL,
	@piCOD_TIPO_MITIGADOR			 INT = NULL,
	@piCOD_TIPO_DOCUMENTO_LEGAL		 INT = NULL,
	@piCOD_GRADO_PRIORIDADES		 INT = NULL,
	@piCOD_TIPO_PERSONA_BENEFICIARIO INT = NULL,
	@psID_BENEFICIARIO				 VARCHAR(30) = NULL,
	@pdMONTO_PRIORIDADES			 DECIMAL(25,2) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO GARANTIA_OPERACION_PRIORIDAD (
					EMPRESA,
					ID_OPERACION,
					ID_GARANTIA,
					COD_TIPO_MITIGADOR,
					COD_TIPO_DOCUMENTO_LEGAL,
					COD_GRADO_PRIORIDADES,
					COD_TIPO_PERSONA_BENEFICIARIO,
					ID_BENEFICIARIO,
					MONTO_PRIORIDADES)
		SELECT 		@piEMPRESA,
					@psID_OPERACION,
					@psID_GARANTIA,
					@piCOD_TIPO_MITIGADOR,
					@piCOD_TIPO_DOCUMENTO_LEGAL,
					@piCOD_GRADO_PRIORIDADES,
					@piCOD_TIPO_PERSONA_BENEFICIARIO,
					@psID_BENEFICIARIO,
					@pdMONTO_PRIORIDADES
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Carta_Credito_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Garantias_Carta_Credito_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIAS_CARTA_CREDITO
Sistema(s): SICAD
Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Carta_Credito_Actualiza]
        @piID_ROW							INT = NULL,
        @pdtFECHA_CONSTITUCION				DATE = NULL,
        @pdtFECHA_VENCIMIENTO				DATE = NULL,
        @piCOD_TIPO_PERSONA					INT = NULL,
        @psID_ENTIDAD_CARTA_CREDITO			VARCHAR(30) = NULL,
        @pdVALOR_NOMINAL					DECIMAL(22,0) = NULL,
        @piCOD_TIPO_MONEDA_VALOR_NOMINAL	INT = NULL,
        @piCOD_TIPO_ASIGNACION_CALIFICACION INT = NULL,
        @piCOD_CATEGORIA_CALIFICACION		INT = NULL,
        @psCOD_CALIFICACION_RIESGO			VARCHAR(30) = NULL,
        @piCOD_EMPRESA_CALIFICADORA			INT = NULL      	
AS
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE dbo.GARANTIAS_CARTA_CREDITO
		SET 	FECHA_CONSTITUCION				 = @pdtFECHA_CONSTITUCION,
				FECHA_VENCIMIENTO				 = @pdtFECHA_VENCIMIENTO,
				COD_TIPO_PERSONA				 = @piCOD_TIPO_PERSONA,
				ID_ENTIDAD_CARTA_CREDITO		 = @psID_ENTIDAD_CARTA_CREDITO,
				VALOR_NOMINAL					 = @pdVALOR_NOMINAL,
				COD_TIPO_MONEDA_VALOR_NOMINAL	 = @piCOD_TIPO_MONEDA_VALOR_NOMINAL,
				COD_TIPO_ASIGNACION_CALIFICACION = @piCOD_TIPO_ASIGNACION_CALIFICACION,
				COD_CATEGORIA_CALIFICACION		 = @piCOD_CATEGORIA_CALIFICACION,
				COD_CALIFICACION_RIESGO			 = @psCOD_CALIFICACION_RIESGO,
				COD_EMPRESA_CALIFICADORA		 = @piCOD_EMPRESA_CALIFICADORA   
		 WHERE ID_ROW = @piID_ROW 

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH




GO
/****** Object:  StoredProcedure [dbo].[Garantias_Carta_Credito_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/*
Garantias_Carta_Credito_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIAS_CARTA_CREDITO
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Carta_Credito_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @TempItems TABLE
(
        ID INT IDENTITY(0,1),
        ID_ROW INT
)

SET LANGUAGE Spanish 

DECLARE @maxRow INT
DECLARE @vsSQL VARCHAR(4000)

SET @vsSQL = (SELECT 'SELECT ID_ROW FROM dbo.GARANTIAS_CARTA_CREDITO
				WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ')

 IF @filterColumn = 'VALOR_NOMINAL' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))
	SET @vsSQL = @vsSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	SET @vsSQL = @vsSQL + ' UPPER(ISNULL('  + 
								 (	SELECT	CASE @filterColumn 
									WHEN 'FECHA_CONSTITUCION' THEN 'CONVERT(VARCHAR,FECHA_CONSTITUCION,103)' 
									WHEN 'FECHA_VENCIMIENTO' THEN 'CONVERT(VARCHAR,FECHA_VENCIMIENTO,103)'  
									ELSE +@filterColumn END )
								 + ','''')) LIKE ''' + @filterValue + ''''
END
--SET @filterValue = UPPER('%' + @filterValue + '%')

SET @vsSQL = @vsSQL + ( ' ORDER BY ' + CASE WHEN @sortColumn = '' THEN 'ID_GARANTIA' ELSE @sortColumn END)

--IF @filterColumn = 'VALOR_NOMINAL'
--BEGIN
--	SET @filterColumn = ' format('+@filterColumn+',''N'','''+(SICAD_CONFIGURACION.dbo.Valor_Parametro(1))+''')'
--END

SET @maxRow = (@startRowIndex + @maximumRows)

SET ROWCOUNT @maxRow

INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL)      
--EXECUTE('SELECT ID_ROW FROM dbo.GARANTIAS_CARTA_CREDITO
--          WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(' + @filterColumn + ') LIKE ''' + @filterValue + '''
--          ORDER BY ' + @sortColumn)

SET ROWCOUNT @maximumRows

SELECT GAR.ID_ROW, 
	   GAR.N_REGISTRO,
       GAR.EMPRESA,
       GAR.ID_GARANTIA,
       GAR.FECHA_CONSTITUCION,
       GAR.FECHA_VENCIMIENTO,
       GAR.COD_TIPO_PERSONA,
       GAR.ID_ENTIDAD_CARTA_CREDITO,
       GAR.VALOR_NOMINAL,
       GAR.COD_TIPO_MONEDA_VALOR_NOMINAL,
       GAR.COD_TIPO_ASIGNACION_CALIFICACION,
       GAR.COD_CATEGORIA_CALIFICACION,
       GAR.COD_CALIFICACION_RIESGO,
	   GAR.COD_TIPO_ASIGNACION_CALIFICACION,
	   GAR.COD_CATEGORIA_CALIFICACION,
	   GAR.COD_CALIFICACION_RIESGO,
       GAR.COD_EMPRESA_CALIFICADORA
  FROM @TempItems TEMP
       INNER JOIN dbo.GARANTIAS_CARTA_CREDITO GAR
               ON GAR.ID_ROW = TEMP.ID_ROW
 WHERE TEMP.ID >= @startRowIndex
		
SET ROWCOUNT 0




GO
/****** Object:  StoredProcedure [dbo].[Garantias_Carta_Credito_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Carta_Credito_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIAS_CARTA_CREDITO
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Carta_Credito_Consulta_Detalle]
        @piID_ROW INT
AS

	SELECT ID_ROW, 
	   N_REGISTRO,
       EMPRESA,
       ID_GARANTIA,
       FECHA_CONSTITUCION,
       FECHA_VENCIMIENTO,
       COD_TIPO_PERSONA,
       ID_ENTIDAD_CARTA_CREDITO,
       VALOR_NOMINAL,
       COD_TIPO_MONEDA_VALOR_NOMINAL,
       COD_TIPO_ASIGNACION_CALIFICACION,
       COD_CATEGORIA_CALIFICACION,
       COD_CALIFICACION_RIESGO,
	   COD_TIPO_ASIGNACION_CALIFICACION,
	   COD_CATEGORIA_CALIFICACION,
	   COD_CALIFICACION_RIESGO,
       COD_EMPRESA_CALIFICADORA
	  FROM dbo.GARANTIAS_CARTA_CREDITO
	 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Carta_Credito_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Carta_Credito_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIAS_CARTA_CREDITO.
Sistema(s): SICAD
Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Carta_Credito_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.GARANTIAS_CARTA_CREDITO
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND '

 IF @filterColumn = 'VALOR_NOMINAL' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))

	SET @StrSQL = @StrSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')

	SET @StrSQL = @StrSQL + ' UPPER(ISNULL(' +(	SELECT	CASE @filterColumn 
							WHEN 'FECHA_CONSTITUCION' THEN 'CONVERT(VARCHAR,FECHA_CONSTITUCION,103)' 
							WHEN 'FECHA_VENCIMIENTO' THEN 'CONVERT(VARCHAR,FECHA_VENCIMIENTO,103)'  
							ELSE +@filterColumn END ) + ','''')) LIKE ''' + @filterValue + ''''
END

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Carta_Credito_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Carta_Credito_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIAS_CARTA_CREDITO
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Carta_Credito_Elimina]
        @piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
        DELETE 	 	
        FROM	dbo.GARANTIAS_CARTA_CREDITO
        WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Carta_Credito_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Garantias_Carta_Credito_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIAS_CARTA_CREDITO
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Carta_Credito_Inserta]
        @piEMPRESA							INT = NULL,
        @psID_GARANTIA						VARCHAR(25) = NULL,
        @pdtFECHA_CONSTITUCION				DATE = NULL,
        @pdtFECHA_VENCIMIENTO				DATE = NULL,
        @piCOD_TIPO_PERSONA					INT = NULL,
        @psID_ENTIDAD_CARTA_CREDITO			VARCHAR(30) = NULL,
        @pdVALOR_NOMINAL					DECIMAL(22,0) = NULL,
        @piCOD_TIPO_MONEDA_VALOR_NOMINAL	INT = NULL,
        @piCOD_TIPO_ASIGNACION_CALIFICACION INT = NULL,
        @piCOD_CATEGORIA_CALIFICACION		INT = NULL,
        @psCOD_CALIFICACION_RIESGO			VARCHAR(30) = NULL,
        @piCOD_EMPRESA_CALIFICADORA			INT = NULL
AS 
		BEGIN TRANSACTION TRA_Control
		BEGIN TRY
			INSERT INTO GARANTIAS_CARTA_CREDITO (
						EMPRESA,
						ID_GARANTIA,
						FECHA_CONSTITUCION,
						FECHA_VENCIMIENTO,
						COD_TIPO_PERSONA,
						ID_ENTIDAD_CARTA_CREDITO,
						VALOR_NOMINAL,
						COD_TIPO_MONEDA_VALOR_NOMINAL,
						COD_TIPO_ASIGNACION_CALIFICACION,
						COD_CATEGORIA_CALIFICACION,
						COD_CALIFICACION_RIESGO,
						COD_EMPRESA_CALIFICADORA)

			SELECT	   @piEMPRESA,
					   @psID_GARANTIA,
					   @pdtFECHA_CONSTITUCION,
					   @pdtFECHA_VENCIMIENTO,
					   @piCOD_TIPO_PERSONA,
					   @psID_ENTIDAD_CARTA_CREDITO,
					   @pdVALOR_NOMINAL,
					   @piCOD_TIPO_MONEDA_VALOR_NOMINAL,
					   @piCOD_TIPO_ASIGNACION_CALIFICACION,
					   @piCOD_CATEGORIA_CALIFICACION,
					   @psCOD_CALIFICACION_RIESGO,
					   @piCOD_EMPRESA_CALIFICADORA
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH



GO
/****** Object:  StoredProcedure [dbo].[Garantias_Cartas_Credito_Importacion_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Cartas_Credito_Importacion_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIAS_CARTAS_CREDITO_IMPORTACION
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Cartas_Credito_Importacion_Actualiza]
	@piID_ROW							INT = NULL,
	@piCOD_TIPO_BIEN					INT = NULL,
	@pdtFECHA_CONSTITUCION				DATE = NULL,
	@pdtFECHA_VENCIMIENTO				DATE = NULL,
	@pdVALOR_NOMINAL_GARANTIA			DECIMAL(22,0) = NULL,
	@piCOD_TIPO_MONEDA_VALOR_NOMINAL	INT = NULL,
	@psIND_POLIZA						VARCHAR(1)	 = NULL	
AS  
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.GARANTIAS_CARTAS_CREDITO_IMPORTACION
		SET		COD_TIPO_BIEN					= @piCOD_TIPO_BIEN,
				FECHA_CONSTITUCION				= @pdtFECHA_CONSTITUCION,
				FECHA_VENCIMIENTO				= @pdtFECHA_VENCIMIENTO,
				VALOR_NOMINAL_GARANTIA			= @pdVALOR_NOMINAL_GARANTIA,
				COD_TIPO_MONEDA_VALOR_NOMINAL	= @piCOD_TIPO_MONEDA_VALOR_NOMINAL,
				IND_POLIZA						= @psIND_POLIZA
		WHERE	ID_ROW = @piID_ROW 
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Cartas_Credito_Importacion_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/*
Garantias_Cartas_Credito_Importacion_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIAS_CARTAS_CREDITO_IMPORTACION
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Cartas_Credito_Importacion_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @TempItems TABLE
(
        ID INT IDENTITY(0,1),
		ID_ROW INT
)

SET LANGUAGE Spanish 

DECLARE @maxRow INT
DECLARE @vsSQL VARCHAR(4000)

SET @vsSQL = (SELECT 'SELECT ID_ROW FROM dbo.GARANTIAS_CARTAS_CREDITO_IMPORTACION
				WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ')

 IF @filterColumn = 'VALOR_NOMINAL_GARANTIA' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))
	SET @vsSQL = @vsSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	SET @vsSQL = @vsSQL + ' UPPER(ISNULL(' + 
									(	SELECT	CASE @filterColumn 
										WHEN 'FECHA_CONSTITUCION' THEN 'CONVERT(VARCHAR,FECHA_CONSTITUCION,103)' 
										WHEN 'FECHA_VENCIMIENTO' THEN 'CONVERT(VARCHAR,FECHA_VENCIMIENTO,103)'  
										ELSE +@filterColumn END )
							 + ','''')) LIKE ''' + @filterValue + ''''
END

--SET @filterValue = UPPER('%' + @filterValue + '%')
--IF @filterColumn = 'VALOR_NOMINAL_GARANTIA'
--BEGIN
--	SET @filterColumn = ' format('+@filterColumn+',''N3'','''+(SICAD_CONFIGURACION.dbo.Valor_Parametro(1))+''')'
--END

SET @maxRow = (@startRowIndex + @maximumRows)

SET ROWCOUNT @maxRow

SET @vsSQL = @vsSQL + ( ' ORDER BY ' + CASE WHEN @sortColumn = '' THEN 'ID_GARANTIA' ELSE @sortColumn END)

INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL)  
--EXECUTE('SELECT ID_ROW
--           FROM dbo.GARANTIAS_CARTAS_CREDITO_IMPORTACION
--          WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(' + @filterColumn + ') LIKE ''' + @filterValue + '''
--          ORDER BY ' + @sortColumn)
          
SET ROWCOUNT @maximumRows

SELECT GAR.ID_ROW, 
	   GAR.N_REGISTRO,
       GAR.EMPRESA,
       GAR.ID_GARANTIA,
       GAR.COD_TIPO_BIEN,
       GAR.FECHA_CONSTITUCION,
       GAR.FECHA_VENCIMIENTO,
       GAR.VALOR_NOMINAL_GARANTIA,
       GAR.COD_TIPO_MONEDA_VALOR_NOMINAL,
       GAR.IND_POLIZA
  FROM @TempItems TEMP
       INNER JOIN dbo.GARANTIAS_CARTAS_CREDITO_IMPORTACION GAR
               ON GAR.ID_ROW = TEMP.ID_ROW 
 WHERE TEMP.ID >= @startRowIndex

SET ROWCOUNT 0




GO
/****** Object:  StoredProcedure [dbo].[Garantias_Cartas_Credito_Importacion_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Cartas_Credito_Importacion_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIAS_CARTAS_CREDITO_IMPORTACION
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Cartas_Credito_Importacion_Consulta_Detalle]
        @piID_ROW INT
AS
	SELECT ID_ROW,
		   N_REGISTRO,
		   EMPRESA,
		   ID_GARANTIA,
		   COD_TIPO_BIEN,
		   FECHA_CONSTITUCION,
		   FECHA_VENCIMIENTO,
		   VALOR_NOMINAL_GARANTIA,
		   COD_TIPO_MONEDA_VALOR_NOMINAL,
		   IND_POLIZA
	 FROM  dbo.GARANTIAS_CARTAS_CREDITO_IMPORTACION
	 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Cartas_Credito_Importacion_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Cartas_Credito_Importacion_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIAS_CARTAS_CREDITO_IMPORTACION.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Cartas_Credito_Importacion_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.GARANTIAS_CARTAS_CREDITO_IMPORTACION
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ' 

 IF @filterColumn = 'VALOR_NOMINAL_GARANTIA' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))

	SET @StrSQL = @StrSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')

	SET @StrSQL = @StrSQL + ' UPPER(ISNULL(' +(	SELECT	CASE @filterColumn 
							WHEN 'FECHA_CONSTITUCION' THEN 'CONVERT(VARCHAR,FECHA_CONSTITUCION,103)' 
							WHEN 'FECHA_VENCIMIENTO' THEN 'CONVERT(VARCHAR,FECHA_VENCIMIENTO,103)'  
							ELSE +@filterColumn END ) + ','''')) LIKE ''' + @filterValue + ''''
END

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Cartas_Credito_Importacion_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Cartas_Credito_Importacion_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIAS_CARTAS_CREDITO_IMPORTACION
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Cartas_Credito_Importacion_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM	dbo.GARANTIAS_CARTAS_CREDITO_IMPORTACION
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Cartas_Credito_Importacion_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Cartas_Credito_Importacion_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIAS_CARTAS_CREDITO_IMPORTACION
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Cartas_Credito_Importacion_Inserta]
        @piEMPRESA							INT = NULL,
        @psID_GARANTIA						VARCHAR(25) = NULL,
        @piCOD_TIPO_BIEN					INT = NULL,
        @pdtFECHA_CONSTITUCION				DATE = NULL,
        @pdtFECHA_VENCIMIENTO				DATE = NULL,
        @pdVALOR_NOMINAL_GARANTIA			DECIMAL(22,0) = NULL,
        @piCOD_TIPO_MONEDA_VALOR_NOMINAL	INT = NULL,
        @psIND_POLIZA						VARCHAR(1) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO GARANTIAS_CARTAS_CREDITO_IMPORTACION (
					EMPRESA,
					ID_GARANTIA,
					COD_TIPO_BIEN,
					FECHA_CONSTITUCION,
					FECHA_VENCIMIENTO,
					VALOR_NOMINAL_GARANTIA,
					COD_TIPO_MONEDA_VALOR_NOMINAL,
					IND_POLIZA)

		SELECT	   @piEMPRESA,
				   @psID_GARANTIA,
				   @piCOD_TIPO_BIEN,
				   @pdtFECHA_CONSTITUCION,
				   @pdtFECHA_VENCIMIENTO,
				   @pdVALOR_NOMINAL_GARANTIA,
				   @piCOD_TIPO_MONEDA_VALOR_NOMINAL,
				   @psIND_POLIZA

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Cartas_Credito_Importacion_Poliza_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/*
Garantias_Cartas_Credito_Importacion_Poliza_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Cartas_Credito_Importacion_Poliza_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   ID INT IDENTITY(0,1),
	ID_ROW INT	) 

SET LANGUAGE Spanish
 
 DECLARE @maxRow INT
 DECLARE @vsSQL VARCHAR(4000)

 SET @vsSQL = (SELECT 'SELECT ID_ROW FROM dbo.GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA
				WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ')

  IF @filterColumn = 'MONTO_POLIZA' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))
	SET @vsSQL = @vsSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	SET @vsSQL = @vsSQL + ' UPPER(ISNULL(' + 
							(	SELECT	CASE @filterColumn 
								WHEN 'FECHA_VENCIMIENTO' THEN 'CONVERT(VARCHAR,FECHA_VENCIMIENTO,103)'  
								ELSE +@filterColumn END )
						+ ','''')) LIKE ''' + @filterValue + ''''
END

SET @vsSQL = @vsSQL + ( ' ORDER BY ' + CASE WHEN @sortColumn = '' THEN 'ID_GARANTIA' ELSE @sortColumn END)

--IF @filterColumn = 'MONTO_POLIZA'
--BEGIN
--	SET @filterColumn = ' format('+@filterColumn+',''N'','''+(SICAD_CONFIGURACION.dbo.Valor_Parametro(1))+''')'
--END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow

INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL) 
--EXECUTE('SELECT 
--			ID_ROW
--		FROM dbo.GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA
--		WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(' + @filterColumn + ') LIKE ''' + @filterValue + '''
--		ORDER BY ' + @sortColumn)
SET ROWCOUNT @maximumRows
	SELECT 
		E.ID_ROW, 
		E.N_REGISTRO,
		E.EMPRESA,
		E.ID_GARANTIA,
		E.COD_TIPO_POLIZA,
		E.MONTO_POLIZA,
		E.FECHA_VENCIMIENTO,
		E.IND_COBERTURA,
		E.COD_TIPO_PESONA_BENEFICIARIO,
		E.ID_BENEFICIARIO,
		TP.DES_TIPO_POLIZA
	FROM @TempItems T 
		INNER JOIN dbo.GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA E 
			ON E.ID_ROW = T.ID_ROW 
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_POLIZA TP
			ON E.COD_TIPO_POLIZA = TP.COD_TIPO_POLIZA
	WHERE ID >= @startRowIndex		

SET ROWCOUNT 0




GO
/****** Object:  StoredProcedure [dbo].[Garantias_Cartas_Credito_Importacion_Poliza_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Cartas_Credito_Importacion_Poliza_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Cartas_Credito_Importacion_Poliza_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT 	ID_ROW,
			N_REGISTRO,
			EMPRESA,
			ID_GARANTIA,
			COD_TIPO_POLIZA,
			MONTO_POLIZA,
			FECHA_VENCIMIENTO,
			IND_COBERTURA,
			COD_TIPO_PESONA_BENEFICIARIO,
			ID_BENEFICIARIO
	FROM	dbo.GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA
	WHERE	ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Cartas_Credito_Importacion_Poliza_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Cartas_Credito_Importacion_Poliza_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Cartas_Credito_Importacion_Poliza_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND '

 IF @filterColumn = 'MONTO_POLIZA' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))

	SET @StrSQL = @StrSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')

	SET @StrSQL = @StrSQL + ' UPPER(ISNULL(' +(	SELECT	CASE @filterColumn 
							WHEN 'FECHA_VENCIMIENTO' THEN 'CONVERT(VARCHAR,FECHA_VENCIMIENTO,103)'  
							ELSE +@filterColumn END ) + ','''')) LIKE ''' + @filterValue + ''''
END

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Cartas_Credito_Importacion_Poliza_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Cartas_Credito_Importacion_Poliza_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA
Sistema(s):SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Cartas_Credito_Importacion_Poliza_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM dbo.GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA
		WHERE ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Cartas_Credito_Importacion_Poliza_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Cartas_Credito_Importacion_Poliza_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Cartas_Credito_Importacion_Poliza_Inserta]	
	@piEMPRESA						INT = NULL,	
	@psID_GARANTIA					VARCHAR(25) = NULL,	
	@piCOD_TIPO_POLIZA				INT = NULL,	
	@pdMONTO_POLIZA					DECIMAL(25,2) = NULL,	
	@pdtFECHA_VENCIMIENTO			DATE = NULL,	
	@psIND_COBERTURA				VARCHAR(1) = NULL,	
	@piCOD_TIPO_PESONA_BENEFICIARIO INT = NULL,	
	@psID_BENEFICIARIO				VARCHAR(30)	 = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO GARANTIAS_CARTAS_CREDITO_IMPORTACION_POLIZA (
			EMPRESA,
			ID_GARANTIA,
			COD_TIPO_POLIZA,
			MONTO_POLIZA,
			FECHA_VENCIMIENTO,
			IND_COBERTURA,
			COD_TIPO_PESONA_BENEFICIARIO,
			ID_BENEFICIARIO)
		SELECT 
			@piEMPRESA,
			@psID_GARANTIA,
			@piCOD_TIPO_POLIZA,
			@pdMONTO_POLIZA,
			@pdtFECHA_VENCIMIENTO,
			@psIND_COBERTURA,
			@piCOD_TIPO_PESONA_BENEFICIARIO,
			@psID_BENEFICIARIO	

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Facturas_Cedidas_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Facturas_Cedidas_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIAS_FACTURAS_CEDIDAS
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Facturas_Cedidas_Actualiza]
        @piID_ROW							INT = NULL,
        @pdtFECHA_CONSTITUCION				DATE = NULL,
        @pdtFECHA_VENCIMIENTO				DATE = NULL,
        @piCOD_TIPO_PERSONA					INT = NULL,
        @psID_OBLIGADO						VARCHAR(30) = NULL,
        @pdVALOR_NOMINAL					DECIMAL(22,0) = NULL,
        @piCOD_TIPO_MONEDA_VALOR_NOMINAL	INT = NULL,
        @piCOD_TIPO_ASIGNACION_CALIFICACION INT = NULL,
        @piCOD_CATEGORIA_CALIFICACION		INT = NULL,
        @psCOD_CALIFICACION_RIESGO			VARCHAR(30) = NULL,
        @piCOD_EMPRESA_CALIFICADORA			INT = NULL
AS
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
        UPDATE	dbo.GARANTIAS_FACTURAS_CEDIDAS
        SET		FECHA_CONSTITUCION					= @pdtFECHA_CONSTITUCION ,
				FECHA_VENCIMIENTO					= @pdtFECHA_VENCIMIENTO,
				COD_TIPO_PERSONA					= @piCOD_TIPO_PERSONA,
				ID_OBLIGADO							= @psID_OBLIGADO,
				VALOR_NOMINAL						= @pdVALOR_NOMINAL,
				COD_TIPO_MONEDA_VALOR_NOMINAL		= @piCOD_TIPO_MONEDA_VALOR_NOMINAL,
				COD_TIPO_ASIGNACION_CALIFICACION	=@piCOD_TIPO_ASIGNACION_CALIFICACION,
				COD_CATEGORIA_CALIFICACION			= @piCOD_CATEGORIA_CALIFICACION,
				COD_CALIFICACION_RIESGO				= @psCOD_CALIFICACION_RIESGO,
				COD_EMPRESA_CALIFICADORA			= @piCOD_EMPRESA_CALIFICADORA
         WHERE	ID_ROW = @piID_ROW 
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Facturas_Cedidas_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/*
Garantias_Facturas_Cedidas_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIAS_FACTURAS_CEDIDAS
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Facturas_Cedidas_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @TempItems TABLE
(
        ID INT IDENTITY(0,1),
        ID_ROW INT
)

SET LANGUAGE Spanish   

DECLARE @maxRow INT
DECLARE @vsSQL VARCHAR(4000)

SET @vsSQL = (SELECT 'SELECT ID_ROW FROM dbo.GARANTIAS_FACTURAS_CEDIDAS
				WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ')

 IF @filterColumn = 'VALOR_NOMINAL' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))
	SET @vsSQL = @vsSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	SET @vsSQL = @vsSQL + ' UPPER(ISNULL(' + 
									(	SELECT	CASE @filterColumn 
									WHEN 'FECHA_VENCIMIENTO' THEN 'CONVERT(VARCHAR,FECHA_VENCIMIENTO,103)'  
									WHEN 'FECHA_CONSTITUCION' THEN 'CONVERT(VARCHAR,FECHA_CONSTITUCION,103)'  
									ELSE +@filterColumn END ) 
						+ ','''')) LIKE ''' + @filterValue + ''''
END

SET @vsSQL = @vsSQL + ( ' ORDER BY ' + CASE WHEN @sortColumn = '' THEN 'ID_GARANTIA' ELSE @sortColumn END)

--IF @filterColumn = 'VALOR_NOMINAL'
--BEGIN
--	SET @filterColumn = ' format('+@filterColumn+',''N'','''+(SICAD_CONFIGURACION. dbo.Valor_Parametro(1))+''')'
--END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow

INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL) 
--EXECUTE('SELECT ID_ROW FROM dbo.GARANTIAS_FACTURAS_CEDIDAS
--          WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(' + @filterColumn + ') LIKE ''' + @filterValue + '''
--          ORDER BY ' + @sortColumn)
          
SET ROWCOUNT @maximumRows

SELECT GAR.ID_ROW,
	   GAR.N_REGISTRO,
       GAR.EMPRESA,
       GAR.ID_GARANTIA,
       GAR.FECHA_CONSTITUCION,
       GAR.FECHA_VENCIMIENTO,
       GAR.COD_TIPO_PERSONA,
       GAR.ID_OBLIGADO,
       GAR.VALOR_NOMINAL,
       GAR.COD_TIPO_MONEDA_VALOR_NOMINAL,
       GAR.COD_TIPO_ASIGNACION_CALIFICACION,
       GAR.COD_CATEGORIA_CALIFICACION,
       GAR.COD_CALIFICACION_RIESGO,
       GAR.COD_EMPRESA_CALIFICADORA
  FROM @TempItems TEMP
       INNER JOIN dbo.GARANTIAS_FACTURAS_CEDIDAS GAR
               ON GAR.ID_ROW  = TEMP.ID_ROW 
 WHERE TEMP.ID >= @startRowIndex

SET ROWCOUNT 0




GO
/****** Object:  StoredProcedure [dbo].[Garantias_Facturas_Cedidas_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Facturas_Cedidas_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIAS_FACTURAS_CEDIDAS
Sistema(s): SICAD
Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Facturas_Cedidas_Consulta_Detalle]
        @piID_ROW INT
AS

	SELECT ID_ROW,
		   N_REGISTRO,
		   EMPRESA,
		   ID_GARANTIA,
		   FECHA_CONSTITUCION,
		   FECHA_VENCIMIENTO,
		   COD_TIPO_PERSONA,
		   ID_OBLIGADO,
		   VALOR_NOMINAL,
		   COD_TIPO_MONEDA_VALOR_NOMINAL,
		   COD_TIPO_ASIGNACION_CALIFICACION,
		   COD_CATEGORIA_CALIFICACION,
		   COD_CALIFICACION_RIESGO,
		   COD_EMPRESA_CALIFICADORA
	  FROM dbo.GARANTIAS_FACTURAS_CEDIDAS
	  WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Facturas_Cedidas_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Facturas_Cedidas_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIAS_FACTURAS_CEDIDAS.
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Facturas_Cedidas_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.GARANTIAS_FACTURAS_CEDIDAS
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND '

 IF @filterColumn = 'VALOR_NOMINAL' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))

	SET @StrSQL = @StrSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')

	SET @StrSQL = @StrSQL + ' UPPER(ISNULL(' + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_VENCIMIENTO' THEN 'CONVERT(VARCHAR,FECHA_VENCIMIENTO,103)'  
							WHEN 'FECHA_CONSTITUCION' THEN 'CONVERT(VARCHAR,FECHA_CONSTITUCION,103)'  
							ELSE +@filterColumn END ) + ','''')) LIKE ''' + @filterValue + ''''
END

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount







GO
/****** Object:  StoredProcedure [dbo].[Garantias_Facturas_Cedidas_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Facturas_Cedidas_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIAS_FACTURAS_CEDIDAS
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Facturas_Cedidas_Elimina]
		@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM	dbo.GARANTIAS_FACTURAS_CEDIDAS
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Facturas_Cedidas_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Facturas_Cedidas_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIAS_FACTURAS_CEDIDAS
Sistema(s):SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Facturas_Cedidas_Inserta]
        @piEMPRESA INT = NULL,
        @psID_GARANTIA VARCHAR(25) = NULL,
        @pdtFECHA_CONSTITUCION DATE = NULL,
        @pdtFECHA_VENCIMIENTO DATE = NULL,
        @piCOD_TIPO_PERSONA INT = NULL,
        @psID_OBLIGADO VARCHAR(30) = NULL,
        @pdVALOR_NOMINAL DECIMAL(22,0) = NULL,
        @piCOD_TIPO_MONEDA_VALOR_NOMINAL INT = NULL,
        @piCOD_TIPO_ASIGNACION_CALIFICACION INT = NULL,
        @piCOD_CATEGORIA_CALIFICACION INT = NULL,
        @psCOD_CALIFICACION_RIESGO VARCHAR(30) = NULL,
        @piCOD_EMPRESA_CALIFICADORA INT = NULL
AS
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO GARANTIAS_FACTURAS_CEDIDAS(
					EMPRESA,
					ID_GARANTIA,
					FECHA_CONSTITUCION,
					FECHA_VENCIMIENTO,
					COD_TIPO_PERSONA,
					ID_OBLIGADO,
					VALOR_NOMINAL,
					COD_TIPO_MONEDA_VALOR_NOMINAL,
					COD_TIPO_ASIGNACION_CALIFICACION,
					COD_CATEGORIA_CALIFICACION,
					COD_CALIFICACION_RIESGO,
					COD_EMPRESA_CALIFICADORA)

		SELECT @piEMPRESA,
			   @psID_GARANTIA,
			   @pdtFECHA_CONSTITUCION,
			   @pdtFECHA_VENCIMIENTO,
			   @piCOD_TIPO_PERSONA,
			   @psID_OBLIGADO,
			   @pdVALOR_NOMINAL,
			   @piCOD_TIPO_MONEDA_VALOR_NOMINAL,
			   @piCOD_TIPO_ASIGNACION_CALIFICACION,
			   @piCOD_CATEGORIA_CALIFICACION,
			   @psCOD_CALIFICACION_RIESGO,
			   @piCOD_EMPRESA_CALIFICADORA

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIAS_FIDEICOMISO
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Actualiza]
	@piID_ROW						 INT = NULL,
	@piCOD_TIPO_LIMITACION			 INT = NULL,
	@pdtFECHA_CONSTITUCION			 DATE = NULL,
	@pdtFECHA_VENCIMIENTO			 DATE = NULL,
	@pdVALOR_NOMINAL				 DECIMAL(22,0) = NULL,
	@piCOD_TIPO_MONEDA_VALOR_NOMINAL INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.GARANTIAS_FIDEICOMISO
		SET		COD_TIPO_LIMITACION				= @piCOD_TIPO_LIMITACION,
				FECHA_CONSTITUCION				= @pdtFECHA_CONSTITUCION,
				FECHA_VENCIMIENTO				= @pdtFECHA_VENCIMIENTO,
				VALOR_NOMINAL					= @pdVALOR_NOMINAL,
				COD_TIPO_MONEDA_VALOR_NOMINAL	= @piCOD_TIPO_MONEDA_VALOR_NOMINAL
		WHERE	ID_ROW = @piID_ROW 
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/*
Garantias_Fideicomiso_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIAS_FIDEICOMISO
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   ID INT IDENTITY(0,1),
   ID_ROW INT)

SET LANGUAGE Spanish 
	 
	DECLARE @maxRow INT
	DECLARE @vsSQL VARCHAR(4000)

SET @vsSQL = (SELECT 'SELECT ID_ROW FROM dbo.GARANTIAS_FIDEICOMISO
				WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ')

 IF @filterColumn = 'VALOR_NOMINAL' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')	
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))
	SET @vsSQL = @vsSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	SET @vsSQL = @vsSQL + ' UPPER(ISNULL('  +  
							(	SELECT	CASE @filterColumn 
								WHEN 'FECHA_VENCIMIENTO' THEN 'CONVERT(VARCHAR,FECHA_VENCIMIENTO,103)'  
								WHEN 'FECHA_CONSTITUCION' THEN 'CONVERT(VARCHAR,FECHA_CONSTITUCION,103)'  
								ELSE +@filterColumn END )
						+ ','''')) LIKE ''' + @filterValue + ''''
END

SET @vsSQL = @vsSQL + (' ORDER BY ' + CASE WHEN @sortColumn = '' THEN 'ID_GARANTIA' ELSE @sortColumn END)

--IF @filterColumn = 'VALOR_NOMINAL'
--BEGIN
--	SET @filterColumn = ' format('+@filterColumn+',''N'','''+(SICAD_CONFIGURACION. dbo.Valor_Parametro(1))+''')'
--END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow

INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL) 
--EXECUTE('SELECT ID_ROW FROM dbo.GARANTIAS_FIDEICOMISO
--WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(' + @filterColumn + ') LIKE ''' + @filterValue + '''
--ORDER BY ' + @sortColumn)

SET ROWCOUNT @maximumRows
	SELECT
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA,
		E.ID_GARANTIA,
		E.COD_TIPO_LIMITACION,
		E.FECHA_CONSTITUCION,
		E.FECHA_VENCIMIENTO,
		E.VALOR_NOMINAL,
		E.COD_TIPO_MONEDA_VALOR_NOMINAL
	FROM @TempItems T 
		INNER JOIN dbo.GARANTIAS_FIDEICOMISO E 
			ON E.ID_ROW = T.ID_ROW 
	WHERE ID >= @startRowIndex		

SET ROWCOUNT 0




GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIAS_FIDEICOMISO
Sistema(s): SICAD

Historial de cambios:

*/
CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT	ID_ROW,
			N_REGISTRO,
			EMPRESA,
			ID_GARANTIA,
			COD_TIPO_LIMITACION,
			FECHA_CONSTITUCION,
			FECHA_VENCIMIENTO,
			VALOR_NOMINAL,
			COD_TIPO_MONEDA_VALOR_NOMINAL
	FROM	dbo.GARANTIAS_FIDEICOMISO
	WHERE	ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIAS_FIDEICOMISO.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.GARANTIAS_FIDEICOMISO
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ' 

IF @filterColumn = 'VALOR_NOMINAL' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))

	SET @StrSQL = @StrSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	SET @StrSQL = @StrSQL +' UPPER(ISNULL(' + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_VENCIMIENTO' THEN 'CONVERT(VARCHAR,FECHA_VENCIMIENTO,103)'  
							WHEN 'FECHA_CONSTITUCION' THEN 'CONVERT(VARCHAR,FECHA_CONSTITUCION,103)'  
							ELSE +@filterColumn END ) + ','''')) LIKE ''' + @filterValue + ''''
END

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount







GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIAS_FIDEICOMISO
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Elimina]
	@piID_ROW INT
AS 
	DELETE 	 	
	FROM	dbo.GARANTIAS_FIDEICOMISO
	WHERE	ID_ROW = @piID_ROW 

	SELECT 0





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Garantia_Fideicometida_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Actualiza]
        @piID_ROW								INT = NULL,
        @piCOD_TIPO_GARANTIA					INT = NULL,
        @piIND_INSCRIPCION_FAVOR_FIDUCIARIO		INT = NULL,
        @pdtFECHA_PRESENTACION					DATE = NULL,
        @pdPCJ_ACEPTACION						DECIMAL(7,2) = NULL,
        @pdVALOR_NOMINAL						DECIMAL(22,0) = NULL,
        @piCOD_TIPO_MONEDA_VALOR_NOMINAL		INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA
		   SET	COD_TIPO_GARANTIA				 = @piCOD_TIPO_GARANTIA,
				IND_INSCRIPCION_FAVOR_FIDUCIARIO = @piIND_INSCRIPCION_FAVOR_FIDUCIARIO,
				FECHA_PRESENTACION				 = @pdtFECHA_PRESENTACION,
				PCJ_ACEPTACION					 = @pdPCJ_ACEPTACION,
				VALOR_NOMINAL					 = @pdVALOR_NOMINAL,
				COD_TIPO_MONEDA_VALOR_NOMINAL	 = @piCOD_TIPO_MONEDA_VALOR_NOMINAL
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Garantia_Fideicometida_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIAS_FIDEICOMETIDA
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @TempItems TABLE
(
        ID INT IDENTITY(0,1),
        ID_ROW INT
)

DECLARE @maxRow INT
SET @filterValue = '%' + @filterValue + '%'

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_GARANTIA_FIDEICOMETIDA' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT ID_ROW 
           FROM dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA
          WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL('  + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
          ORDER BY ' + @sortColumn)
          
SET ROWCOUNT @maximumRows

SELECT GAR.ID_ROW,
	   GAR.N_REGISTRO,
       GAR.EMPRESA,
       GAR.ID_GARANTIA,
       GAR.COD_TIPO_GARANTIA,
       GAR.ID_GARANTIA_FIDEICOMETIDA,
       GAR.COD_TIPO_MITIGADOR,
       GAR.IND_INSCRIPCION_FAVOR_FIDUCIARIO,
       GAR.FECHA_PRESENTACION,
       GAR.PCJ_ACEPTACION,
       GAR.VALOR_NOMINAL,
       GAR.COD_TIPO_MONEDA_VALOR_NOMINAL,
       GAR.COD_TIPO_DOCUMENTO_LEGAL,
	   TG.DES_TIPO_GARANTIA,
	   TM.DES_TIPO_MITIGADOR_RIESGO,
	   TDL.DES_TIPO_DOCUMENTO_LEGAL
  FROM @TempItems TEMP
		INNER JOIN dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA GAR
				ON TEMP.ID_ROW = GAR.ID_ROW
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_GARANTIA TG
				ON GAR.COD_TIPO_GARANTIA = TG.COD_TIPO_GARANTIA
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_MITIGADOR_RIESGO TM
				ON GAR.COD_TIPO_MITIGADOR = TM.COD_TIPO_MITIGADOR_RIESGO
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_DOCUMENTO_LEGAL TDL
				ON GAR.COD_TIPO_DOCUMENTO_LEGAL = TDL.COD_TIPO_DOCUMENTO_LEGAL

 WHERE ID >= @startRowIndex
 
SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Garantia_Fideicometida_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA
Sistema(s):SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Consulta_Detalle]
		@piID_ROW INT
AS

SELECT ID_ROW,
	   N_REGISTRO,
       EMPRESA,
       ID_GARANTIA,
       COD_TIPO_GARANTIA,
       ID_GARANTIA_FIDEICOMETIDA,
       COD_TIPO_MITIGADOR,
       IND_INSCRIPCION_FAVOR_FIDUCIARIO,
       FECHA_PRESENTACION,
       PCJ_ACEPTACION,
       VALOR_NOMINAL,
       COD_TIPO_MONEDA_VALOR_NOMINAL,
       COD_TIPO_DOCUMENTO_LEGAL
  FROM dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA
 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Garantia_Fideicometida_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA.
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Garantia_Fideicometida_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA
Sistema(s): SICAD
Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Elimina]
        @piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM	dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA
		WHERE	ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Actualiza]
	@piID_ROW INT = NULL,
	@pdMONTO_GRADO_GRAVAMEN DECIMAL(25,2) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN
		SET		MONTO_GRADO_GRAVAMEN = @pdMONTO_GRADO_GRAVAMEN		
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/*
Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   ID INT IDENTITY(0,1),
	ID_ROW INT
)
 DECLARE @maxRow INT
 DECLARE @vsSQL VARCHAR(4000)

SET @vsSQL = ( 'SELECT 
				ID_ROW
				FROM dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN
				WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ')

  IF @filterColumn = 'MONTO_GRADO_GRAVAMEN' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))
	SET @vsSQL = @vsSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	SET @vsSQL = @vsSQL + ' UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''
END

SET @vsSQL = @vsSQL + ' ORDER BY ' + CASE WHEN @sortColumn = '' THEN 'ID_GARANTIA' ELSE @sortColumn END

--IF @filterColumn = 'MONTO_GRADO_GRAVAMEN'
--BEGIN
--	SET @filterColumn = ' format('+@filterColumn+',''N'','''+(SICAD_CONFIGURACION.dbo.Valor_Parametro(1))+''')'
--END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL)

SET ROWCOUNT @maximumRows
	SELECT 
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA,
		E.ID_GARANTIA,
		E.ID_GARANTIA_FIDEICOMETIDA,
		E.COD_TIPO_MITIGADOR,
		E.COD_TIPO_DOCUMENTO_LEGAL,
		E.COD_GRADO_GRAVAMEN,
		E.COD_TIPO_PERSONA_ACREEDOR,
		E.ID_ACREEDOR,
		E.MONTO_GRADO_GRAVAMEN,
		TM.DES_TIPO_MITIGADOR_RIESGO,
		TDL.DES_TIPO_DOCUMENTO_LEGAL,
		TG.DES_TIPO_GRADO

	FROM @TempItems T 
		INNER JOIN dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN E 
			ON E.ID_ROW = T.ID_ROW 
		LEFT JOIN  SICAD_CONFIGURACION.dbo.TIPO_MITIGADOR_RIESGO TM
			ON E.COD_TIPO_MITIGADOR = TM.COD_TIPO_MITIGADOR_RIESGO
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_DOCUMENTO_LEGAL TDL
			ON E.COD_TIPO_DOCUMENTO_LEGAL = TDL.COD_TIPO_DOCUMENTO_LEGAL
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_GRADO TG
			ON E.COD_GRADO_GRAVAMEN = TG.COD_TIPO_GRADO
	WHERE ID >= @startRowIndex		

SET ROWCOUNT 0




GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN
Sistema(s):SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Consulta_Detalle]
	(@piID_ROW INT)
AS
	SELECT 	ID_ROW,
			N_REGISTRO,
			EMPRESA,
			ID_GARANTIA,
			ID_GARANTIA_FIDEICOMETIDA,
			COD_TIPO_MITIGADOR,
			COD_TIPO_DOCUMENTO_LEGAL,
			COD_GRADO_GRAVAMEN,
			COD_TIPO_PERSONA_ACREEDOR,
			ID_ACREEDOR,
			MONTO_GRADO_GRAVAMEN
	FROM	dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN
	WHERE	ID_ROW = @piID_ROW
	





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND '

 IF @filterColumn = 'MONTO_GRADO_GRAVAMEN' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))

	SET @StrSQL = @StrSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')

	SET @StrSQL = @StrSQL + ' UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''
END

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount




GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN
		WHERE ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Gravamen_Inserta]	
	@piEMPRESA						INT = NULL,
	@psID_GARANTIA					VARCHAR(25) = NULL,
	@psID_GARANTIA_FIDEICOMETIDA	VARCHAR(25) = NULL,
	@piCOD_TIPO_MITIGADOR			INT = NULL,
	@piCOD_TIPO_DOCUMENTO_LEGAL		INT = NULL,
	@piCOD_GRADO_GRAVAMEN			INT = NULL,
	@piCOD_TIPO_PERSONA_ACREEDOR	INT = NULL,
	@psID_ACREEDOR					VARCHAR(30) = NULL,
	@pdMONTO_GRADO_GRAVAMEN			DECIMAL(25,2) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA_GRAVAMEN (
			EMPRESA,
			ID_GARANTIA,
			ID_GARANTIA_FIDEICOMETIDA,
			COD_TIPO_MITIGADOR,
			COD_TIPO_DOCUMENTO_LEGAL,
			COD_GRADO_GRAVAMEN,
			COD_TIPO_PERSONA_ACREEDOR,
			ID_ACREEDOR,
			MONTO_GRADO_GRAVAMEN)
		SELECT 
			@piEMPRESA,
			@psID_GARANTIA,
			@psID_GARANTIA_FIDEICOMETIDA,
			@piCOD_TIPO_MITIGADOR,
			@piCOD_TIPO_DOCUMENTO_LEGAL,
			@piCOD_GRADO_GRAVAMEN,
			@piCOD_TIPO_PERSONA_ACREEDOR,
			@psID_ACREEDOR,
			@pdMONTO_GRADO_GRAVAMEN 
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Garantia_Fideicometida_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Garantia_Fideicometida_Inserta]
        @piEMPRESA INT = NULL,
        @psID_GARANTIA VARCHAR(25) = NULL,
        @piCOD_TIPO_GARANTIA INT = NULL,
        @psID_GARANTIA_FIDEICOMETIDA VARCHAR(25) = NULL,
        @piCOD_TIPO_MITIGADOR INT = NULL,
        @piIND_INSCRIPCION_FAVOR_FIDUCIARIO INT = NULL,
        @pdtFECHA_PRESENTACION DATE = NULL,
        @pdPCJ_ACEPTACION DECIMAL(7,2) = NULL,
        @pdVALOR_NOMINAL DECIMAL(22,0) = NULL,
        @piCOD_TIPO_MONEDA_VALOR_NOMINAL INT = NULL,
        @piCOD_TIPO_DOCUMENTO_LEGAL INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.GARANTIAS_FIDEICOMISO_GARANTIA_FIDEICOMETIDA(
					EMPRESA ,
					ID_GARANTIA,
					COD_TIPO_GARANTIA,
					ID_GARANTIA_FIDEICOMETIDA,
					COD_TIPO_MITIGADOR,
					IND_INSCRIPCION_FAVOR_FIDUCIARIO,
					FECHA_PRESENTACION,
					PCJ_ACEPTACION,
					VALOR_NOMINAL,
					COD_TIPO_MONEDA_VALOR_NOMINAL,
					COD_TIPO_DOCUMENTO_LEGAL)
		SELECT		@piEMPRESA,
					@psID_GARANTIA,
					@piCOD_TIPO_GARANTIA,
					@psID_GARANTIA_FIDEICOMETIDA,
					@piCOD_TIPO_MITIGADOR,
					@piIND_INSCRIPCION_FAVOR_FIDUCIARIO,
					@pdtFECHA_PRESENTACION,
					@pdPCJ_ACEPTACION,
					@pdVALOR_NOMINAL,
					@piCOD_TIPO_MONEDA_VALOR_NOMINAL,
					@piCOD_TIPO_DOCUMENTO_LEGAL
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fideicomiso_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fideicomiso_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIAS_FIDEICOMISO
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Fideicomiso_Inserta]	
	@piEMPRESA						 INT = NULL,
	@psID_GARANTIA					 VARCHAR(25) = NULL,
	@piCOD_TIPO_LIMITACION			 INT = NULL,
	@pdtFECHA_CONSTITUCION			 DATE = NULL,
	@pdtFECHA_VENCIMIENTO			 DATE = NULL,
	@pdVALOR_NOMINAL				 DECIMAL(22,0) = NULL,
	@piCOD_TIPO_MONEDA_VALOR_NOMINAL INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.GARANTIAS_FIDEICOMISO (
			EMPRESA,
			ID_GARANTIA,
			COD_TIPO_LIMITACION,
			FECHA_CONSTITUCION,
			FECHA_VENCIMIENTO,
			VALOR_NOMINAL,
			COD_TIPO_MONEDA_VALOR_NOMINAL)
		SELECT 
			@piEMPRESA,
			@psID_GARANTIA,
			@piCOD_TIPO_LIMITACION,
			@pdtFECHA_CONSTITUCION,
			@pdtFECHA_VENCIMIENTO,
			@pdVALOR_NOMINAL,
			@piCOD_TIPO_MONEDA_VALOR_NOMINAL	
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fiduciarias_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fiduciarias_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIAS_FIDUCIARIAS
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Fiduciarias_Actualiza]
        @piID_ROW							INT = NULL,
        @piCOD_TIPO_PERSONA					INT = NULL,
        @psID_FIADOR						VARCHAR(30) = NULL,
        @piCOD_TIPO_ASIGNACION_CALIFICACION INT = NULL,
        @piCOD_CATEGORIA_CALIFICACION		INT = NULL,
        @psCOD_CALIFICACION_RIESGO			VARCHAR(30) = NULL,
        @piCOD_EMPRESA_CALIFICADORA			INT = NULL,
        @pdSALARIO_NETO_FIADOR				DECIMAL(25,2) = NULL,
        @pdtFECHA_VERIFICACION_ASALARIADO	DATE = NULL

AS 
 	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.GARANTIAS_FIDUCIARIAS
		SET		COD_TIPO_PERSONA				 = @piCOD_TIPO_PERSONA,
				ID_FIADOR						 = @psID_FIADOR,
				COD_TIPO_ASIGNACION_CALIFICACION = @piCOD_TIPO_ASIGNACION_CALIFICACION,
				COD_CATEGORIA_CALIFICACION		 = @piCOD_CATEGORIA_CALIFICACION,
				COD_CALIFICACION_RIESGO		 	 = @psCOD_CALIFICACION_RIESGO,
				COD_EMPRESA_CALIFICADORA		 = @piCOD_EMPRESA_CALIFICADORA,
				SALARIO_NETO_FIADOR				 = @pdSALARIO_NETO_FIADOR,
				FECHA_VERIFICACION_ASALARIADO	 = @pdtFECHA_VERIFICACION_ASALARIADO
		WHERE ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fiduciarias_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/*
Garantias_Fiduciarias_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIAS_FIDUCIARIAS
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Fiduciarias_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
)

AS

DECLARE @TempItems TABLE
(
        ID INT IDENTITY(0,1),
        ID_ROW INT
)

SET LANGUAGE Spanish 
	 
DECLARE @maxRow INT
DECLARE @vsSQL VARCHAR(4000)

SET @vsSQL = (SELECT 'SELECT ID_ROW FROM dbo.GARANTIAS_FIDUCIARIAS
				WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ')

IF @filterColumn = 'SALARIO_NETO_FIADOR' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))
	SET @vsSQL = @vsSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	SET @vsSQL = @vsSQL + ' UPPER(ISNULL('  +
							 (	SELECT	CASE @filterColumn 
								WHEN 'FECHA_VERIFICACION_ASALARIADO' THEN 'CONVERT(VARCHAR,FECHA_VERIFICACION_ASALARIADO,103)'  
								ELSE +@filterColumn END ) 
						+ ','''')) LIKE ''' + @filterValue + ''''
END

SET @vsSQL = @vsSQL + ( ' ORDER BY ' + CASE WHEN @sortColumn = '' THEN 'ID_GARANTIA' ELSE @sortColumn END)

--IF @filterColumn = 'SALARIO_NETO_FIADOR'
--BEGIN
--	SET @filterColumn = ' format('+@filterColumn+',''N'','''+(SICAD_CONFIGURACION.dbo.Valor_Parametro(1))+''')'
--END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow

INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL) 
--EXECUTE('SELECT ID_ROW FROM dbo.GARANTIAS_FIDUCIARIAS
--           WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(' + @filterColumn + ') LIKE ''' + @filterValue + '''
--           ORDER BY ' + @sortColumn)

SET ROWCOUNT @maximumRows

SELECT 
       GAR.ID_ROW,
       GAR.N_REGISTRO,
       GAR.EMPRESA,
       GAR.ID_GARANTIA,
       GAR.COD_TIPO_PERSONA,
       GAR.ID_FIADOR,
       GAR.COD_TIPO_ASIGNACION_CALIFICACION,
       GAR.COD_CATEGORIA_CALIFICACION,
       GAR.COD_CALIFICACION_RIESGO,
       GAR.COD_EMPRESA_CALIFICADORA,
       GAR.SALARIO_NETO_FIADOR,
       GAR.FECHA_VERIFICACION_ASALARIADO,
	   TP.DES_TIPO_PERSONA
  FROM @TempItems TEMP
	INNER JOIN dbo.GARANTIAS_FIDUCIARIAS GAR
		ON GAR.ID_ROW = TEMP.ID_ROW
	LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_PERSONA TP
		ON GAR.COD_TIPO_PERSONA = TP.COD_TIPO_PERSONA
                
 WHERE TEMP.ID >= @startRowIndex
 
SET ROWCOUNT 0




GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fiduciarias_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fiduciarias_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIAS_FIDUCIARIAS
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Fiduciarias_Consulta_Detalle]
        @piID_ROW INT
AS

SELECT 
       ID_ROW,
       N_REGISTRO,
       EMPRESA,
       ID_GARANTIA,
       COD_TIPO_PERSONA,
       ID_FIADOR,
       COD_TIPO_ASIGNACION_CALIFICACION,
       COD_CATEGORIA_CALIFICACION,
       COD_CALIFICACION_RIESGO,
       COD_EMPRESA_CALIFICADORA,
       SALARIO_NETO_FIADOR,
       FECHA_VERIFICACION_ASALARIADO
  FROM dbo.GARANTIAS_FIDUCIARIAS
 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fiduciarias_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fiduciarias_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIAS_FIDUCIARIAS.
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Fiduciarias_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.GARANTIAS_FIDUCIARIAS
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND '

 IF @filterColumn = 'SALARIO_NETO_FIADOR' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))

	SET @StrSQL = @StrSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')

	SET @StrSQL = @StrSQL + ' UPPER(ISNULL(' + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_VERIFICACION_ASALARIADO' THEN 'CONVERT(VARCHAR,FECHA_VERIFICACION_ASALARIADO,103)'  
							ELSE +@filterColumn END ) + ','''')) LIKE ''' + @filterValue + ''''
END

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fiduciarias_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fiduciarias_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIAS_FIDUCIARIAS
Sistema(s): SICAD
Historial de cambios: @ID_ROW  
*/

CREATE PROCEDURE [dbo].[Garantias_Fiduciarias_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE
		FROM dbo.GARANTIAS_FIDUCIARIAS
		WHERE ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Fiduciarias_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Fiduciarias_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIAS_FIDUCIARIAS
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Fiduciarias_Inserta]
	@piEMPRESA							INT = NULL,
	@psID_GARANTIA						VARCHAR(25) = NULL,
	@piCOD_TIPO_PERSONA					INT = NULL,
	@psID_FIADOR						VARCHAR(30) = NULL,
	@piCOD_TIPO_ASIGNACION_CALIFICACION INT = NULL,
	@piCOD_CATEGORIA_CALIFICACION		INT = NULL,
	@psCOD_CALIFICACION_RIESGO			VARCHAR(30) = NULL,
	@piCOD_EMPRESA_CALIFICADORA			INT = NULL,
	@pdSALARIO_NETO_FIADOR				DECIMAL(25,2) = NULL,
	@pdtFECHA_VERIFICACION_ASALARIADO	DATE = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.GARANTIAS_FIDUCIARIAS(
				EMPRESA,
				ID_GARANTIA,
				COD_TIPO_PERSONA,
				ID_FIADOR,
				COD_TIPO_ASIGNACION_CALIFICACION,
				COD_CATEGORIA_CALIFICACION,
				COD_CALIFICACION_RIESGO,
				COD_EMPRESA_CALIFICADORA,
				SALARIO_NETO_FIADOR,
				FECHA_VERIFICACION_ASALARIADO)

		SELECT @piEMPRESA,
			   @psID_GARANTIA,
			   @piCOD_TIPO_PERSONA,
			   @psID_FIADOR,
			   @piCOD_TIPO_ASIGNACION_CALIFICACION,
			   @piCOD_CATEGORIA_CALIFICACION,
			   @psCOD_CALIFICACION_RIESGO,
			   @piCOD_EMPRESA_CALIFICADORA,
			   @pdSALARIO_NETO_FIADOR,
			   @pdtFECHA_VERIFICACION_ASALARIADO

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Reales_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Reales_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIAS_REALES
Sistema(s): SICAD

Historial de cambios: 

*/

CREATE PROCEDURE [dbo].[Garantias_Reales_Actualiza]
	@piID_ROW								 INT = NULL,
	@piCOD_TIPO_BIEN						 INT = NULL,
	@psID_BIEN								 VARCHAR(25) = NULL,
	@pdMONTO_ULTIMA_TASACION_TERRENO		 DECIMAL(25, 2) = NULL,
	@pdMONTO_ULTIMA_TASACION_NO_TERRENO		 DECIMAL(25, 2) = NULL,
	@pdtFECHA_ULTIMA_TASACION_GARANTIA		 DATE = NULL,
	@pdMONTO_TASACION_ACTUALIZADA_TERRENO	 DECIMAL(25, 2) = NULL,
	@pdMONTO_TASACION_ACTUALIZADA_NO_TERRENO DECIMAL(25, 2) = NULL,
	@pdtFECHA_ULTIMO_SEGUIMIENTO			 DATE = NULL,
	@pdtFECHA_CONSTRUCCION					 DATE = NULL,
	@piCOD_TIPO_PERSONA_TASADOR				 INT = NULL,
	@psID_TASADOR							 VARCHAR(30) = NULL,
	@piCOD_TIPO_PERSONA_EMPRESA_TASADORA	 INT = NULL,
	@psID_EMPRESA_TASADORA					 VARCHAR(30) = NULL,
	@psIND_POLIZA							 VARCHAR(1) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.GARANTIAS_REALES
		SET		COD_TIPO_BIEN							= @piCOD_TIPO_BIEN,
				ID_BIEN									= @psID_BIEN,
				MONTO_ULTIMA_TASACION_TERRENO			= @pdMONTO_ULTIMA_TASACION_TERRENO,
				MONTO_ULTIMA_TASACION_NO_TERRENO		= @pdMONTO_ULTIMA_TASACION_NO_TERRENO,
				FECHA_ULTIMA_TASACION_GARANTIA			= @pdtFECHA_ULTIMA_TASACION_GARANTIA,
				MONTO_TASACION_ACTUALIZADA_TERRENO		= @pdMONTO_TASACION_ACTUALIZADA_TERRENO,
				MONTO_TASACION_ACTUALIZADA_NO_TERRENO	= @pdMONTO_TASACION_ACTUALIZADA_NO_TERRENO,
				FECHA_ULTIMO_SEGUIMIENTO				= @pdtFECHA_ULTIMO_SEGUIMIENTO,
				FECHA_CONSTRUCCION						= @pdtFECHA_CONSTRUCCION,
				COD_TIPO_PERSONA_TASADOR				= @piCOD_TIPO_PERSONA_TASADOR,
				ID_TASADOR								= @psID_TASADOR,
				COD_TIPO_PERSONA_EMPRESA_TASADORA		= @piCOD_TIPO_PERSONA_EMPRESA_TASADORA,
				ID_EMPRESA_TASADORA						= @psID_EMPRESA_TASADORA,
				IND_POLIZA								= @psIND_POLIZA
		WHERE	ID_ROW = @piID_ROW	
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Reales_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Garantias_Reales_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIAS_REALES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Reales_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   ID INT IDENTITY(0,1),
    ID_ROW INT
 )
 
 DECLARE @maxRow INT
DECLARE @vsSQL VARCHAR(4000)

SET @filterValue = UPPER( '%' + @filterValue + '%')

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_GARANTIA' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow

SET @vsSQL = (SELECT 'SELECT ID_ROW FROM dbo.GARANTIAS_REALES
				WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(')

SET @vsSQL = @vsSQL + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_ULTIMA_TASACION_GARANTIA' THEN 'CONVERT(VARCHAR,FECHA_ULTIMA_TASACION_GARANTIA,103)'  
							ELSE +@filterColumn END )

SET @vsSQL = @vsSQL + ( ','''')) LIKE ''' + @filterValue + '''
							ORDER BY ' + @sortColumn)


INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL) 
--EXECUTE('SELECT ID_ROW FROM dbo.GARANTIAS_REALES
--WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(' + @filterColumn + ') LIKE ''' + @filterValue + '''
--ORDER BY ' + @sortColumn)

SET ROWCOUNT @maximumRows
	SELECT 
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA,
		E.ID_GARANTIA,
		E.COD_TIPO_BIEN,
		E.ID_BIEN,
		E.MONTO_ULTIMA_TASACION_TERRENO,
		E.MONTO_ULTIMA_TASACION_NO_TERRENO,
		E.FECHA_ULTIMA_TASACION_GARANTIA,
		E.MONTO_TASACION_ACTUALIZADA_TERRENO,
		E.MONTO_TASACION_ACTUALIZADA_NO_TERRENO,
		E.FECHA_ULTIMO_SEGUIMIENTO,
		E.FECHA_CONSTRUCCION,
		E.COD_TIPO_PERSONA_TASADOR,
		E.ID_TASADOR,
		E.COD_TIPO_PERSONA_EMPRESA_TASADORA,
		E.ID_EMPRESA_TASADORA,
		E.IND_POLIZA,
		TB.DES_TIPO_BIEN
	FROM @TempItems T 
        INNER JOIN dbo.GARANTIAS_REALES E 
			ON E.ID_ROW = T.ID_ROW	
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_BIEN TB
			ON E.COD_TIPO_BIEN = TB.COD_TIPO_BIEN			
	WHERE ID >= @startRowIndex		

SET ROWCOUNT 0





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Reales_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Reales_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIAS_REALES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Reales_Consulta_Detalle]
        @piID_ROW INT
AS
	SELECT 
		ID_ROW,
		N_REGISTRO,
		EMPRESA,
		ID_GARANTIA,
		COD_TIPO_BIEN,
		ID_BIEN,
		MONTO_ULTIMA_TASACION_TERRENO,
		MONTO_ULTIMA_TASACION_NO_TERRENO,
		FECHA_ULTIMA_TASACION_GARANTIA,
		MONTO_TASACION_ACTUALIZADA_TERRENO,
		MONTO_TASACION_ACTUALIZADA_NO_TERRENO,
		FECHA_ULTIMO_SEGUIMIENTO,
		FECHA_CONSTRUCCION,
		COD_TIPO_PERSONA_TASADOR,
		ID_TASADOR,
		COD_TIPO_PERSONA_EMPRESA_TASADORA,
		ID_EMPRESA_TASADORA,
		IND_POLIZA
	FROM dbo.GARANTIAS_REALES
	WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Reales_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Garantias_Reales_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIAS_REALES.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Reales_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = UPPER('%' + @filterValue + '%')

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.GARANTIAS_REALES
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' 

SET @StrSQL = @StrSQL + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_ULTIMA_TASACION_GARANTIA' THEN 'CONVERT(VARCHAR,FECHA_ULTIMA_TASACION_GARANTIA,103)'  
							ELSE +@filterColumn END )


SET @StrSQL = @StrSQL + ( ','''')) LIKE ''' + @filterValue + '''' )


EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount




GO
/****** Object:  StoredProcedure [dbo].[Garantias_Reales_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Reales_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIAS_REALES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Reales_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM dbo.GARANTIAS_REALES
		WHERE ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Reales_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Reales_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIAS_REALES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Reales_Inserta]	
	@piEMPRESA									INT = NULL,
	@psID_GARANTIA								VARCHAR(25) = NULL,
	@piCOD_TIPO_BIEN							INT = NULL,
	@psID_BIEN									VARCHAR(25) = NULL,
	@pdMONTO_ULTIMA_TASACION_TERRENO			DECIMAL(25, 2) = NULL,
	@pdMONTO_ULTIMA_TASACION_NO_TERRENO			DECIMAL(25, 2) = NULL,
	@pdtFECHA_ULTIMA_TASACION_GARANTIA			DATE = NULL,
	@pdMONTO_TASACION_ACTUALIZADA_TERRENO		DECIMAL(25, 2) = NULL,
	@pdMONTO_TASACION_ACTUALIZADA_NO_TERRENO	DECIMAL(25, 2) = NULL,
	@pdtFECHA_ULTIMO_SEGUIMIENTO				DATE = NULL,
	@pdtFECHA_CONSTRUCCION						DATE = NULL,
	@piCOD_TIPO_PERSONA_TASADOR					INT = NULL,
	@psID_TASADOR								VARCHAR(30) = NULL,
	@piCOD_TIPO_PERSONA_EMPRESA_TASADORA		INT = NULL,
	@psID_EMPRESA_TASADORA						VARCHAR(30) = NULL,
	@psIND_POLIZA								VARCHAR(1) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.GARANTIAS_REALES (
					EMPRESA,
					ID_GARANTIA,
					COD_TIPO_BIEN,
					ID_BIEN,
					MONTO_ULTIMA_TASACION_TERRENO,
					MONTO_ULTIMA_TASACION_NO_TERRENO,
					FECHA_ULTIMA_TASACION_GARANTIA,
					MONTO_TASACION_ACTUALIZADA_TERRENO,
					MONTO_TASACION_ACTUALIZADA_NO_TERRENO,
					FECHA_ULTIMO_SEGUIMIENTO,
					FECHA_CONSTRUCCION,
					COD_TIPO_PERSONA_TASADOR,
					ID_TASADOR,
					COD_TIPO_PERSONA_EMPRESA_TASADORA,
					ID_EMPRESA_TASADORA,
					IND_POLIZA)
		SELECT 		@piEMPRESA,
					@psID_GARANTIA,
					@piCOD_TIPO_BIEN,
					@psID_BIEN,
					@pdMONTO_ULTIMA_TASACION_TERRENO,
					@pdMONTO_ULTIMA_TASACION_NO_TERRENO,
					@pdtFECHA_ULTIMA_TASACION_GARANTIA,
					@pdMONTO_TASACION_ACTUALIZADA_TERRENO,
					@pdMONTO_TASACION_ACTUALIZADA_NO_TERRENO,
					@pdtFECHA_ULTIMO_SEGUIMIENTO,
					@pdtFECHA_CONSTRUCCION,
					@piCOD_TIPO_PERSONA_TASADOR,
					@psID_TASADOR,
					@piCOD_TIPO_PERSONA_EMPRESA_TASADORA,
					@psID_EMPRESA_TASADORA,
					@psIND_POLIZA

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Reales_Poliza_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/*
Garantias_Reales_Poliza_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIAS_REALES_POLIZA
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Reales_Poliza_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
)

AS

DECLARE @TempItems TABLE 
(
        ID INT IDENTITY(0,1),
        ID_ROW INT
)

DECLARE @maxRow INT
 DECLARE @vsSQL VARCHAR(4000)

SET @vsSQL = ('SELECT ID_ROW
			  FROM dbo.GARANTIAS_REALES_POLIZA
			  WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ')

IF @filterColumn = 'MONTO_POLIZA' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))
	SET @vsSQL = @vsSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	SET @vsSQL = @vsSQL + ' UPPER(ISNULL('  + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''
END

SET @vsSQL = @vsSQL + ' ORDER BY ' + (CASE WHEN @sortColumn = '' THEN 'ID_GARANTIA' ELSE @sortColumn END)

--IF @filterColumn = 'MONTO_POLIZA'
--BEGIN
--	SET @filterColumn = ' format('+@filterColumn+',''N'','''+(SICAD_CONFIGURACION.dbo.Valor_Parametro(1))+''')'
--END

SET @maxRow = (@startRowIndex + @maximumRows)

SET ROWCOUNT @maxRow

INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL)
		 
SET ROWCOUNT @maximumRows

SELECT 
       GAR.ID_ROW,
       GAR.N_REGISTRO,
       GAR.EMPRESA,
       GAR.ID_GARANTIA,
       GAR.COD_TIPO_POLIZA,
       GAR.MONTO_POLIZA,
       GAR.FECHA_VENCIMIENTO,
       GAR.IND_COBERTURA_POLIZA,
       GAR.COD_TIPO_PERSONA_BENEFICIARIO,
       GAR.ID_BENEFICIARIO,
	   TP.DES_TIPO_POLIZA
  FROM @TempItems TEMP
	INNER JOIN dbo.GARANTIAS_REALES_POLIZA GAR
		ON GAR.ID_ROW = TEMP.ID_ROW
	LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_POLIZA TP
		ON GAR.COD_TIPO_POLIZA = TP.COD_TIPO_POLIZA
            
 WHERE TEMP.ID >= @startRowIndex
			
SET ROWCOUNT 0




GO
/****** Object:  StoredProcedure [dbo].[Garantias_Reales_Poliza_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Reales_Poliza_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIAS_REALES_POLIZA
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Reales_Poliza_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT 
		   ID_ROW,
		   N_REGISTRO,
		   EMPRESA,
		   ID_GARANTIA,
		   COD_TIPO_POLIZA,
		   MONTO_POLIZA,
		   FECHA_VENCIMIENTO,
		   IND_COBERTURA_POLIZA,
		   COD_TIPO_PERSONA_BENEFICIARIO,
		   ID_BENEFICIARIO
	  FROM dbo.GARANTIAS_REALES_POLIZA
	 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Reales_Poliza_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Reales_Poliza_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIAS_REALES_POLIZA.
Sistema(s):SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Reales_Poliza_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.GARANTIAS_REALES_POLIZA
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND '

 IF @filterColumn = 'MONTO_POLIZA' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))

	SET @StrSQL = @StrSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')

	SET @StrSQL = @StrSQL + ' UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''
END

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Reales_Poliza_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Reales_Poliza_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIAS_REALES_POLIZA
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Reales_Poliza_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM	dbo.GARANTIAS_REALES_POLIZA
		WHERE	ID_ROW = @piID_ROW 
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Reales_Poliza_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Reales_Poliza_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIAS_REALES_POLIZA
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Garantias_Reales_Poliza_Inserta]
	@piEMPRESA						 INT = NULL,
	@psID_GARANTIA					 VARCHAR(25) = NULL,
	@piCOD_TIPO_POLIZA				 INT = NULL,
	@pdMONTO_POLIZA					 DECIMAL(25,2) = NULL,
	@pdtFECHA_VENCIMIENTO			 DATE = NULL,
	@psIND_COBERTURA_POLIZA			 VARCHAR(1) = NULL,
	@piCOD_TIPO_PERSONA_BENEFICIARIO INT = NULL,
	@psID_BENEFICIARIO				 VARCHAR(30) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO GARANTIAS_REALES_POLIZA (
					EMPRESA,
					ID_GARANTIA,
					COD_TIPO_POLIZA,
					MONTO_POLIZA,
					FECHA_VENCIMIENTO,
					IND_COBERTURA_POLIZA,
					COD_TIPO_PERSONA_BENEFICIARIO,
					ID_BENEFICIARIO)

		SELECT		@piEMPRESA,
					@psID_GARANTIA,
					@piCOD_TIPO_POLIZA,
					@pdMONTO_POLIZA,
					@pdtFECHA_VENCIMIENTO,
					@psIND_COBERTURA_POLIZA,
					@piCOD_TIPO_PERSONA_BENEFICIARIO,
					@psID_BENEFICIARIO
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Valores_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Valores_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla GARANTIAS_VALORES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Valores_Actualiza]
	@piID_ROW							INT = NULL,
	@piCOD_CLASIFICACION_INSTRUMENTO	INT = NULL,
	@piCOD_TIPO_PERSONA					INT = NULL,
	@psID_EMISOR						VARCHAR(30) = NULL,
	@psID_INSTRUMENTO					VARCHAR(25) = NULL,
	@psSERIE_INSTRUMENTO				VARCHAR(20) = NULL,
	@pdPREMIO							DECIMAL(7, 2) = NULL,
	@pdCODISIN							VARCHAR(25) = NULL,
	@piCOD_TIPO_ASIGNACION_CALIFICACION INT = NULL,
	@piCOD_CATEGORIA_CALIFICACION		INT = NULL,
	@psCOD_CALIFICACION_RIESGO			VARCHAR(30) = NULL,
	@piCOD_EMPRESA_CALIFICADORA			INT = NULL,
	@pdVALOR_FACIAL						DECIMAL(25,2) = NULL,
	@piCOD_TIPO_MONEDA_VALOR_FACIAL		INT = NULL,
	@pdVALOR_MERCADO					DECIMAL(25,2) = NULL,
	@piCOD_TIPO_MONEDA_VALOR_MERCADO	INT = NULL,
	@pdtFECHA_CONSTITUCION				DATE = NULL,
	@pdtFECHA_VENCIMIENTO				DATE = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.GARANTIAS_VALORES
		SET	    COD_CLASIFICACION_INSTRUMENTO	 = @piCOD_CLASIFICACION_INSTRUMENTO,
				COD_TIPO_PERSONA				 = @piCOD_TIPO_PERSONA,
				ID_EMISOR						 = @psID_EMISOR,
				ID_INSTRUMENTO					 = @psID_INSTRUMENTO,
				SERIE_INSTRUMENTO				 = @psSERIE_INSTRUMENTO,
				PREMIO							 = @pdPREMIO,
				CODISIN							 = @pdCODISIN,
				COD_TIPO_ASIGNACION_CALIFICACION = @piCOD_TIPO_ASIGNACION_CALIFICACION,
				COD_CATEGORIA_CALIFICACION		 = @piCOD_CATEGORIA_CALIFICACION,
				COD_CALIFICACION_RIESGO			 = @psCOD_CALIFICACION_RIESGO,
				COD_EMPRESA_CALIFICADORA		 = @piCOD_EMPRESA_CALIFICADORA,
				VALOR_FACIAL					 = @pdVALOR_FACIAL,
				COD_TIPO_MONEDA_VALOR_FACIAL	 = @piCOD_TIPO_MONEDA_VALOR_FACIAL,
				VALOR_MERCADO					 = @pdVALOR_MERCADO,
				COD_TIPO_MONEDA_VALOR_MERCADO	 = @piCOD_TIPO_MONEDA_VALOR_MERCADO,
				FECHA_CONSTITUCION				 = @pdtFECHA_CONSTITUCION,
				FECHA_VENCIMIENTO				 = @pdtFECHA_VENCIMIENTO
		WHERE	ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Valores_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/*
Garantias_Valores_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla GARANTIAS_VALORES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Valores_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   ID INT IDENTITY(0,1),
    ID_ROW INT
)

 DECLARE @maxRow INT
 DECLARE @vsSQL VARCHAR(4000)

SET @vsSQL = ('	SELECT ID_ROW FROM dbo.GARANTIAS_VALORES
				WHERE EMPRESA = ' +CONVERT(VARCHAR,@filtroEmpresa) + ' AND ')

IF @filterColumn = 'VALOR_FACIAL' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))
	SET @vsSQL = @vsSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	SET @vsSQL = @vsSQL + ' UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''
END

SET @vsSQL = @vsSQL + ' ORDER BY ' +  CASE WHEN @sortColumn = '' THEN 'ID_GARANTIA' ELSE @sortColumn END

--IF @filterColumn = 'VALOR_FACIAL'
--BEGIN
--	SET @filterColumn = ' format('+@filterColumn+',''N'','''+(SICAD_CONFIGURACION.dbo.Valor_Parametro(1))+''')'
--END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL)
SET ROWCOUNT @maximumRows
	SELECT 
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA,
		E.ID_GARANTIA,
		E.COD_CLASIFICACION_INSTRUMENTO,
		E.COD_TIPO_PERSONA,
		E.ID_EMISOR,
		E.ID_INSTRUMENTO,
		E.SERIE_INSTRUMENTO,
		E.PREMIO,
		E.CODISIN,
		E.COD_TIPO_ASIGNACION_CALIFICACION,
		E.COD_CATEGORIA_CALIFICACION,
		E.COD_CALIFICACION_RIESGO,
		E.COD_EMPRESA_CALIFICADORA,
		E.VALOR_FACIAL,
		E.COD_TIPO_MONEDA_VALOR_FACIAL,
		E.VALOR_MERCADO,
		E.COD_TIPO_MONEDA_VALOR_MERCADO,
		E.FECHA_CONSTITUCION,
		E.FECHA_VENCIMIENTO
	FROM @TempItems T 
        INNER JOIN dbo.GARANTIAS_VALORES E 
	     ON E.ID_ROW = T.ID_ROW 
				
	WHERE ID >= @startRowIndex		

SET ROWCOUNT 0




GO
/****** Object:  StoredProcedure [dbo].[Garantias_Valores_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Valores_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla GARANTIAS_VALORES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Valores_Consulta_Detalle]
        @piID_ROW INT
AS
	SELECT 
		@piID_ROW,
		N_REGISTRO,
		EMPRESA,
		ID_GARANTIA,
		COD_CLASIFICACION_INSTRUMENTO,
		COD_TIPO_PERSONA,
		ID_EMISOR,
		ID_INSTRUMENTO,
		SERIE_INSTRUMENTO,
		PREMIO,
		CODISIN,
		COD_TIPO_ASIGNACION_CALIFICACION,
		COD_CATEGORIA_CALIFICACION,
		COD_CALIFICACION_RIESGO,
		COD_EMPRESA_CALIFICADORA,
		VALOR_FACIAL,
		COD_TIPO_MONEDA_VALOR_FACIAL,
		VALOR_MERCADO,
		COD_TIPO_MONEDA_VALOR_MERCADO,
		FECHA_CONSTITUCION,
		FECHA_VENCIMIENTO
	FROM dbo.GARANTIAS_VALORES
	WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Valores_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Valores_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla GARANTIAS_VALORES.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Valores_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.GARANTIAS_VALORES
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ' 

 IF @filterColumn = 'VALOR_FACIAL' AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))

	SET @StrSQL = @StrSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')

	SET @StrSQL = @StrSQL + ' UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''
END
print @StrSQL
EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount





GO
/****** Object:  StoredProcedure [dbo].[Garantias_Valores_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Valores_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla GARANTIAS_VALORES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Valores_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM dbo.GARANTIAS_VALORES
		WHERE ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Garantias_Valores_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Garantias_Valores_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla GARANTIAS_VALORES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Garantias_Valores_Inserta]	
	@piEMPRESA							INT = NULL,
	@psID_GARANTIA						VARCHAR(25) = NULL,
	@piCOD_CLASIFICACION_INSTRUMENTO	INT = NULL,
	@piCOD_TIPO_PERSONA					INT = NULL,
	@psID_EMISOR						VARCHAR(30) = NULL,
	@psID_INSTRUMENTO					VARCHAR(25) = NULL,
	@psSERIE_INSTRUMENTO				VARCHAR(20) = NULL,
	@pdPREMIO							DECIMAL(7, 2) = NULL,
	@psCODISIN							VARCHAR(25) = NULL,
	@piCOD_TIPO_ASIGNACION_CALIFICACION INT = NULL,
	@piCOD_CATEGORIA_CALIFICACION		INT = NULL,
	@psCOD_CALIFICACION_RIESGO			VARCHAR(30) = NULL,
	@piCOD_EMPRESA_CALIFICADORA			INT = NULL,
	@pdVALOR_FACIAL						DECIMAL(25,2) = NULL,
	@piCOD_TIPO_MONEDA_VALOR_FACIAL		INT = NULL,
	@pdVALOR_MERCADO					DECIMAL(25,2) = NULL,
	@piCOD_TIPO_MONEDA_VALOR_MERCADO	INT = NULL,
	@pdtFECHA_CONSTITUCION				DATE = NULL,
	@pdtFECHA_VENCIMIENTO				DATE = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.GARANTIAS_VALORES (
					EMPRESA,
					ID_GARANTIA,
					COD_CLASIFICACION_INSTRUMENTO,
					COD_TIPO_PERSONA,
					ID_EMISOR,
					ID_INSTRUMENTO,
					SERIE_INSTRUMENTO,
					PREMIO,
					CODISIN,
					COD_TIPO_ASIGNACION_CALIFICACION,
					COD_CATEGORIA_CALIFICACION,
					COD_CALIFICACION_RIESGO,
					COD_EMPRESA_CALIFICADORA,
					VALOR_FACIAL,
					COD_TIPO_MONEDA_VALOR_FACIAL,
					VALOR_MERCADO,
					COD_TIPO_MONEDA_VALOR_MERCADO,
					FECHA_CONSTITUCION,
					FECHA_VENCIMIENTO)
		SELECT 
					@piEMPRESA,
					@psID_GARANTIA,
					@piCOD_CLASIFICACION_INSTRUMENTO,
					@piCOD_TIPO_PERSONA,
					@psID_EMISOR,
					@psID_INSTRUMENTO,
					@psSERIE_INSTRUMENTO,
					@pdPREMIO,
					@psCODISIN,
					@piCOD_TIPO_ASIGNACION_CALIFICACION,
					@piCOD_CATEGORIA_CALIFICACION,
					@psCOD_CALIFICACION_RIESGO,
					@piCOD_EMPRESA_CALIFICADORA,
					@pdVALOR_FACIAL,
					@piCOD_TIPO_MONEDA_VALOR_FACIAL,
					@pdVALOR_MERCADO,
					@piCOD_TIPO_MONEDA_VALOR_MERCADO,
					@pdtFECHA_CONSTITUCION,
					@pdtFECHA_VENCIMIENTO	
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Indicador_Garantia_No_Aplica]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Indicador_Garantia_No_Aplica]
	
AS
BEGIN
	SELECT 0 AS COD_INDICADOR, '0 - La garanta reportada en perodos anteriores
								ya no es mitigadora o no existe y el crdito dej
								de tener Garanta' AS DES_INDICADOR
	UNION 
	SELECT 1 AS COD_INDICADOR, '1- El crdito si tiene garanta, independientemente
								de si esa garanta fue reportada en algun perodo 
								anterior o la garanta es nueva' AS DES_INDICADOR
END




GO
/****** Object:  StoredProcedure [dbo].[Indicador_Genero_Persona]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[Indicador_Genero_Persona]
AS 
BEGIN
SELECT	1 COD_GENERO , 
		'F' DES_GENERO
UNION
SELECT	2 COD_GENERO , 
		'M' DES_GENERO
END

GO
/****** Object:  StoredProcedure [dbo].[Indicador_S_N]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Indicador_S_N]
	
AS
BEGIN
	SELECT 'S' AS COD_INDICADOR, 'S' AS DES_INDICADOR
	UNION 
	SELECT 'N' AS COD_INDICADOR, 'N' AS DES_INDICADOR
END





GO
/****** Object:  StoredProcedure [dbo].[Indicador_Si_No]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Indicador_Si_No]
	
AS
BEGIN
	SELECT 'S' AS COD_INDICADOR, 'S' AS DES_INDICADOR
	UNION 
	SELECT 'N' AS COD_INDICADOR, 'No' AS DES_INDICADOR
END




GO
/****** Object:  StoredProcedure [dbo].[Indicador_Si_No_Valor_Numero_Lista]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[Indicador_Si_No_Valor_Numero_Lista]
AS
BEGIN
select 1 COD_INDICADOR , 'S' DES_INDICADOR
UNION
SELECT 2 COD_INDICADOR, 'N' DES_INDICADOR
END


GO
/****** Object:  StoredProcedure [dbo].[Indicador_Vinculado_Entidad]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Indicador_Vinculado_Entidad]
	
AS
BEGIN
	SELECT 'V' AS COD_INDICADOR, 'V' AS DES_INDICADOR
	UNION 
	SELECT 'N' AS COD_INDICADOR, 'N' AS DES_INDICADOR
END




GO
/****** Object:  StoredProcedure [dbo].[Indicador_Vinculado_Grupo_Financiero]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[Indicador_Vinculado_Grupo_Financiero]
	
AS
BEGIN
	SELECT 'V' AS COD_INDICADOR, 'V' AS DES_INDICADOR
	UNION 
	SELECT 'N' AS COD_INDICADOR, 'N' AS DES_INDICADOR
	UNION
	SELECT 'F' AS COD_INDICADOR, 'F' AS DES_INDICADOR
END




GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Actividad_Economica_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Actividad_Economica_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro en la tabla OPERACIONES_ACTIVIDAD_ECONOMICA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Actividad_Economica_Actualiza]
	@piID_ROW INT = NULL,
	@piPCJ_ACTIVIDAD_ECONOMICA INT = NULL,
	@psCOD_ACTIVIDAD_ECONOMICA_FUENTE VARCHAR(14) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.OPERACIONES_ACTIVIDAD_ECONOMICA
		SET 	PCJ_ACTIVIDAD_ECONOMICA = @piPCJ_ACTIVIDAD_ECONOMICA,
				COD_ACTIVIDAD_ECONOMICA_FUENTE = @psCOD_ACTIVIDAD_ECONOMICA_FUENTE
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Actividad_Economica_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Actividad_Economica_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo de la tabla OPERACIONES_ACTIVIDAD_ECONOMICA, 
			 tomando en cuenta el ordenamiento, paginacin y filtros.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Actividad_Economica_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(       ID INT IDENTITY(0,1),
	ID_ROW INT
)
 DECLARE @maxRow INT
 SET @filterValue = '%' + @filterValue + '%'

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION, COD_ACTIVIDAD_ECONOMICA' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT ID_ROW FROM dbo.OPERACIONES_ACTIVIDAD_ECONOMICA
WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
ORDER BY ' + @sortColumn)
SET ROWCOUNT @maximumRows
	SELECT 
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA, 
		E.ID_OPERACION, 
		E.COD_ACTIVIDAD_ECONOMICA,
		E.COD_ACTIVIDAD_ECONOMICA_FUENTE,
		E.PCJ_ACTIVIDAD_ECONOMICA,
		E.COD_SISTEMA,
		TAE.DES_TIPO_ACTIVIDAD_ECONOMICA
	FROM @TempItems T 
	INNER JOIN dbo.OPERACIONES_ACTIVIDAD_ECONOMICA E 
			ON E.ID_ROW = T.ID_ROW
	LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_ACTIVIDAD_ECONOMICA TAE
			ON E.COD_ACTIVIDAD_ECONOMICA = TAE.COD_TIPO_ACTIVIDAD_ECONOMICA_ANTES
	WHERE ID >= @startRowIndex

SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Actividad_Economica_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Actividad_Economica_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla OPERACIONES_ACTIVIDAD_ECONOMICA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Actividad_Economica_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT  ID_ROW,
			N_REGISTRO,
			EMPRESA, 
			ID_OPERACION, 
			COD_ACTIVIDAD_ECONOMICA,
			COD_ACTIVIDAD_ECONOMICA_FUENTE,
			PCJ_ACTIVIDAD_ECONOMICA,
			COD_SISTEMA
	FROM	dbo.OPERACIONES_ACTIVIDAD_ECONOMICA
	WHERE	ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Actividad_Economica_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Actividad_Economica_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla OPERACIONES_ACTIVIDAD_ECONOMICA.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Actividad_Economica_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.OPERACIONES_ACTIVIDAD_ECONOMICA
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ',''''))  LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Actividad_Economica_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Actividad_Economica_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla OPERACIONES_ACTIVIDAD_ECONOMICA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Actividad_Economica_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM dbo.OPERACIONES_ACTIVIDAD_ECONOMICA
		WHERE ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Actividad_Economica_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Actividad_Economica_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla OPERACIONES_ACTIVIDAD_ECONOMICA
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Actividad_Economica_Inserta]
	@piEMPRESA INT = NULL,	
	@psID_OPERACION VARCHAR(25) = NULL, 
	@psCOD_ACTIVIDAD_ECONOMICA VARCHAR(14) = NULL,
	@psCOD_ACTIVIDAD_ECONOMICA_FUENTE VARCHAR(14) = NULL,
	@piPCJ_ACTIVIDAD_ECONOMICA INT = NULL,
	@piCOD_SISTEMA INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.OPERACIONES_ACTIVIDAD_ECONOMICA 
			(EMPRESA,
			ID_OPERACION,
			COD_ACTIVIDAD_ECONOMICA,
			COD_ACTIVIDAD_ECONOMICA_FUENTE,
			PCJ_ACTIVIDAD_ECONOMICA,
			COD_SISTEMA)
		SELECT 
			@piEMPRESA,
			@psID_OPERACION,
			@psCOD_ACTIVIDAD_ECONOMICA,
			@psCOD_ACTIVIDAD_ECONOMICA_FUENTE,
			@piPCJ_ACTIVIDAD_ECONOMICA,
			@piCOD_SISTEMA
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro en la tabla OPERACIONES
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Actualiza]
        @piID_ROW															INT= NULL,
        @piCOD_TIPO_PERSONA_DEUDOR											INT= NULL,
        @pdID_DEUDOR														VARCHAR(30)= NULL,
        @pdID_LINEA															VARCHAR(25) = NULL,
        @piCOD_TIPO_OPERACION												INT= NULL,
        @piCOD_TIPO_CATALOGO_SUGEF											INT= NULL,
        @pdCOD_PAIS_DESTINO_CREDITO											VARCHAR(4) = NULL,
        @piCOD_PROVINCIA_DESTINO_CREDITO									INT = NULL,
        @piCOD_CANTON_DESTINO_CREDITO										INT = NULL,
        @piCOD_PROVINCIA_DEPENDENCIA_CREDITO								INT = NULL,
        @piCOD_CANTON_DEPENDENCIA_CREDITO									INT = NULL,
        @piCOD_TIPO_CARTERA													INT= NULL,
        @piCOD_TIPO_ESTADO_OPERACION										INT = NULL,
        @piCOD_TIPO_MONEDA_MONTO											INT= NULL,
        @pdMONTO_OPERACION_AUTORIZADO										DECIMAL(25, 2)= NULL,
        @piCUENTA_CONTABLE_PRINCIPAL_SUGEF									BIGINT = NULL,
        @pdSALDO_PRINCIPAL													DECIMAL(25, 2)= NULL,
        @piCUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_SUGEF					BIGINT = NULL,
        @pdSALDO_PRINCIPAL_DEPOSITO_PREVIO									DECIMAL(25, 2)= NULL,
        @piCUENTA_CONTABLE_PRODUCTO_SUGEF									BIGINT = NULL,
        @pdSALDO_PRODUCTO													DECIMAL(25, 2)= NULL,
		@pdMONTO_ESTIMACION_ESTRUCTURAL										DECIMAL(25, 2)=NULL,
        @piCUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_SUGEF						BIGINT = NULL,
        @pdSALDO_DESEMBOLSAR_COMPROMISO										DECIMAL(25, 2)= NULL,
        @piCUENTA_CONTABLE_COMISIONES_SUGEF									BIGINT = NULL,
        @pdSALDO_COMISIONES													DECIMAL(25, 2)= NULL,
        @piCUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_SUGEF BIGINT = NULL,
        @pdSALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO						DECIMAL(25, 2)=NULL,
        @pdMONTO_DESEMBOLSADO												DECIMAL(25, 2)= NULL,
        @pdtFECHA_FORMALIZACION												DATE= NULL,
        @pdtFECHA_VENCIMIENTO												DATE= NULL,
        @piFRECUENCIA_PAGO_ACTUAL_PRINCIPAL									INT = NULL,
        @piFRECUENCIA_PAGO_ACTUAL_INTERESES									INT = NULL,
        @pdtFECHA_VENCIMIENTO_PERIODO_GRACIA_PRINCIPAL						DATE = NULL,
        @pdCOD_TASA_INTERES_NOMINAL_VIGENTE									DECIMAL(7, 2) = NULL,
        @psCOD_TIPO_TASA													VARCHAR(2) = NULL,
        @psFACTOR_TIEMPO													VARCHAR(1) = NULL,
        @psCOD_FORMA_PAGO_VIGENTE_PRINCIPAL									VARCHAR(1) = NULL,
        @psCOD_FORMA_PAGO_VIGENTE_INTERESES									VARCHAR(1) = NULL,
        @pdtFECHA_CORTE_OPERACION											DATE = NULL,
        @pdtFECHA_PROXIMO_PAGO_PRINCIPAL									DATE = NULL,
        @pdtFECHA_PROXIMO_PAGO_INTERESES									DATE = NULL,
        @pdtFECHA_AMORTIZACION_HASTA										DATE = NULL,
        @pdtFECHA_INTERESES_HASTA											DATE = NULL,
        @pdtFECHA_PAGO_PACTADO_PRINCIPAL									DATE = NULL,
        @pdtFECHA_PAGO_PACTADO_INTERESES									DATE = NULL,
        @piPLAZO_OPERACION													INT,
        @piCOD_TIPO_CUOTA_PRINCIPAL											INT = NULL,
        @pdMONTO_CUOTA_PRINCIPAL_ACTUAL										DECIMAL(25, 2) = NULL,
        @pdMONTO_CUOTA_INTERESES_ACTUAL										DECIMAL(25, 2) = NULL,
        @psIND_OPERACION_NUEVA												VARCHAR(3)= NULL,
        @pdRECUPERACION_PRINCIPAL											DECIMAL(25, 2)= NULL,
        @pdOTROS_AUMENTOS_PRINCIPAL											DECIMAL(25, 2)= NULL,
        @pdOTRAS_DISMINUCIONES_PRINCIPAL									DECIMAL(25, 2)= NULL,
		@psIND_BACK_TO_BACK													VARCHAR(1)= NULL,
        @psIND_CREDITO_SINDICADO											VARCHAR(1)= NULL,
        @psIND_OPERACION_ESPECIAL											VARCHAR(2)= NULL,
        @pdPCJ_RESPONSABILIDAD_LINEA										DECIMAL(7, 2) =	NULL,
        @piCLAUSULA_LIMITE_CREDITO											INT=NULL,
        @psCOD_OFICINA														VARCHAR(5) = NULL,
        @psCOD_PRODUCTO														VARCHAR(5) = NULL,
        @piCUENTA_CONTABLE_PRINCIPAL_ENTIDAD								BIGINT = NULL,
        @piCUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_ENTIDAD				BIGINT = NULL,
        @piCUENTA_CONTABLE_PRODUCTOS_ENTIDAD								BIGINT = NULL,
        @piCUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_ENTIDAD					BIGINT = NULL,
        @piCUENTA_CONTABLE_COMISIONES_ENTIDAD								BIGINT = NULL,
        @piCUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_ENTIDAD BIGINT = NULL,
        @piATRASO_CAPITAL													INT = NULL,
        @piATRASO_INTERES													INT = NULL,
		@pdtFECHA_CAMBIO_TIPO_TASA											DATE=NULL,
		@piFRECUENCIA_AJUSTE_TASA_INTERES_VARIABLE							INT =NULL,
		@piPARAMETRO_REFERENCIA_TASA_INTERES_VARIABLE						INT = NULL,
		@pdCOMPONENTE_VARIABLE_TASA_INTERES_VARIABLE						DECIMAL(5, 2)=NULL,
		@pdCOMPONENTE_FIJO_TASA_INTERES_VARIABLE							DECIMAL(5, 2)=NULL,
		@pdLIMITE_INFERIOR_TASA_INTERES_VARIABLE							DECIMAL(5, 2)=NULL,
		@pdLIMITE_SUPERIOR_TASA_INTERES_VARIABLE							DECIMAL(5, 2)=NULL,
		@pdMONTO_ESTIMACION_GENERICA_DIRECTA								DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_GENERICA_CONTINGENTE							DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_CUBIERTA				DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_DESCUBIERTA			DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_CUBIERTA			DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_DESCUBIERTA		DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_CONTRA_CICLICA_DIRECTA							DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_CONTRA_CICLICA_CONTINGENTE						DECIMAL(25, 2)=NULL,
		@piTIPO_SOBREGIRO													INT = NULL,
		@pdMONTO_INTERES_HASTA_180											DECIMAL(25,2) = NULL,
		@piCANTIDAD_DIAS_HASTA_180											INT = NULL,
		@piCANTIDAD_DIAS_MAS_180											INT = NULL,	
		@pdMONTO_INTERES_ADELANTADO											DECIMAL(25,2)=NULL,
		@piCANTIDAD_DIAS_ADELANTADO											INT = NULL,	
		@piFRECUENCIA_PAGO_ACTUAL_PRINCIPAL_FUENTE							INT = NULL,
		@piFRECUENCIA_PAGO_ACTUAL_INTERESES_FUENTE							INT = NULL

AS
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE dbo.OPERACIONES
		   SET COD_TIPO_PERSONA_DEUDOR												= @piCOD_TIPO_PERSONA_DEUDOR,
			   ID_DEUDOR															= @pdID_DEUDOR,
			   ID_LINEA																= @pdID_LINEA,
			   COD_TIPO_OPERACION													= @piCOD_TIPO_OPERACION,
			   COD_TIPO_CATALOGO_SUGEF												= @piCOD_TIPO_CATALOGO_SUGEF,
			   COD_PAIS_DESTINO_CREDITO												= @pdCOD_PAIS_DESTINO_CREDITO,
			   COD_PROVINCIA_DESTINO_CREDITO										= @piCOD_PROVINCIA_DESTINO_CREDITO,
			   COD_CANTON_DESTINO_CREDITO											= @piCOD_CANTON_DESTINO_CREDITO,
			   COD_PROVINCIA_DEPENDENCIA_CREDITO									= @piCOD_PROVINCIA_DEPENDENCIA_CREDITO,
			   COD_CANTON_DEPENDENCIA_CREDITO										= @piCOD_CANTON_DEPENDENCIA_CREDITO,
			   COD_TIPO_CARTERA														= @piCOD_TIPO_CARTERA,
			   COD_TIPO_ESTADO_OPERACION											= @piCOD_TIPO_ESTADO_OPERACION,
			   COD_TIPO_MONEDA_MONTO												= @piCOD_TIPO_MONEDA_MONTO,
			   MONTO_OPERACION_AUTORIZADO											= @pdMONTO_OPERACION_AUTORIZADO,
			   CUENTA_CONTABLE_PRINCIPAL_SUGEF										= @piCUENTA_CONTABLE_PRINCIPAL_SUGEF,
			   SALDO_PRINCIPAL														= @pdSALDO_PRINCIPAL,
			   CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_SUGEF						= @piCUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_SUGEF,
			   SALDO_PRINCIPAL_DEPOSITO_PREVIO										= @pdSALDO_PRINCIPAL_DEPOSITO_PREVIO,
			   CUENTA_CONTABLE_PRODUCTO_SUGEF										= @piCUENTA_CONTABLE_PRODUCTO_SUGEF,
			   SALDO_PRODUCTO														= @pdSALDO_PRODUCTO,
			   MONTO_ESTIMACION_ESTRUCTURAL											= @pdMONTO_ESTIMACION_ESTRUCTURAL,
			   CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_SUGEF							= @piCUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_SUGEF,
			   SALDO_DESEMBOLSAR_COMPROMISO											= @pdSALDO_DESEMBOLSAR_COMPROMISO,
			   CUENTA_CONTABLE_COMISIONES_SUGEF										= @piCUENTA_CONTABLE_COMISIONES_SUGEF,
			   SALDO_COMISIONES														= @pdSALDO_COMISIONES,
			   CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_SUGEF		= @piCUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_SUGEF,
			   SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO							= @pdSALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO,
			   MONTO_DESEMBOLSADO													= @pdMONTO_DESEMBOLSADO,
			   FECHA_FORMALIZACION													= @pdtFECHA_FORMALIZACION,
			   FECHA_VENCIMIENTO													= @pdtFECHA_VENCIMIENTO,
			   FRECUENCIA_PAGO_ACTUAL_PRINCIPAL										= @piFRECUENCIA_PAGO_ACTUAL_PRINCIPAL,
			   FRECUENCIA_PAGO_ACTUAL_INTERESES										= @piFRECUENCIA_PAGO_ACTUAL_INTERESES,
			   FECHA_VENCIMIENTO_PERIODO_GRACIA_PRINCIPAL							= @pdtFECHA_VENCIMIENTO_PERIODO_GRACIA_PRINCIPAL,
			   COD_TASA_INTERES_NOMINAL_VIGENTE										= @pdCOD_TASA_INTERES_NOMINAL_VIGENTE,
			   COD_TIPO_TASA														= @psCOD_TIPO_TASA,
			   FACTOR_TIEMPO														= @psFACTOR_TIEMPO,
			   COD_FORMA_PAGO_VIGENTE_PRINCIPAL										= @psCOD_FORMA_PAGO_VIGENTE_PRINCIPAL,
			   COD_FORMA_PAGO_VIGENTE_INTERESES										= @psCOD_FORMA_PAGO_VIGENTE_INTERESES,
			   FECHA_CORTE_OPERACION												= @pdtFECHA_CORTE_OPERACION,
			   FECHA_PROXIMO_PAGO_PRINCIPAL											= @pdtFECHA_PROXIMO_PAGO_PRINCIPAL,
			   FECHA_PROXIMO_PAGO_INTERESES											= @pdtFECHA_PROXIMO_PAGO_INTERESES,
			   FECHA_AMORTIZACION_HASTA												= @pdtFECHA_AMORTIZACION_HASTA,
			   FECHA_INTERESES_HASTA												= @pdtFECHA_INTERESES_HASTA,
			   FECHA_PAGO_PACTADO_PRINCIPAL											= @pdtFECHA_PAGO_PACTADO_PRINCIPAL,
			   FECHA_PAGO_PACTADO_INTERESES											= @pdtFECHA_PAGO_PACTADO_INTERESES,
			   PLAZO_OPERACION														= @piPLAZO_OPERACION,
			   COD_TIPO_CUOTA_PRINCIPAL												= @piCOD_TIPO_CUOTA_PRINCIPAL,
			   MONTO_CUOTA_PRINCIPAL_ACTUAL											= @pdMONTO_CUOTA_PRINCIPAL_ACTUAL,
			   MONTO_CUOTA_INTERESES_ACTUAL											= @pdMONTO_CUOTA_INTERESES_ACTUAL,
			   IND_OPERACION_NUEVA													= @psIND_OPERACION_NUEVA,
			   RECUPERACION_PRINCIPAL												= @pdRECUPERACION_PRINCIPAL,
			   OTROS_AUMENTOS_PRINCIPAL												= @pdOTROS_AUMENTOS_PRINCIPAL,
			   OTRAS_DISMINUCIONES_PRINCIPAL										= @pdOTRAS_DISMINUCIONES_PRINCIPAL,
			   IND_BACK_TO_BACK														= @psIND_BACK_TO_BACK,
			   IND_CREDITO_SINDICADO												= @psIND_CREDITO_SINDICADO,
			   IND_OPERACION_ESPECIAL												= @psIND_OPERACION_ESPECIAL,
			   PCJ_RESPONSABILIDAD_LINEA											= @pdPCJ_RESPONSABILIDAD_LINEA,
			   CLAUSULA_LIMITE_CREDITO												= @piCLAUSULA_LIMITE_CREDITO,
			   COD_OFICINA															= @psCOD_OFICINA,
			   COD_PRODUCTO															= @psCOD_PRODUCTO,
			   CUENTA_CONTABLE_PRINCIPAL_ENTIDAD									= @piCUENTA_CONTABLE_PRINCIPAL_ENTIDAD,
			   CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_ENTIDAD					= @piCUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_ENTIDAD,
			   CUENTA_CONTABLE_PRODUCTOS_ENTIDAD									= @piCUENTA_CONTABLE_PRODUCTOS_ENTIDAD,
			   CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_ENTIDAD						= @piCUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_ENTIDAD,
			   CUENTA_CONTABLE_COMISIONES_ENTIDAD									= @piCUENTA_CONTABLE_COMISIONES_ENTIDAD,
			   CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_ENTIDAD	= @piCUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_ENTIDAD,
			   ATRASO_CAPITAL														= @piATRASO_CAPITAL,
			   ATRASO_INTERES														= @piATRASO_INTERES,
			   FECHA_CAMBIO_TIPO_TASA												= @pdtFECHA_CAMBIO_TIPO_TASA,
			   FRECUENCIA_AJUSTE_TASA_INTERES_VARIABLE								= @piFRECUENCIA_AJUSTE_TASA_INTERES_VARIABLE,
			   PARAMETRO_REFERENCIA_TASA_INTERES_VARIABLE							= @piPARAMETRO_REFERENCIA_TASA_INTERES_VARIABLE,
			   COMPONENTE_VARIABLE_TASA_INTERES_VARIABLE							= @pdCOMPONENTE_VARIABLE_TASA_INTERES_VARIABLE,
			   COMPONENTE_FIJO_TASA_INTERES_VARIABLE								= @pdCOMPONENTE_FIJO_TASA_INTERES_VARIABLE,
			   LIMITE_INFERIOR_TASA_INTERES_VARIABLE								= @pdLIMITE_INFERIOR_TASA_INTERES_VARIABLE,
			   LIMITE_SUPERIOR_TASA_INTERES_VARIABLE								= @pdLIMITE_SUPERIOR_TASA_INTERES_VARIABLE,
			   MONTO_ESTIMACION_GENERICA_DIRECTA									= @pdMONTO_ESTIMACION_GENERICA_DIRECTA,
			   MONTO_ESTIMACION_GENERICA_CONTINGENTE								= @pdMONTO_ESTIMACION_GENERICA_CONTINGENTE,
			   MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_CUBIERTA					= @pdMONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_CUBIERTA,	
			   MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_DESCUBIERTA				= @pdMONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_DESCUBIERTA,
			   MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_CUBIERTA				= @pdMONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_CUBIERTA,
			   MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_DESCUBIERTA			= @pdMONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_DESCUBIERTA,
			   MONTO_ESTIMACION_CONTRA_CICLICA_DIRECTA								= @pdMONTO_ESTIMACION_CONTRA_CICLICA_DIRECTA,
			   MONTO_ESTIMACION_CONTRA_CICLICA_CONTINGENTE							= @pdMONTO_ESTIMACION_CONTRA_CICLICA_CONTINGENTE,
			   TIPO_SOBREGIRO														= @piTIPO_SOBREGIRO,
			   MONTO_INTERES_HASTA_180												= @pdMONTO_INTERES_HASTA_180,
			   CANTIDAD_DIAS_HASTA_180												= @piCANTIDAD_DIAS_HASTA_180,
			   CANTIDAD_DIAS_MAS_180												= @piCANTIDAD_DIAS_MAS_180,
			   MONTO_INTERES_ADELANTADO												= @pdMONTO_INTERES_ADELANTADO,
			   CANTIDAD_DIAS_ADELANTADO												= @piCANTIDAD_DIAS_ADELANTADO,
			   FRECUENCIA_PAGO_ACTUAL_PRINCIPAL_FUENTE								= @piFRECUENCIA_PAGO_ACTUAL_PRINCIPAL_FUENTE,
			   FRECUENCIA_PAGO_ACTUAL_INTERESES_FUENTE								= @piFRECUENCIA_PAGO_ACTUAL_INTERESES_FUENTE
	
		 WHERE ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Codeudores_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Codeudores_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo de la tabla OPERACIONES_CODEUDORES, tomando en cuenta el ordenamiento, paginacin y filtros.
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Codeudores_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
 
AS

DECLARE @TempItems TABLE
(
        ID INT IDENTITY(0,1),
        ID_ROW INT
)

DECLARE @maxRow INT
 
SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION, ID_CODEUDOR, COD_TIPO_PERSONA_CODEUDOR' ELSE @sortColumn END
SET @maxRow = (@startRowIndex + @maximumRows) 

SET ROWCOUNT @maxRow

IF LEN(@filterValue) = 0
	BEGIN
		INSERT INTO @TempItems (ID_ROW)
		EXECUTE('SELECT ID_ROW FROM dbo.OPERACIONES_CODEUDORES
		          WHERE EMPRESA = ' + @filtroEmpresa +' ORDER BY ' + @sortColumn)
	END
ELSE
	BEGIN
		SET @filterValue = '%' + @filterValue + '%'
		
		INSERT INTO @TempItems (ID_ROW)
		EXECUTE('SELECT ID_ROW FROM dbo.OPERACIONES_CODEUDORES
                          WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
                          ORDER BY ' + @sortColumn)
	END
	
SET ROWCOUNT @maximumRows

SELECT GAR.ID_ROW,
       GAR.N_REGISTRO,
       GAR.EMPRESA,
       GAR.ID_OPERACION,
       GAR.ID_CODEUDOR,
       GAR.COD_TIPO_PERSONA_CODEUDOR,       
       GAR.COD_SISTEMA,
	   TP.DES_TIPO_PERSONA
  FROM @TempItems TEMP
		INNER JOIN dbo.OPERACIONES_CODEUDORES GAR
			ON GAR.ID_ROW = TEMP.ID_ROW
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_PERSONA TP
			ON GAR.COD_TIPO_PERSONA_CODEUDOR = TP.COD_TIPO_PERSONA		
 WHERE TEMP.ID >= @startRowIndex

SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Codeudores_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Codeudores_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla OPERACIONES_CODEUDORES
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Codeudores_Consulta_Detalle]
        @piID_ROW INT
AS

SELECT 
       ID_ROW,
       N_REGISTRO,
       EMPRESA,
       ID_OPERACION,
       COD_TIPO_PERSONA_CODEUDOR,
       ID_CODEUDOR,
       COD_SISTEMA
  FROM dbo.OPERACIONES_CODEUDORES
 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Codeudores_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Codeudores_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla OPERACIO_CODEUDORES.
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Codeudores_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.OPERACIONES_CODEUDORES
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Codeudores_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Codeudores_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla OPERACIO_CODEUDORES
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Codeudores_Elimina]
       @piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
        DELETE 	 	
        FROM dbo.OPERACIONES_CODEUDORES
        WHERE ID_ROW = @piID_ROW
          
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Codeudores_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Codeudores_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla OPERACIO_CODEUDORES
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Codeudores_Inserta]
	@piEMPRESA INT = NULL,
	@psID_OPERACION VARCHAR(25) = NULL,
	@piCOD_TIPO_PERSONA_CODEUDOR INT = NULL,
	@psID_CODEUDOR VARCHAR(30) = NULL,
	@piCOD_SISTEMA INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.OPERACIONES_CODEUDORES (
				EMPRESA,
				ID_OPERACION,
				COD_TIPO_PERSONA_CODEUDOR,
				ID_CODEUDOR,
				COD_SISTEMA)

		SELECT @piEMPRESA,
			   @psID_OPERACION,
			   @piCOD_TIPO_PERSONA_CODEUDOR,
			   @psID_CODEUDOR,
			   @piCOD_SISTEMA
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo de la tabla OPERACIONES
             tomando en cuenta el ordenamiento, paginacin y filtros.
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @TempItems TABLE
(
        ID INT IDENTITY(0,1),
        ID_ROW INT
)

DECLARE @maxRow INT
SET @filterValue = '%' + @filterValue + '%'
SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow

INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT ID_ROW FROM dbo.OPERACIONES
          WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
          ORDER BY ' + @sortColumn)

SET ROWCOUNT @maximumRows

SELECT 
		GAR.ID_ROW,
		GAR.N_REGISTRO,
		GAR.EMPRESA,
		GAR.COD_TIPO_PERSONA_DEUDOR,
		GAR.ID_DEUDOR,
		GAR.ID_OPERACION,
		GAR.ID_LINEA,
		GAR.COD_TIPO_OPERACION,
		GAR.COD_TIPO_CATALOGO_SUGEF,
		GAR.COD_PAIS_DESTINO_CREDITO,
		GAR.COD_PROVINCIA_DESTINO_CREDITO,
		GAR.COD_CANTON_DESTINO_CREDITO,
		GAR.COD_PROVINCIA_DEPENDENCIA_CREDITO,
		GAR.COD_CANTON_DEPENDENCIA_CREDITO,
		GAR.COD_TIPO_CARTERA,
		GAR.COD_TIPO_ESTADO_OPERACION,
		GAR.COD_TIPO_MONEDA_MONTO,
		GAR.MONTO_OPERACION_AUTORIZADO,
		GAR.CUENTA_CONTABLE_PRINCIPAL_SUGEF,
		GAR.CUENTA_CONTABLE_PRINCIPAL_ENTIDAD,
		GAR.SALDO_PRINCIPAL,
		GAR.CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_SUGEF,
		GAR.CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_ENTIDAD,
		GAR.SALDO_PRINCIPAL_DEPOSITO_PREVIO,
		GAR.CUENTA_CONTABLE_PRODUCTO_SUGEF,
		GAR.CUENTA_CONTABLE_PRODUCTOS_ENTIDAD,
		GAR.SALDO_PRODUCTO,
		GAR.MONTO_ESTIMACION_ESTRUCTURAL,
		GAR.CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_SUGEF,
		GAR.CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_ENTIDAD,
		GAR.SALDO_DESEMBOLSAR_COMPROMISO,
		GAR.CUENTA_CONTABLE_COMISIONES_SUGEF,
		GAR.CUENTA_CONTABLE_COMISIONES_ENTIDAD,
		GAR.SALDO_COMISIONES,
		GAR.CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_SUGEF,
		GAR.CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_ENTIDAD,
		GAR.SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO,
		GAR.MONTO_DESEMBOLSADO,
		GAR.FECHA_FORMALIZACION,
		GAR.FECHA_VENCIMIENTO,
		GAR.FRECUENCIA_PAGO_ACTUAL_PRINCIPAL,
		GAR.FRECUENCIA_PAGO_ACTUAL_INTERESES,
		GAR.FECHA_VENCIMIENTO_PERIODO_GRACIA_PRINCIPAL,
		GAR.COD_TASA_INTERES_NOMINAL_VIGENTE,
		GAR.COD_TIPO_TASA,
		GAR.FACTOR_TIEMPO,
		GAR.COD_FORMA_PAGO_VIGENTE_PRINCIPAL,
		GAR.COD_FORMA_PAGO_VIGENTE_INTERESES,
		GAR.FECHA_CORTE_OPERACION,
		GAR.FECHA_PROXIMO_PAGO_PRINCIPAL,
		GAR.FECHA_PROXIMO_PAGO_INTERESES,
		GAR.FECHA_AMORTIZACION_HASTA,
		GAR.FECHA_INTERESES_HASTA,
		GAR.FECHA_PAGO_PACTADO_PRINCIPAL,
		GAR.FECHA_PAGO_PACTADO_INTERESES,
		GAR.PLAZO_OPERACION,
		GAR.COD_TIPO_CUOTA_PRINCIPAL,
		GAR.MONTO_CUOTA_PRINCIPAL_ACTUAL,
		GAR.MONTO_CUOTA_INTERESES_ACTUAL,
		GAR.IND_OPERACION_NUEVA,
		GAR.RECUPERACION_PRINCIPAL,
		GAR.OTROS_AUMENTOS_PRINCIPAL,
		GAR.OTRAS_DISMINUCIONES_PRINCIPAL,
		GAR.IND_BACK_TO_BACK,
		GAR.IND_CREDITO_SINDICADO,
		GAR.IND_OPERACION_ESPECIAL,
		GAR.PCJ_RESPONSABILIDAD_LINEA,
		GAR.CLAUSULA_LIMITE_CREDITO,
		GAR.COD_SISTEMA,
		GAR.COD_OFICINA,
		GAR.COD_PRODUCTO,
		GAR.ID_OPERACION_INTERNO,
		GAR.ATRASO_CAPITAL,
		GAR.ATRASO_INTERES,
		GAR.FECHA_CAMBIO_TIPO_TASA,
		GAR.FRECUENCIA_AJUSTE_TASA_INTERES_VARIABLE,
		GAR.PARAMETRO_REFERENCIA_TASA_INTERES_VARIABLE,
		GAR.COMPONENTE_VARIABLE_TASA_INTERES_VARIABLE,
		GAR.COMPONENTE_FIJO_TASA_INTERES_VARIABLE,
		GAR.LIMITE_INFERIOR_TASA_INTERES_VARIABLE,
		GAR.LIMITE_SUPERIOR_TASA_INTERES_VARIABLE,
		GAR.MONTO_ESTIMACION_GENERICA_DIRECTA,
		GAR.MONTO_ESTIMACION_GENERICA_CONTINGENTE,
		GAR.MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_CUBIERTA,
		GAR.MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_DESCUBIERTA,
		GAR.MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_CUBIERTA,
		GAR.MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_DESCUBIERTA,
		GAR.MONTO_ESTIMACION_CONTRA_CICLICA_DIRECTA,
		GAR.MONTO_ESTIMACION_CONTRA_CICLICA_CONTINGENTE,
		GAR.TIPO_SOBREGIRO,
		GAR.MONTO_INTERES_HASTA_180,
		GAR.CANTIDAD_DIAS_HASTA_180,
		GAR.CANTIDAD_DIAS_MAS_180,
		GAR.MONTO_INTERES_ADELANTADO,
		GAR.CANTIDAD_DIAS_ADELANTADO,
		GAR.FRECUENCIA_PAGO_ACTUAL_PRINCIPAL_FUENTE,
		GAR.FRECUENCIA_PAGO_ACTUAL_INTERESES_FUENTE,		
		TP.DES_TIPO_PERSONA,
		GAR.FECHA_PAGO_PACTADO_INTERESES

  FROM @TempItems TEMP
	INNER JOIN dbo.OPERACIONES GAR
		ON GAR.ID_ROW = TEMP.ID_ROW
	LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_PERSONA TP
		ON GAR.COD_TIPO_PERSONA_DEUDOR = TP.COD_TIPO_PERSONA
 WHERE TEMP.ID >= @startRowIndex
 
SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron 
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla OPERACIONES
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Consulta_Detalle]
	@piID_ROW INT
AS
SELECT 
		GAR.ID_ROW,
		GAR.N_REGISTRO,
		GAR.EMPRESA,
		GAR.COD_TIPO_PERSONA_DEUDOR,
		GAR.ID_DEUDOR,
		GAR.ID_OPERACION,
		GAR.ID_LINEA,
		GAR.COD_TIPO_OPERACION,
		GAR.COD_TIPO_CATALOGO_SUGEF,
		GAR.COD_PAIS_DESTINO_CREDITO,
		GAR.COD_PROVINCIA_DESTINO_CREDITO,
		GAR.COD_CANTON_DESTINO_CREDITO,
		GAR.COD_PROVINCIA_DEPENDENCIA_CREDITO,
		GAR.COD_CANTON_DEPENDENCIA_CREDITO,
		GAR.COD_TIPO_CARTERA,
		GAR.COD_TIPO_ESTADO_OPERACION,
		GAR.COD_TIPO_MONEDA_MONTO,
		GAR.MONTO_OPERACION_AUTORIZADO,
		GAR.CUENTA_CONTABLE_PRINCIPAL_SUGEF,
		GAR.CUENTA_CONTABLE_PRINCIPAL_ENTIDAD,
		GAR.SALDO_PRINCIPAL,
		GAR.CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_SUGEF,
		GAR.CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_ENTIDAD,
		GAR.SALDO_PRINCIPAL_DEPOSITO_PREVIO,
		GAR.CUENTA_CONTABLE_PRODUCTO_SUGEF,
		GAR.CUENTA_CONTABLE_PRODUCTOS_ENTIDAD,
		GAR.SALDO_PRODUCTO,
		GAR.MONTO_ESTIMACION_ESTRUCTURAL,
		GAR.CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_SUGEF,
		GAR.CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_ENTIDAD,
		GAR.SALDO_DESEMBOLSAR_COMPROMISO,
		GAR.CUENTA_CONTABLE_COMISIONES_SUGEF,
		GAR.CUENTA_CONTABLE_COMISIONES_ENTIDAD,
		GAR.SALDO_COMISIONES,
		GAR.CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_SUGEF,
		GAR.CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_ENTIDAD,
		GAR.SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO,
		GAR.MONTO_DESEMBOLSADO,
		GAR.FECHA_FORMALIZACION,
		GAR.FECHA_VENCIMIENTO,
		GAR.FRECUENCIA_PAGO_ACTUAL_PRINCIPAL,
		GAR.FRECUENCIA_PAGO_ACTUAL_INTERESES,
		GAR.FECHA_VENCIMIENTO_PERIODO_GRACIA_PRINCIPAL,
		GAR.COD_TASA_INTERES_NOMINAL_VIGENTE,
		GAR.COD_TIPO_TASA,
		GAR.FACTOR_TIEMPO,
		GAR.COD_FORMA_PAGO_VIGENTE_PRINCIPAL,
		GAR.COD_FORMA_PAGO_VIGENTE_INTERESES,
		GAR.FECHA_CORTE_OPERACION,
		GAR.FECHA_PROXIMO_PAGO_PRINCIPAL,
		GAR.FECHA_PROXIMO_PAGO_INTERESES,
		GAR.FECHA_AMORTIZACION_HASTA,
		GAR.FECHA_INTERESES_HASTA,
		GAR.FECHA_PAGO_PACTADO_PRINCIPAL,
		GAR.FECHA_PAGO_PACTADO_INTERESES,
		GAR.PLAZO_OPERACION,
		GAR.COD_TIPO_CUOTA_PRINCIPAL,
		GAR.MONTO_CUOTA_PRINCIPAL_ACTUAL,
		GAR.MONTO_CUOTA_INTERESES_ACTUAL,
		GAR.IND_OPERACION_NUEVA,
		GAR.RECUPERACION_PRINCIPAL,
		GAR.OTROS_AUMENTOS_PRINCIPAL,
		GAR.OTRAS_DISMINUCIONES_PRINCIPAL,
		GAR.IND_BACK_TO_BACK,
		GAR.IND_CREDITO_SINDICADO,
		GAR.IND_OPERACION_ESPECIAL,
		GAR.PCJ_RESPONSABILIDAD_LINEA,
		GAR.CLAUSULA_LIMITE_CREDITO,
		GAR.COD_SISTEMA,
		GAR.COD_OFICINA,
		GAR.COD_PRODUCTO,
		GAR.ID_OPERACION_INTERNO,
		GAR.ATRASO_CAPITAL,
		GAR.ATRASO_INTERES,
		GAR.FECHA_CAMBIO_TIPO_TASA,
		GAR.FRECUENCIA_AJUSTE_TASA_INTERES_VARIABLE,
		GAR.PARAMETRO_REFERENCIA_TASA_INTERES_VARIABLE,
		GAR.COMPONENTE_VARIABLE_TASA_INTERES_VARIABLE,
		GAR.COMPONENTE_FIJO_TASA_INTERES_VARIABLE,
		GAR.LIMITE_INFERIOR_TASA_INTERES_VARIABLE,
		GAR.LIMITE_SUPERIOR_TASA_INTERES_VARIABLE,
		GAR.MONTO_ESTIMACION_GENERICA_DIRECTA,
		GAR.MONTO_ESTIMACION_GENERICA_CONTINGENTE,
		GAR.MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_CUBIERTA,
		GAR.MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_DESCUBIERTA,
		GAR.MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_CUBIERTA,
		GAR.MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_DESCUBIERTA,
		GAR.MONTO_ESTIMACION_CONTRA_CICLICA_DIRECTA,
		GAR.MONTO_ESTIMACION_CONTRA_CICLICA_CONTINGENTE,
		GAR.TIPO_SOBREGIRO,
		GAR.MONTO_INTERES_HASTA_180,
		GAR.CANTIDAD_DIAS_HASTA_180,
		GAR.CANTIDAD_DIAS_MAS_180,
		GAR.MONTO_INTERES_ADELANTADO,
		GAR.CANTIDAD_DIAS_ADELANTADO,
		GAR.FRECUENCIA_PAGO_ACTUAL_PRINCIPAL_FUENTE,
		GAR.FRECUENCIA_PAGO_ACTUAL_INTERESES_FUENTE,
		GAR.FECHA_PAGO_PACTADO_INTERESES
FROM	dbo.OPERACIONES GAR
WHERE	ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla OPERACIONES.
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.OPERACIONES
                  WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ',''''))  LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Credito_Sindicado_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Credito_Sindicado_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo de la tabla OPERACIONES_CREDITO_SINDICADO, 
			 tomando en cuenta el ordenamiento, paginacin y filtros.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Credito_Sindicado_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   ID INT IDENTITY(0,1),
	EMPRESA INT,
	ID_OPERACION VARCHAR(25), 
	COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO INT,
	ID_ENTIDAD_CREDITO_SINDICADO VARCHAR(30),
	ID_OPERACION_ENTIDAD_CREDITO_SINDICADO VARCHAR(25)
)
 DECLARE @maxRow INT
 SET @filterValue = '%' + @filterValue + '%'

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION,
												COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO,
												ID_ENTIDAD_CREDITO_SINDICADO,
												ID_OPERACION_ENTIDAD_CREDITO_SINDICADO' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (EMPRESA, 
						ID_OPERACION,
						COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO,
						ID_ENTIDAD_CREDITO_SINDICADO,
						ID_OPERACION_ENTIDAD_CREDITO_SINDICADO)
EXECUTE('SELECT 
			EMPRESA,
			ID_OPERACION,
			COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO,
			ID_ENTIDAD_CREDITO_SINDICADO,
			ID_OPERACION_ENTIDAD_CREDITO_SINDICADO 
		FROM dbo.OPERACIONES_CREDITO_SINDICADO
WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
ORDER BY ' + @sortColumn)
SET ROWCOUNT @maximumRows
	SELECT 
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA,
		E.ID_OPERACION,
		E.COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO,
		E.ID_ENTIDAD_CREDITO_SINDICADO,
		E.ID_OPERACION_ENTIDAD_CREDITO_SINDICADO,
		E.COD_SISTEMA,
		TP.DES_TIPO_PERSONA
	FROM @TempItems T 
		INNER JOIN dbo.OPERACIONES_CREDITO_SINDICADO E 
			ON ISNULL(E.EMPRESA ,-1)= ISNULL(T.EMPRESA,-1)
				AND E.ID_OPERACION = T.ID_OPERACION
				AND ISNULL(E.COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO,-1) = ISNULL(T.COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO,-1)
				AND ISNULL(E.ID_ENTIDAD_CREDITO_SINDICADO,'-1') = ISNULL(T.ID_ENTIDAD_CREDITO_SINDICADO,'-1')
				AND ISNULL(E.ID_OPERACION_ENTIDAD_CREDITO_SINDICADO,'-1') = ISNULL(T.ID_OPERACION_ENTIDAD_CREDITO_SINDICADO,'-1')
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_PERSONA TP
			ON E.COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO = TP.COD_TIPO_PERSONA

	WHERE ID >= @startRowIndex

SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Credito_Sindicado_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Credito_Sindicado_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla OPERACIONES_CREDITO_SINDICADO
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Credito_Sindicado_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT 	ID_ROW,
			N_REGISTRO,
			EMPRESA,
			ID_OPERACION,
			COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO,
			ID_ENTIDAD_CREDITO_SINDICADO,
			ID_OPERACION_ENTIDAD_CREDITO_SINDICADO,
			COD_SISTEMA
	FROM	dbo.OPERACIONES_CREDITO_SINDICADO
	WHERE	ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Credito_Sindicado_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Credito_Sindicado_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla OPERACIONES_CREDITO_SINDICADO.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Credito_Sindicado_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.OPERACIONES_CREDITO_SINDICADO
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ',''''))  LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Credito_Sindicado_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Credito_Sindicado_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla OPERACIONES_CREDITO_SINDICADO
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Credito_Sindicado_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM	dbo.OPERACIONES_CREDITO_SINDICADO
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Credito_Sindicado_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Credito_Sindicado_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla OPERACIONES_CREDITO_SINDICADO
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Credito_Sindicado_Inserta]
	@piEMPRESA										INT = NULL,
	@psID_OPERACION									VARCHAR(25) = NULL, 
	@piCOD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO	INT = NULL,
	@psID_ENTIDAD_CREDITO_SINDICADO					VARCHAR(30) = NULL,
	@psID_OPERACION_ENTIDAD_CREDITO_SINDICADO		VARCHAR(25) = NULL,
	@piCOD_SISTEMA									INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.OPERACIONES_CREDITO_SINDICADO (
			EMPRESA,
			ID_OPERACION,
			COD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO,
			ID_ENTIDAD_CREDITO_SINDICADO,
			ID_OPERACION_ENTIDAD_CREDITO_SINDICADO,
			COD_SISTEMA)

		SELECT 
			@piEMPRESA,
			@psID_OPERACION,
			@piCOD_TIPO_PERSONA_ENTIDAD_CREDITO_SINDICADO,
			@psID_ENTIDAD_CREDITO_SINDICADO,
			@psID_OPERACION_ENTIDAD_CREDITO_SINDICADO,
			@piCOD_SISTEMA
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla OPERACIO
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Elimina]
	@piID_ROW INT
AS
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE
		FROM dbo.OPERACIONES
		WHERE ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH	




GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla OPERACIONES
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Inserta]
        @piEMPRESA															INT = NULL,
        @piCOD_TIPO_PERSONA_DEUDOR											INT = NULL,
        @pdID_DEUDOR														VARCHAR(30) = NULL,
		@psID_OPERACION														VARCHAR(25) = NULL,
        @pdID_LINEA															VARCHAR(25) = NULL,
        @piCOD_TIPO_OPERACION												INT = NULL,
        @piCOD_TIPO_CATALOGO_SUGEF											INT = NULL,
        @pdCOD_PAIS_DESTINO_CREDITO											VARCHAR(4) = NULL,
        @piCOD_PROVINCIA_DESTINO_CREDITO									INT = NULL,
        @piCOD_CANTON_DESTINO_CREDITO										INT = NULL,
        @piCOD_PROVINCIA_DEPENDENCIA_CREDITO								INT = NULL,
        @piCOD_CANTON_DEPENDENCIA_CREDITO									INT = NULL,
        @piCOD_TIPO_CARTERA													INT = NULL,
        @piCOD_TIPO_ESTADO_OPERACION										INT = NULL,
        @piCOD_TIPO_MONEDA_MONTO											INT = NULL,
        @pdMONTO_OPERACION_AUTORIZADO										DECIMAL(25, 2),
        @piCUENTA_CONTABLE_PRINCIPAL_SUGEF									BIGINT = NULL,
        @pdSALDO_PRINCIPAL													DECIMAL(25, 2),
        @piCUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_SUGEF					BIGINT = NULL,
        @pdSALDO_PRINCIPAL_DEPOSITO_PREVIO									DECIMAL(25, 2),
        @piCUENTA_CONTABLE_PRODUCTO_SUGEF									BIGINT = NULL,
        @pdSALDO_PRODUCTO													DECIMAL(25, 2) = NULL,
		@pdMONTO_ESTIMACION_ESTRUCTURAL										DECIMAL(25,2)= NULL,
        @piCUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_SUGEF						BIGINT = NULL,
        @pdSALDO_DESEMBOLSAR_COMPROMISO										DECIMAL(25, 2) = NULL,
        @piCUENTA_CONTABLE_COMISIONES_SUGEF									BIGINT = NULL,
        @pdSALDO_COMISIONES													DECIMAL(25, 2) = NULL,
        @piCUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_SUGEF BIGINT = NULL,
        @pdSALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO						DECIMAL(25, 2)=NULL,
        @pdMONTO_DESEMBOLSADO												DECIMAL(25, 2) = NULL,
        @pdtFECHA_FORMALIZACION												DATE = NULL,
        @pdtFECHA_VENCIMIENTO												DATE = NULL,
        @piFRECUENCIA_PAGO_ACTUAL_PRINCIPAL									INT = NULL,
        @piFRECUENCIA_PAGO_ACTUAL_INTERESES									INT = NULL,
        @pdtFECHA_VENCIMIENTO_PERIODO_GRACIA_PRINCIPAL						DATE = NULL,
        @pdCOD_TASA_INTERES_NOMINAL_VIGENTE									DECIMAL(7, 2) = NULL,
        @psCOD_TIPO_TASA													VARCHAR(2) = NULL,
        @psFACTOR_TIEMPO													VARCHAR(1) = NULL,
        @psCOD_FORMA_PAGO_VIGENTE_PRINCIPAL									VARCHAR(1) = NULL,
        @psCOD_FORMA_PAGO_VIGENTE_INTERESES									VARCHAR(1) = NULL,
        @pdtFECHA_CORTE_OPERACION											DATE = NULL,
        @pdtFECHA_PROXIMO_PAGO_PRINCIPAL									DATE = NULL,
        @pdtFECHA_PROXIMO_PAGO_INTERESES									DATE = NULL,
        @pdtFECHA_AMORTIZACION_HASTA										DATE = NULL,
        @pdtFECHA_INTERESES_HASTA											DATE = NULL,
        @pdtFECHA_PAGO_PACTADO_PRINCIPAL									DATE = NULL,
        @pdtFECHA_PAGO_PACTADO_INTERESES									DATE = NULL,
        @piPLAZO_OPERACION													INT = NULL,
        @piCOD_TIPO_CUOTA_PRINCIPAL											INT = NULL,
        @pdMONTO_CUOTA_PRINCIPAL_ACTUAL										DECIMAL(25, 2) = NULL,
        @pdMONTO_CUOTA_INTERESES_ACTUAL										DECIMAL(25, 2) = NULL,
        @psIND_OPERACION_NUEVA												VARCHAR(3) = NULL,
        @pdRECUPERACION_PRINCIPAL											DECIMAL(25, 2) = NULL,
        @pdOTROS_AUMENTOS_PRINCIPAL											DECIMAL(25, 2) = NULL,
        @pdOTRAS_DISMINUCIONES_PRINCIPAL									DECIMAL(25, 2) = NULL,
		@psIND_BACK_TO_BACK													VARCHAR(1) = NULL,
        @psIND_CREDITO_SINDICADO											VARCHAR(1) = NULL,
        @psIND_OPERACION_ESPECIAL											VARCHAR(2) = NULL,
        @pdPCJ_RESPONSABILIDAD_LINEA										DECIMAL(7, 2) = NULL,
        @piCLAUSULA_LIMITE_CREDITO											INT=NULL,
        @psCOD_OFICINA														VARCHAR(5) = NULL,
        @psCOD_PRODUCTO														VARCHAR(5) = NULL,
        @piCUENTA_CONTABLE_PRINCIPAL_ENTIDAD								BIGINT = NULL,
        @piCUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_ENTIDAD				BIGINT = NULL,
        @piCUENTA_CONTABLE_PRODUCTOS_ENTIDAD								BIGINT = NULL,
        @piCUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_ENTIDAD					BIGINT = NULL,
        @piCUENTA_CONTABLE_COMISIONES_ENTIDAD								BIGINT = NULL,
        @piCUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_ENTIDAD BIGINT = NULL,
        @piATRASO_CAPITAL													INT = NULL,
        @piATRASO_INTERES													INT = NULL,
		@pdtFECHA_CAMBIO_TIPO_TASA											DATE= NULL,
		@piFRECUENCIA_AJUSTE_TASA_INTERES_VARIABLE							INT =NULL,
		@piPARAMETRO_REFERENCIA_TASA_INTERES_VARIABLE						INT = NULL,
		@pdCOMPONENTE_VARIABLE_TASA_INTERES_VARIABLE						DECIMAL(5, 2)=NULL,
		@pdCOMPONENTE_FIJO_TASA_INTERES_VARIABLE							DECIMAL(5, 2)=NULL,
		@pdLIMITE_INFERIOR_TASA_INTERES_VARIABLE							DECIMAL(5, 2)=NULL,
		@pdLIMITE_SUPERIOR_TASA_INTERES_VARIABLE							DECIMAL(5, 2)=NULL,
		@pdMONTO_ESTIMACION_GENERICA_DIRECTA								DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_GENERICA_CONTINGENTE							DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_CUBIERTA				DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_DESCUBIERTA			DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_CUBIERTA			DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_DESCUBIERTA		DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_CONTRA_CICLICA_DIRECTA							DECIMAL(25, 2)=NULL,
		@pdMONTO_ESTIMACION_CONTRA_CICLICA_CONTINGENTE						DECIMAL(25, 2)=NULL,
		@piCOD_SISTEMA														INT = NULL,
		@pdID_OPERACION_INTERNO												VARCHAR(25)=NULL,
		@piTIPO_SOBREGIRO													INT=NULL,
		@pdMONTO_INTERES_HASTA_180											DECIMAL(25,2)=NULL,
		@piCANTIDAD_DIAS_HASTA_180											INT=NULL,
		@piCANTIDAD_DIAS_MAS_180											INT=NULL,	
		@pdMONTO_INTERES_ADELANTADO											DECIMAL(25,2)=NULL,
		@piCANTIDAD_DIAS_ADELANTADO											INT=NULL,
		@piFRECUENCIA_PAGO_ACTUAL_PRINCIPAL_FUENTE							INT=NULL,
		@piFRECUENCIA_PAGO_ACTUAL_INTERESES_FUENTE							INT=NULL 			

AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.OPERACIONES (
					EMPRESA,
					COD_TIPO_PERSONA_DEUDOR,
					ID_DEUDOR,
					ID_OPERACION,
					ID_LINEA,
					COD_TIPO_OPERACION,
					COD_TIPO_CATALOGO_SUGEF,
					COD_PAIS_DESTINO_CREDITO,
					COD_PROVINCIA_DESTINO_CREDITO,
					COD_CANTON_DESTINO_CREDITO,
					COD_PROVINCIA_DEPENDENCIA_CREDITO,
					COD_CANTON_DEPENDENCIA_CREDITO,
					COD_TIPO_CARTERA,
					COD_TIPO_ESTADO_OPERACION,
					COD_TIPO_MONEDA_MONTO,
					MONTO_OPERACION_AUTORIZADO,
					CUENTA_CONTABLE_PRINCIPAL_SUGEF,
					SALDO_PRINCIPAL,
					CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_SUGEF,
					SALDO_PRINCIPAL_DEPOSITO_PREVIO,
					CUENTA_CONTABLE_PRODUCTO_SUGEF,
					SALDO_PRODUCTO,
					MONTO_ESTIMACION_ESTRUCTURAL,
					CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_SUGEF,
					SALDO_DESEMBOLSAR_COMPROMISO,
					CUENTA_CONTABLE_COMISIONES_SUGEF,
					SALDO_COMISIONES,
					CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_SUGEF,
					SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO,
					MONTO_DESEMBOLSADO,
					FECHA_FORMALIZACION,
					FECHA_VENCIMIENTO,
					FRECUENCIA_PAGO_ACTUAL_PRINCIPAL,
					FRECUENCIA_PAGO_ACTUAL_INTERESES,
					FECHA_VENCIMIENTO_PERIODO_GRACIA_PRINCIPAL,
					COD_TASA_INTERES_NOMINAL_VIGENTE,
					COD_TIPO_TASA,
					FACTOR_TIEMPO,
					COD_FORMA_PAGO_VIGENTE_PRINCIPAL,
					COD_FORMA_PAGO_VIGENTE_INTERESES,
					FECHA_CORTE_OPERACION,
					FECHA_PROXIMO_PAGO_PRINCIPAL,
					FECHA_PROXIMO_PAGO_INTERESES,
					FECHA_AMORTIZACION_HASTA,
					FECHA_INTERESES_HASTA,
					FECHA_PAGO_PACTADO_PRINCIPAL,
					FECHA_PAGO_PACTADO_INTERESES,
					PLAZO_OPERACION,
					COD_TIPO_CUOTA_PRINCIPAL,
					MONTO_CUOTA_PRINCIPAL_ACTUAL,
					MONTO_CUOTA_INTERESES_ACTUAL,
					IND_OPERACION_NUEVA,
					RECUPERACION_PRINCIPAL,
					OTROS_AUMENTOS_PRINCIPAL,
					OTRAS_DISMINUCIONES_PRINCIPAL,
					IND_BACK_TO_BACK,
					IND_CREDITO_SINDICADO,
					IND_OPERACION_ESPECIAL,
					PCJ_RESPONSABILIDAD_LINEA,
					CLAUSULA_LIMITE_CREDITO,
					COD_OFICINA,
					COD_PRODUCTO,
					CUENTA_CONTABLE_PRINCIPAL_ENTIDAD,
					CUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_ENTIDAD,
					CUENTA_CONTABLE_PRODUCTOS_ENTIDAD,
					CUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_ENTIDAD,
					CUENTA_CONTABLE_COMISIONES_ENTIDAD,
					CUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_ENTIDAD,
					ATRASO_CAPITAL,
					ATRASO_INTERES,
					FECHA_CAMBIO_TIPO_TASA,
					FRECUENCIA_AJUSTE_TASA_INTERES_VARIABLE,
					PARAMETRO_REFERENCIA_TASA_INTERES_VARIABLE,
					COMPONENTE_VARIABLE_TASA_INTERES_VARIABLE,
					COMPONENTE_FIJO_TASA_INTERES_VARIABLE,
					LIMITE_INFERIOR_TASA_INTERES_VARIABLE,
					LIMITE_SUPERIOR_TASA_INTERES_VARIABLE,
					MONTO_ESTIMACION_GENERICA_DIRECTA,
					MONTO_ESTIMACION_GENERICA_CONTINGENTE,
					MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_CUBIERTA,
					MONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_DESCUBIERTA,
					MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_CUBIERTA,
					MONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_DESCUBIERTA,
					MONTO_ESTIMACION_CONTRA_CICLICA_DIRECTA,
					MONTO_ESTIMACION_CONTRA_CICLICA_CONTINGENTE,
					COD_SISTEMA,
					ID_OPERACION_INTERNO,
					GAR.TIPO_SOBREGIRO,
					GAR.MONTO_INTERES_HASTA_180,
					GAR.CANTIDAD_DIAS_HASTA_180,
					GAR.CANTIDAD_DIAS_MAS_180,
					GAR.MONTO_INTERES_ADELANTADO,
					GAR.CANTIDAD_DIAS_ADELANTADO,
					GAR.FRECUENCIA_PAGO_ACTUAL_PRINCIPAL_FUENTE,
					GAR.FRECUENCIA_PAGO_ACTUAL_INTERESES_FUENTE				
)

		SELECT		@piEMPRESA,
					@piCOD_TIPO_PERSONA_DEUDOR,
					@pdID_DEUDOR,
					@psID_OPERACION,
					@pdID_LINEA,
					@piCOD_TIPO_OPERACION,
					@piCOD_TIPO_CATALOGO_SUGEF,
					@pdCOD_PAIS_DESTINO_CREDITO,
					@piCOD_PROVINCIA_DESTINO_CREDITO,
					@piCOD_CANTON_DESTINO_CREDITO,
					@piCOD_PROVINCIA_DEPENDENCIA_CREDITO,
					@piCOD_CANTON_DEPENDENCIA_CREDITO,
					@piCOD_TIPO_CARTERA,
					@piCOD_TIPO_ESTADO_OPERACION,
					@piCOD_TIPO_MONEDA_MONTO,
					@pdMONTO_OPERACION_AUTORIZADO,
					@piCUENTA_CONTABLE_PRINCIPAL_SUGEF,
					@pdSALDO_PRINCIPAL,
					@piCUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_SUGEF,
					@pdSALDO_PRINCIPAL_DEPOSITO_PREVIO,
					@piCUENTA_CONTABLE_PRODUCTO_SUGEF,
					@pdSALDO_PRODUCTO,
					@pdMONTO_ESTIMACION_ESTRUCTURAL,
					@piCUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_SUGEF,
					@pdSALDO_DESEMBOLSAR_COMPROMISO,
					@piCUENTA_CONTABLE_COMISIONES_SUGEF,
					@pdSALDO_COMISIONES,
					@piCUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_SUGEF,
					@pdSALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO,
					@pdMONTO_DESEMBOLSADO,
					@pdtFECHA_FORMALIZACION,
					@pdtFECHA_VENCIMIENTO,
					@piFRECUENCIA_PAGO_ACTUAL_PRINCIPAL,
					@piFRECUENCIA_PAGO_ACTUAL_INTERESES,
					@pdtFECHA_VENCIMIENTO_PERIODO_GRACIA_PRINCIPAL,
					@pdCOD_TASA_INTERES_NOMINAL_VIGENTE,
					@psCOD_TIPO_TASA,
					@psFACTOR_TIEMPO,
					@psCOD_FORMA_PAGO_VIGENTE_PRINCIPAL,
					@psCOD_FORMA_PAGO_VIGENTE_INTERESES,
					@pdtFECHA_CORTE_OPERACION,
					@pdtFECHA_PROXIMO_PAGO_PRINCIPAL,
					@pdtFECHA_PROXIMO_PAGO_INTERESES,
					@pdtFECHA_AMORTIZACION_HASTA,
					@pdtFECHA_INTERESES_HASTA,
					@pdtFECHA_PAGO_PACTADO_PRINCIPAL,
					@pdtFECHA_PAGO_PACTADO_INTERESES,
					@piPLAZO_OPERACION,
					@piCOD_TIPO_CUOTA_PRINCIPAL,
					@pdMONTO_CUOTA_PRINCIPAL_ACTUAL,
					@pdMONTO_CUOTA_INTERESES_ACTUAL,
					@psIND_OPERACION_NUEVA,
					@pdRECUPERACION_PRINCIPAL,
					@pdOTROS_AUMENTOS_PRINCIPAL,
					@pdOTRAS_DISMINUCIONES_PRINCIPAL,
					@psIND_BACK_TO_BACK,
					@psIND_CREDITO_SINDICADO,
					@psIND_OPERACION_ESPECIAL,
					@pdPCJ_RESPONSABILIDAD_LINEA,
					@piCLAUSULA_LIMITE_CREDITO,
					@psCOD_OFICINA,
					@psCOD_PRODUCTO,
					@piCUENTA_CONTABLE_PRINCIPAL_ENTIDAD,
					@piCUENTA_CONTABLE_PRINCIPAL_DEPOSITO_PREVIO_ENTIDAD,
					@piCUENTA_CONTABLE_PRODUCTOS_ENTIDAD,
					@piCUENTA_CONTABLE_DESEMBOLSAR_COMPROMISO_ENTIDAD,
					@piCUENTA_CONTABLE_COMISIONES_ENTIDAD,
					@piCUENTA_CONTABLE_SALDO_PENDIENTE_UTILIZACION_SIN_COMPROMISO_ENTIDAD,
					@piATRASO_CAPITAL,
					@piATRASO_INTERES,
					@pdtFECHA_CAMBIO_TIPO_TASA,
					@piFRECUENCIA_AJUSTE_TASA_INTERES_VARIABLE,
					@piPARAMETRO_REFERENCIA_TASA_INTERES_VARIABLE,
					@pdCOMPONENTE_VARIABLE_TASA_INTERES_VARIABLE,
					@pdCOMPONENTE_FIJO_TASA_INTERES_VARIABLE,
					@pdLIMITE_INFERIOR_TASA_INTERES_VARIABLE,
					@pdLIMITE_SUPERIOR_TASA_INTERES_VARIABLE,
					@pdMONTO_ESTIMACION_GENERICA_DIRECTA,
					@pdMONTO_ESTIMACION_GENERICA_CONTINGENTE,
					@pdMONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_CUBIERTA,
					@pdMONTO_ESTIMACION_ESPECIFICA_DIRECTA_PARTE_DESCUBIERTA,
					@pdMONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_CUBIERTA,
					@pdMONTO_ESTIMACION_ESPECIFICA_CONTINGENTE_PARTE_DESCUBIERTA,
					@pdMONTO_ESTIMACION_CONTRA_CICLICA_DIRECTA,
					@pdMONTO_ESTIMACION_CONTRA_CICLICA_CONTINGENTE,
					@piCOD_SISTEMA,
					@pdID_OPERACION_INTERNO,
					@piTIPO_SOBREGIRO,													
					@pdMONTO_INTERES_HASTA_180,
					@piCANTIDAD_DIAS_HASTA_180,
					@piCANTIDAD_DIAS_MAS_180,	
					@pdMONTO_INTERES_ADELANTADO,
					@piCANTIDAD_DIAS_ADELANTADO,
					@piFRECUENCIA_PAGO_ACTUAL_PRINCIPAL_FUENTE,
					@piFRECUENCIA_PAGO_ACTUAL_INTERESES_FUENTE

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH




GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Modificacion_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Operaciones_Modificacion_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo de la tabla OPERACIO_MODIFICACION, 
			 tomando en cuenta el ordenamiento, paginacin y filtros.
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Modificacion_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @TempItems TABLE
(
        ID INT IDENTITY(0,1),
        ID_ROW INT      
)

DECLARE @maxRow INT
DECLARE @vsSQL VARCHAR(4000)
SET @filterValue = UPPER( '%' + @filterValue + '%')

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION, COD_TIPO_MODIFICACION, FECHA_MODIFICACION' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow

SET @vsSQL = (SELECT 'SELECT ID_ROW FROM dbo.OPERACIONES_MODIFICACION
				WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(')

SET @vsSQL = @vsSQL + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_MODIFICACION' THEN 'CONVERT(VARCHAR,FECHA_MODIFICACION,103)'  
							ELSE +@filterColumn END )

SET @vsSQL = @vsSQL + ( ',''''))  LIKE ''' + @filterValue + '''
							ORDER BY ' + @sortColumn)

INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL) 
--EXECUTE('SELECT ID_ROW FROM dbo.OPERACIONES_MODIFICACION
--          WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(' + @filterColumn + ') LIKE ''' + @filterValue + '''
--          ORDER BY ' + @sortColumn)
          
SET ROWCOUNT @maximumRows

SELECT 
       OPE.ID_ROW,
       OPE.N_REGISTRO,
       OPE.EMPRESA,
       OPE.ID_OPERACION,
       OPE.FECHA_MODIFICACION,
       OPE.COD_TIPO_MODIFICACION,
       OPE.COD_SISTEMA,
	   TMO.DES_TIPO_MODIFICACION_OPERACION
FROM @TempItems TEMP
	INNER JOIN dbo.OPERACIONES_MODIFICACION OPE
		ON OPE.ID_ROW = TEMP.ID_ROW
	LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_MODIFICACION_OPERACION TMO
		ON OPE.COD_TIPO_MODIFICACION = TMO.COD_TIPO_MODIFICACION_OPERACION
WHERE TEMP.ID >= @startRowIndex
	
SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Modificacion_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Modificacion_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla OPERACIO_MODIFICACION
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Modificacion_Consulta_Detalle]
	@piID_ROW INT
AS

SELECT ID_ROW,
       N_REGISTRO,
       EMPRESA,
       ID_OPERACION,
       FECHA_MODIFICACION,
       COD_TIPO_MODIFICACION,
       COD_SISTEMA
  FROM dbo.OPERACIONES_MODIFICACION
 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Modificacion_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Operaciones_Modificacion_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla OPERACIONES_MODIFICACION.
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Modificacion_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = UPPER('%' + @filterValue + '%')

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.OPERACIONES_MODIFICACION
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' 

SET @StrSQL = @StrSQL + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_MODIFICACION' THEN 'CONVERT(VARCHAR,FECHA_MODIFICACION,103)'  
							ELSE +@filterColumn END )

SET @StrSQL = @StrSQL + ( ','''')) LIKE ''' + @filterValue + '''' )

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Modificacion_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Modificacion_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla OPERACIONES_MODIFICACION
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Modificacion_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE
		FROM dbo.OPERACIONES_MODIFICACION
		WHERE ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Modificacion_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Modificacion_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla OPERACIONES_MODIFICACION
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Modificacion_Inserta]
        @piEMPRESA INT = NULL,
        @psID_OPERACION VARCHAR(25) = NULL,
        @piCOD_TIPO_MODIFICACION INT = NULL,
        @pdtFECHA_MODIFICACION DATE = NULL,
        @piCOD_SISTEMA INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.OPERACIONES_MODIFICACION(        
					EMPRESA,
					ID_OPERACION,
					COD_TIPO_MODIFICACION,
					FECHA_MODIFICACION,
					COD_SISTEMA)

		SELECT		@piEMPRESA,
					@psID_OPERACION,
					@piCOD_TIPO_MODIFICACION,
					@pdtFECHA_MODIFICACION,
					@piCOD_SISTEMA
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Modificacion_Operaciones_Canceladas_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Modificacion_Operaciones_Canceladas_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro en la tabla OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Modificacion_Operaciones_Canceladas_Actualiza]
	@piID_ROW								INT = NULL,	
    @piCOD_TIPO_PERSONA_DEUDOR_CANCELADO	INT = NULL,
    @psID_DEUDOR_CANCELADO					VARCHAR(30) = NULL,
    @pdtFECHA_DESEMBOLSO_DEUDOR				DATE = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS
		SET		COD_TIPO_PERSONA_DEUDOR_CANCELADO	= @piCOD_TIPO_PERSONA_DEUDOR_CANCELADO,
				ID_DEUDOR_CANCELADO					= @psID_DEUDOR_CANCELADO,
				FECHA_DESEMBOLSO_DEUDOR				= @pdtFECHA_DESEMBOLSO_DEUDOR
		WHERE	ID_ROW = @piID_ROW
	
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Modificacion_Operaciones_Canceladas_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Operaciones_Modificacion_Operaciones_Canceladas_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo de la tabla OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS, 
			 tomando en cuenta el ordenamiento, paginacin y filtros.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Modificacion_Operaciones_Canceladas_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   
        ID INT IDENTITY(0,1),
        ID_ROW INT
)
 DECLARE @maxRow INT
DECLARE @vsSQL VARCHAR(4000)
SET @filterValue = UPPER( '%' + @filterValue + '%')

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION, COD_TIPO_MODIFICACION,
						                           FECHA_MODIFICACION,
						                           COD_TIPO_PERSONA_ENTIDAD_OPERACION_CANCELADA, 
						                           ID_ENTIDAD_OPERACION_CANCELADA, 
						                           ID_OPERACION_CANCELADA' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow

SET @vsSQL = (SELECT 'SELECT ID_ROW FROM dbo.OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS
				WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(')

SET @vsSQL = @vsSQL + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_MODIFICACION' THEN 'CONVERT(VARCHAR,FECHA_MODIFICACION,103)'  
							ELSE +@filterColumn END )

SET @vsSQL = @vsSQL + ( ','''')) LIKE ''' + @filterValue + '''
							ORDER BY ' + @sortColumn)

INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL) 
--EXECUTE('SELECT ID_ROW FROM dbo.OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS
--WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(' + @filterColumn + ') LIKE ''' + @filterValue + '''
--ORDER BY ' + @sortColumn)

SET ROWCOUNT @maximumRows
	SELECT
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA,
		E.ID_OPERACION,
		E.COD_TIPO_MODIFICACION,
		E.FECHA_MODIFICACION,
		E.COD_TIPO_PERSONA_ENTIDAD_OPERACION_CANCELADA,
		E.ID_ENTIDAD_OPERACION_CANCELADA,
		E.COD_TIPO_PERSONA_DEUDOR_CANCELADO,
		E.ID_DEUDOR_CANCELADO,
		E.ID_OPERACION_CANCELADA,
		E.FECHA_DESEMBOLSO_DEUDOR,
		E.COD_SISTEMA,
		TMO.DES_TIPO_MODIFICACION_OPERACION,
		TP.DES_TIPO_PERSONA
	FROM @TempItems T 
	INNER JOIN dbo.OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS E 
	    ON E.ID_ROW = T.ID_ROW
	LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_MODIFICACION_OPERACION TMO
		ON E.COD_TIPO_MODIFICACION = TMO.COD_TIPO_MODIFICACION_OPERACION
	LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_PERSONA TP
		ON E.COD_TIPO_PERSONA_ENTIDAD_OPERACION_CANCELADA = TP.COD_TIPO_PERSONA
	WHERE ID >= @startRowIndex

SET ROWCOUNT 0





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Modificacion_Operaciones_Canceladas_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Modificacion_Operaciones_Canceladas_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Modificacion_Operaciones_Canceladas_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT	ID_ROW,
			N_REGISTRO,
			EMPRESA,
			ID_OPERACION,
			COD_TIPO_MODIFICACION,
			FECHA_MODIFICACION,
			COD_TIPO_PERSONA_ENTIDAD_OPERACION_CANCELADA,
			ID_ENTIDAD_OPERACION_CANCELADA,
			COD_TIPO_PERSONA_DEUDOR_CANCELADO,
			ID_DEUDOR_CANCELADO,
			ID_OPERACION_CANCELADA,
			FECHA_DESEMBOLSO_DEUDOR,
			COD_SISTEMA
	FROM	dbo.OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS
	WHERE	ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Modificacion_Operaciones_Canceladas_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Operaciones_Modificacion_Operaciones_Canceladas_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Modificacion_Operaciones_Canceladas_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = UPPER('%' + @filterValue + '%')

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' 

SET @StrSQL = @StrSQL + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_MODIFICACION' THEN 'CONVERT(VARCHAR,FECHA_MODIFICACION,103)'  
							ELSE +@filterColumn END )

SET @StrSQL = @StrSQL + ( ','''')) LIKE ''' + @filterValue + '''' )

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount



GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Modificacion_Operaciones_Canceladas_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Modificacion_Operaciones_Canceladas_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Modificacion_Operaciones_Canceladas_Elimina]
   @piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM dbo.OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS
		WHERE ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Modificacion_Operaciones_Canceladas_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Modificacion_Operaciones_Canceladas_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Modificacion_Operaciones_Canceladas_Inserta]
	@piEMPRESA										INT = NULL,
	@psID_OPERACION									VARCHAR(25) = NULL,
	@piCOD_TIPO_MODIFICACION						INT = NULL,
	@pdtFECHA_MODIFICACION							DATE = NULL,
	@piCOD_TIPO_PERSONA_ENTIDAD_OPERACION_CANCELADA INT = NULL,
	@psID_ENTIDAD_OPERACION_CANCELADA				VARCHAR(30) = NULL,
	@piCOD_TIPO_PERSONA_DEUDOR_CANCELADO			INT = NULL,
	@psID_DEUDOR_CANCELADO							VARCHAR(30) = NULL,
	@psID_OPERACION_CANCELADA						VARCHAR(25) = NULL,
	@pdtFECHA_DESEMBOLSO_DEUDOR						DATE = NULL,
	@piCOD_SISTEMA									INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO OPERACIONES_MODIFICACION_OPERACIONES_CANCELADAS (
					EMPRESA,
					ID_OPERACION,
					COD_TIPO_MODIFICACION,
					FECHA_MODIFICACION,
					COD_TIPO_PERSONA_ENTIDAD_OPERACION_CANCELADA,
					ID_ENTIDAD_OPERACION_CANCELADA,
					COD_TIPO_PERSONA_DEUDOR_CANCELADO,
					ID_DEUDOR_CANCELADO,
					ID_OPERACION_CANCELADA,
					FECHA_DESEMBOLSO_DEUDOR,
					COD_SISTEMA)
		SELECT		@piEMPRESA,
					@psID_OPERACION,
					@piCOD_TIPO_MODIFICACION,
					@pdtFECHA_MODIFICACION,
					@piCOD_TIPO_PERSONA_ENTIDAD_OPERACION_CANCELADA,
					@psID_ENTIDAD_OPERACION_CANCELADA,
					@piCOD_TIPO_PERSONA_DEUDOR_CANCELADO,
					@psID_DEUDOR_CANCELADO,
					@psID_OPERACION_CANCELADA,
					@pdtFECHA_DESEMBOLSO_DEUDOR,
					@piCOD_SISTEMA

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Naturaleza_Gasto_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Naturaleza_Gasto_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro en la tabla OPERACIO_MODIFICACION
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Naturaleza_Gasto_Actualiza]
        @piID_ROW				INT = NULL, 
        @piPCJ_NATURALEZA_GASTO INT  = NULL    
AS
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.OPERACIONES_NATURALEZA_GASTO
		SET		PCJ_NATURALEZA_GASTO = @piPCJ_NATURALEZA_GASTO
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Naturaleza_Gasto_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Naturaleza_Gasto_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo de la tabla OPERACIO_MODIFICACION, 
			 tomando en cuenta el ordenamiento, paginacin y filtros.
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Naturaleza_Gasto_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @TempItems TABLE
(
        ID INT IDENTITY(0,1),
        ID_ROW INT
)

DECLARE @maxRow INT
SET @filterValue = '%' + @filterValue + '%'
SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION, COD_NATURALEZA_GASTO' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow

INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT ID_ROW FROM dbo.OPERACIONES_NATURALEZA_GASTO
          WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
          ORDER BY ' + @sortColumn)
          
SET ROWCOUNT @maximumRows

SELECT 
       OPE.ID_ROW,
       OPE.N_REGISTRO,
       OPE.EMPRESA,
       OPE.ID_OPERACION,
       OPE.COD_NATURALEZA_GASTO,
       OPE.PCJ_NATURALEZA_GASTO,
       OPE.COD_SISTEMA,
	   TNG.DES_TIPO_NATURALEZA_GASTO
  FROM @TempItems TEMP
	INNER JOIN dbo.OPERACIONES_NATURALEZA_GASTO OPE
		ON OPE.ID_ROW = TEMP.ID_ROW
	LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_NATURALEZA_GASTO TNG
		ON OPE.COD_NATURALEZA_GASTO = TNG.COD_TIPO_NATURALEZA_GASTO
 WHERE TEMP.ID >= @startRowIndex

SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Naturaleza_Gasto_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Naturaleza_Gasto_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla OPERACIONES_NATURALEZA_GASTO
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Naturaleza_Gasto_Consulta_Detalle]
	@piID_ROW INT
AS

SELECT ID_ROW,
       N_REGISTRO,
       EMPRESA,
       ID_OPERACION,
       COD_NATURALEZA_GASTO,
       PCJ_NATURALEZA_GASTO,
       COD_SISTEMA
  FROM dbo.OPERACIONES_NATURALEZA_GASTO
 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Naturaleza_Gasto_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Naturaleza_Gasto_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla OPERACIONES_NATURALEZA_GASTO
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Naturaleza_Gasto_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)
AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.OPERACIONES_NATURALEZA_GASTO
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Naturaleza_Gasto_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Naturaleza_Gasto_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla OPERACIONES_NATURALEZA_GASTO
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Naturaleza_Gasto_Elimina]
        @piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE
		FROM	dbo.OPERACIONES_NATURALEZA_GASTO
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Naturaleza_Gasto_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Naturaleza_Gasto_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla OPERACIONES_NATURALEZA_GASTO
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Naturaleza_Gasto_Inserta]
        @piEMPRESA				INT = NULL,
        @psID_OPERACION			VARCHAR(25) = NULL,
        @piCOD_NATURALEZA_GASTO INT = NULL,
        @piPCJ_NATURALEZA_GASTO INT = NULL,
        @piCOD_SISTEMA			INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.OPERACIONES_NATURALEZA_GASTO (
			   EMPRESA,
			   ID_OPERACION,
			   COD_NATURALEZA_GASTO,
			   PCJ_NATURALEZA_GASTO,
			   COD_SISTEMA)

		SELECT @piEMPRESA,
			   @psID_OPERACION,
			   @piCOD_NATURALEZA_GASTO,
			   @piPCJ_NATURALEZA_GASTO,
			   @piCOD_SISTEMA
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_No_Reportadas_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_No_Reportadas_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla OPERACIONES_NO_REPORTADAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_No_Reportadas_Actualiza]
	@piID_ROW						INT = NULL,	
	@piCOD_TIPO_PERSONA				INT = NULL,
	@psID_DEUDOR					VARCHAR(30) = NULL,
	@pdtFECHA_LIQUIDACION			DATE = NULL,
	@pdSALDO_PRINCIPAL_LIQUIDADO	DECIMAL(25,2) = NULL,
	@pdSALDO_PRODUCTOS_LIQUIDADO	DECIMAL(25,2) = NULL,
	@psID_OPERACION_NUEVA			VARCHAR(25) = NULL
	
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.OPERACIONES_NO_REPORTADAS
		SET		COD_TIPO_PERSONA			= @piCOD_TIPO_PERSONA,
				ID_DEUDOR					= @psID_DEUDOR,
				FECHA_LIQUIDACION			= @pdtFECHA_LIQUIDACION,
				SALDO_PRINCIPAL_LIQUIDADO	= @pdSALDO_PRINCIPAL_LIQUIDADO,
				SALDO_PRODUCTOS_LIQUIDADO	= @pdSALDO_PRODUCTOS_LIQUIDADO,
				ID_OPERACION_NUEVA			= @psID_OPERACION_NUEVA		
		WHERE	ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_No_Reportadas_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Operaciones_No_Reportadas_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla OPERACIONES_NO_REPORTADAS
Sistema(s): SICADD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_No_Reportadas_Consulta]
(
         @startRowIndex INT,
         @maximumRows INT,
         @filterValue VARCHAR(MAX),
         @filterColumn VARCHAR(MAX),
         @sortColumn VARCHAR(MAX),
         @filtroEmpresa INT
 )
AS
 DECLARE @TempItems TABLE 
(   
	ID INT IDENTITY(0,1),
	ID_ROW INT
)
 DECLARE @maxRow INT
DECLARE @vsSQL VARCHAR(4000)
SET @filterValue = UPPER( '%' + @filterValue + '%')

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow

SET @vsSQL = (SELECT 'SELECT ID_ROW FROM dbo.OPERACIONES_NO_REPORTADAS
				WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(')

SET @vsSQL = @vsSQL + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_LIQUIDACION' THEN 'CONVERT(VARCHAR,FECHA_LIQUIDACION,103)'  
							ELSE +@filterColumn END )

SET @vsSQL = @vsSQL + ( ','''')) LIKE ''' + @filterValue + '''
							ORDER BY ' + @sortColumn)

INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL) 
--EXECUTE('SELECT ID_ROW FROM dbo.OPERACIONES_NO_REPORTADAS
--WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(' + @filterColumn + ') LIKE ''' + @filterValue + '''
--ORDER BY ' + @sortColumn)
SET ROWCOUNT @maximumRows
	SELECT
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA,
		E.COD_TIPO_PERSONA,
		E.ID_DEUDOR,
		E.ID_OPERACION,
		E.COD_TIPO_MOTIVO_LIQUIDACION,
		E.FECHA_LIQUIDACION,
		E.SALDO_PRINCIPAL_LIQUIDADO,
		E.SALDO_PRODUCTOS_LIQUIDADO,
		E.ID_OPERACION_NUEVA,
		E.COD_SISTEMA,
		DES_TIPO_MOTIVO_OPERACION_NO_REPORTADA
	FROM @TempItems T 
	INNER JOIN dbo.OPERACIONES_NO_REPORTADAS E 
	     ON E.ID_ROW = T.ID_ROW
	LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_MOTIVO_OPERACION_NO_REPORTADA TM
		ON E.COD_TIPO_MOTIVO_LIQUIDACION = TM.COD_TIPO_MOTIVO_OPERACION_NO_REPORTADA
	WHERE ID >= @startRowIndex		

SET ROWCOUNT 0




GO
/****** Object:  StoredProcedure [dbo].[Operaciones_No_Reportadas_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_No_Reportadas_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla OPERACIONES_NO_REPORTADAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_No_Reportadas_Consulta_Detalle]
        @piID_ROW INT
AS
	SELECT ID_ROW,
		   N_REGISTRO,
		   EMPRESA,
		   COD_TIPO_PERSONA,
		   ID_DEUDOR,
		   ID_OPERACION,
		   COD_TIPO_MOTIVO_LIQUIDACION,
		   FECHA_LIQUIDACION,
		   SALDO_PRINCIPAL_LIQUIDADO,
		   SALDO_PRODUCTOS_LIQUIDADO,
		   ID_OPERACION_NUEVA,
		   COD_SISTEMA
	  FROM dbo.OPERACIONES_NO_REPORTADAS
	 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_No_Reportadas_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Operaciones_No_Reportadas_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla OPERACIONES_NO_REPORTADAS.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_No_Reportadas_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = UPPER('%' + @filterValue + '%')

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.OPERACIONES_NO_REPORTADAS
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' 

SET @StrSQL = @StrSQL + (	SELECT	CASE @filterColumn 
							WHEN 'FECHA_LIQUIDACION' THEN 'CONVERT(VARCHAR,FECHA_LIQUIDACION,103)'  
							ELSE +@filterColumn END )

SET @StrSQL = @StrSQL + ( ','''')) LIKE ''' + @filterValue + '''' )

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount




GO
/****** Object:  StoredProcedure [dbo].[Operaciones_No_Reportadas_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_No_Reportadas_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla OPERACIONES_NO_REPORTADAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_No_Reportadas_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM	dbo.OPERACIONES_NO_REPORTADAS
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_No_Reportadas_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_No_Reportadas_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla OPERACIONES_NO_REPORTADAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_No_Reportadas_Inserta]	
	@piEMPRESA						INT = NULL,
	@piCOD_TIPO_PERSONA				INT = NULL,
	@psID_DEUDOR					VARCHAR(30) = NULL,
	@psID_OPERACION					VARCHAR(25) = NULL,
	@piCOD_TIPO_MOTIVO_LIQUIDACION  INT = NULL,
	@pdtFECHA_LIQUIDACION			DATE = NULL,
	@pdSALDO_PRINCIPAL_LIQUIDADO	DECIMAL(25,2) = NULL,
	@pdSALDO_PRODUCTOS_LIQUIDADO	DECIMAL(25,2) = NULL,
	@psID_OPERACION_NUEVA			VARCHAR(25) = NULL,
	@piCOD_SISTEMA					INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.OPERACIONES_NO_REPORTADAS (	
			EMPRESA,
			COD_TIPO_PERSONA,
			ID_DEUDOR,
			ID_OPERACION,
			COD_TIPO_MOTIVO_LIQUIDACION,
			FECHA_LIQUIDACION,
			SALDO_PRINCIPAL_LIQUIDADO,
			SALDO_PRODUCTOS_LIQUIDADO,
			ID_OPERACION_NUEVA,
			COD_SISTEMA	)
		SELECT 
			@piEMPRESA,
			@piCOD_TIPO_PERSONA,
			@psID_DEUDOR,
			@psID_OPERACION,
			@piCOD_TIPO_MOTIVO_LIQUIDACION,
			@pdtFECHA_LIQUIDACION,
			@pdSALDO_PRINCIPAL_LIQUIDADO,
			@pdSALDO_PRODUCTOS_LIQUIDADO,
			@psID_OPERACION_NUEVA,
			@piCOD_SISTEMA
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Operacion_Especial_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Operacion_Especial_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo de la tabla OPERACIO_OPERACION_ESPECIAL, 
			 tomando en cuenta el ordenamiento, paginacin y filtros.
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Operacion_Especial_Consulta]
(
        @startRowIndex INT,
        @maximumRows INT,
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @sortColumn VARCHAR(MAX),
        @filtroEmpresa INT
)

AS

DECLARE @TempItems TABLE
(
        ID INT IDENTITY(0,1),
        ID_ROW INT
)

DECLARE @maxRow INT
SET @filterValue = '%' + @filterValue + '%'
SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION, COD_TIPO_OPERACION_ESPECIAL' ELSE @sortColumn END
SET @maxRow = (@startRowIndex + @maximumRows)

SET ROWCOUNT @maxRow

INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT ID_ROW FROM dbo.OPERACIONES_OPERACION_ESPECIAL
          WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + '''
          ORDER BY ' + @sortColumn)
          
SET ROWCOUNT @maximumRows

SELECT 
       OPE.ID_ROW,
	   OPE.N_REGISTRO,
       OPE.EMPRESA,
       OPE.ID_OPERACION,
       OPE.COD_TIPO_OPERACION_ESPECIAL,
       OPE.COD_SISTEMA,
	   TOE.DES_TIPO_OPERACION_ESPECIAL
  FROM @TempItems TEMP
	INNER JOIN dbo.OPERACIONES_OPERACION_ESPECIAL OPE
		ON OPE.ID_ROW = TEMP.ID_ROW
	LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_OPERACION_ESPECIAL TOE
		ON OPE.COD_TIPO_OPERACION_ESPECIAL = TOE.COD_TIPO_OPERACION_ESPECIAL
	
                
 WHERE TEMP.ID >= @startRowIndex
	
SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Operacion_Especial_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Operacion_Especial_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla OPERACIONES_OPERACION_ESPECIAL
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Operacion_Especial_Consulta_Detalle]
        @piID_ROW INT
AS

SELECT ID_ROW,
       N_REGISTRO,
       EMPRESA,
       ID_OPERACION,
       COD_TIPO_OPERACION_ESPECIAL,
       COD_SISTEMA
  FROM dbo.OPERACIONES_OPERACION_ESPECIAL
 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Operacion_Especial_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Operacion_Especial_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla OPERACIO_OPERACION_ESPECIAL.
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Operacion_Especial_Consulta_Rowcount]
(
        @filterValue VARCHAR(MAX),
        @filterColumn VARCHAR(MAX),
        @filtroEmpresa INT
)

AS

DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.OPERACIONES_OPERACION_ESPECIAL
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Operacion_Especial_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Operacion_Especial_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla OPERACIO_OPERACION_ESPECIAL
Sistema(s): SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Operacion_Especial_Elimina]
	@piID_ROW INT
AS
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE
		FROM dbo.OPERACIONES_OPERACION_ESPECIAL
		WHERE ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Operacion_Especial_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Operacion_Especial_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla OPERACIO_OPERACION_ESPECIAL
Sistema(s):SICAD
Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Operaciones_Operacion_Especial_Inserta]
        @piEMPRESA						INT = NULL,
        @psID_OPERACION					VARCHAR(25) = NULL,
        @piCOD_TIPO_OPERACION_ESPECIAL	INT = NULL,
        @piCOD_SISTEMA					INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.OPERACIONES_OPERACION_ESPECIAL (
					EMPRESA,
					ID_OPERACION,
					COD_TIPO_OPERACION_ESPECIAL,
					COD_SISTEMA)

		SELECT		@piEMPRESA,
					@psID_OPERACION,
					@piCOD_TIPO_OPERACION_ESPECIAL,
					@piCOD_SISTEMA
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Origen_Recursos_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Origen_Recursos_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro en la tabla OPERACIONES_ORIGEN_RECURSOS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Origen_Recursos_Actualiza]
	@piID_ROW INT = NULL,
	@piPCJ_ORIGEN_RECURSOS INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE dbo.OPERACIONES_ORIGEN_RECURSOS
		SET PCJ_ORIGEN_RECURSOS = @piPCJ_ORIGEN_RECURSOS
		WHERE ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Origen_Recursos_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Origen_Recursos_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo de la tabla OPERACIONES_ORIGEN_RECURSOS, 
			 tomando en cuenta el ordenamiento, paginacin y filtros.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Origen_Recursos_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   
        ID INT IDENTITY(0,1),
	ID_ROW INT
)
 DECLARE @maxRow INT
 SET @filterValue = '%' + @filterValue + '%'

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'ID_OPERACION, COD_ORIGEN_RECURSOS' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT ID_ROW 
           FROM dbo.OPERACIONES_ORIGEN_RECURSOS
          WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ',''''))  LIKE ''' + @filterValue + '''
          ORDER BY ' + @sortColumn)
SET ROWCOUNT @maximumRows
	SELECT 
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA, 
		E.ID_OPERACION, 
		E.COD_ORIGEN_RECURSOS,
		E.PCJ_ORIGEN_RECURSOS,
		E.COD_SISTEMA,
		TOR.DES_TIPO_ORIGEN_RECURSO
	FROM @TempItems T 
        INNER JOIN dbo.OPERACIONES_ORIGEN_RECURSOS E 
			ON E.ID_ROW = T.ID_ROW
		LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_ORIGEN_RECURSO TOR
			ON E.COD_ORIGEN_RECURSOS = TOR.COD_TIPO_ORIGEN_RECURSO
	WHERE ID >= @startRowIndex

SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Origen_Recursos_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Origen_Recursos_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla OPERACIONES_ORIGEN_RECURSOS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Origen_Recursos_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT ID_ROW,
		   N_REGISTRO,
		   EMPRESA, 
		   ID_OPERACION, 
		   COD_ORIGEN_RECURSOS,
		   PCJ_ORIGEN_RECURSOS,
		   COD_SISTEMA
	  FROM dbo.OPERACIONES_ORIGEN_RECURSOS
	 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Origen_Recursos_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Origen_Recursos_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla OPERACIONES_ORIGEN_RECURSOS.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Origen_Recursos_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.OPERACIONES_ORIGEN_RECURSOS
                 WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Origen_Recursos_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Origen_Recursos_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla OPERACIONES_ORIGEN_RECURSOS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Origen_Recursos_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM	dbo.OPERACIONES_ORIGEN_RECURSOS
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Origen_Recursos_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Origen_Recursos_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla OPERACIONES_ORIGEN_RECURSOS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Origen_Recursos_Inserta]
	@piEMPRESA				INT = NULL,	
	@psID_OPERACION			VARCHAR(25) = NULL, 
	@piCOD_ORIGEN_RECURSOS	INT = NULL,
	@piPCJ_ORIGEN_RECURSOS	INT = NULL,
	@piCOD_SISTEMA			INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.OPERACIONES_ORIGEN_RECURSOS (
					EMPRESA,
					ID_OPERACION,
					COD_ORIGEN_RECURSOS,
					PCJ_ORIGEN_RECURSOS,
					COD_SISTEMA)
		SELECT 		@piEMPRESA,
					@psID_OPERACION,
					@piCOD_ORIGEN_RECURSOS,
					@piPCJ_ORIGEN_RECURSOS,
					@piCOD_SISTEMA
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Saldos_Cuentas_Cobrar_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Saldos_Cuentas_Cobrar_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro en la tabla OPERACIONES_SALDOS_CUENTAS_COBRAR
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Saldos_Cuentas_Cobrar_Actualiza]
	@piID_ROW									INT = NULL,
	@pdSALDO_CUENTAS_COBRAR						DECIMAL(25, 2) = NULL,
	@piCUENTA_CONTABLE_CUENTAS_COBRAR_ENTIDAD	BIGINT= NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE dbo.OPERACIONES_SALDOS_CUENTAS_COBRAR
		   SET SALDO_CUENTAS_COBRAR					  = @pdSALDO_CUENTAS_COBRAR,
			   CUENTA_CONTABLE_CUENTAS_COBRAR_ENTIDAD = @piCUENTA_CONTABLE_CUENTAS_COBRAR_ENTIDAD
		 WHERE ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Saldos_Cuentas_Cobrar_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




/*
Operaciones_Saldos_Cuentas_Cobrar_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo de la tabla OPERACIONES_SALDOS_CUENTAS_COBRAR, 
			 tomando en cuenta el ordenamiento, paginacin y filtros.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Saldos_Cuentas_Cobrar_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   
        ID INT IDENTITY(0,1),
	    ID_ROW INT
)
 DECLARE @maxRow INT
 DECLARE @vsSQL VARCHAR(4000)

SET @vsSQL = ('SELECT E.ID_ROW FROM dbo.OPERACIONES_SALDOS_CUENTAS_COBRAR E 
						LEFT JOIN (SELECT COD_CATALOGO_SUGEF,
									CONVERT(VARCHAR,COD_CATALOGO_SUGEF)+''-''+DES_CATALOGO_SUGEF AS DES_CATALOGO_SUGEF 
									FROM SICAD_CONFIGURACION.dbo.CATALOGO_SUGEF) CS
			ON E.CUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF = CS.COD_CATALOGO_SUGEF
				WHERE E.EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND ')

IF (@filterColumn = 'SALDO_CUENTAS_COBRAR' OR @filterColumn = 'ATRASO_CUENTAS_COBRAR' )AND ISNUMERIC(@filterValue) = 1
BEGIN
	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))
	SET @vsSQL = @vsSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')
	SET @vsSQL = @vsSQL + 'UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''
END

SET @vsSQL = @vsSQL + ' ORDER BY ' + CASE WHEN @sortColumn = '' THEN 'ID_OPERACION, CUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF,COD_TIPO_MONEDA_CUENTAS_COBRAR, ATRASO_CUENTAS_COBRAR' ELSE @sortColumn END

--IF @filterColumn = 'SALDO_CUENTAS_COBRAR'
--BEGIN
--	SET @filterColumn = ' format('+@filterColumn+',''N'','''+(SICAD_CONFIGURACION.dbo.Valor_Parametro(1))+''')'
--END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE(@vsSQL)
SET ROWCOUNT @maximumRows
	SELECT 
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA,
		E.ID_OPERACION,
		E.CUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF,
		E.SALDO_CUENTAS_COBRAR,
		E.COD_TIPO_MONEDA_CUENTAS_COBRAR,
		E.ATRASO_CUENTAS_COBRAR,
		E.CUENTA_CONTABLE_CUENTAS_COBRAR_ENTIDAD,
		E.COD_SISTEMA,
		CONVERT(VARCHAR, CS.COD_CATALOGO_SUGEF) + ' - ' + CS.DES_CATALOGO_SUGEF AS DES_CATALOGO_SUGEF,
		ME.DES_TIPO_MONEDA_ENTIDAD
	FROM @TempItems T 
	INNER JOIN dbo.OPERACIONES_SALDOS_CUENTAS_COBRAR E 
			ON E.ID_ROW = T.ID_ROW
	LEFT JOIN SICAD_CONFIGURACION.dbo.CATALOGO_SUGEF CS
			ON E.CUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF = CS.COD_CATALOGO_SUGEF
	LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_MONEDA_ENTIDAD ME
			ON 	E.COD_TIPO_MONEDA_CUENTAS_COBRAR = ME.COD_TIPO_MONEDA_ENTIDAD		
	WHERE ID >= @startRowIndex

SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Saldos_Cuentas_Cobrar_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Saldos_Cuentas_Cobrar_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla OPERACIONES_SALDOS_CUENTAS_COBRAR
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Saldos_Cuentas_Cobrar_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT ID_ROW,
		   N_REGISTRO,
		   EMPRESA,
		   ID_OPERACION,
		   CUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF,
		   SALDO_CUENTAS_COBRAR,
		   COD_TIPO_MONEDA_CUENTAS_COBRAR,
		   ATRASO_CUENTAS_COBRAR,
		   CUENTA_CONTABLE_CUENTAS_COBRAR_ENTIDAD,
		   COD_SISTEMA
	  FROM dbo.OPERACIONES_SALDOS_CUENTAS_COBRAR
	 WHERE ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Saldos_Cuentas_Cobrar_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



/*
Operaciones_Saldos_Cuentas_Cobrar_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla OPERACIONES_SALDOS_CUENTAS_COBRAR.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Saldos_Cuentas_Cobrar_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
                  FROM dbo.OPERACIONES_SALDOS_CUENTAS_COBRAR E
				  LEFT JOIN (SELECT COD_CATALOGO_SUGEF,
							CONVERT(VARCHAR,COD_CATALOGO_SUGEF)+''-''+DES_CATALOGO_SUGEF AS DES_CATALOGO_SUGEF 
							FROM SICAD_CONFIGURACION.dbo.CATALOGO_SUGEF) CS
					ON E.CUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF = CS.COD_CATALOGO_SUGEF
                 WHERE E.EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND '

 IF (@filterColumn = 'SALDO_CUENTAS_COBRAR' OR @filterColumn = 'ATRASO_CUENTAS_COBRAR') AND ISNUMERIC(@filterValue) = 1
BEGIN

	SET @filterValue = REPLACE(REPLACE(CASE WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) < CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue))) 
											WHEN (CHARINDEX(',',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX('.',REVERSE(@filterValue)) <> 0 
												  AND CHARINDEX(',',REVERSE(@filterValue)) > CHARINDEX('.',REVERSE(@filterValue)))
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue)))
											WHEN CHARINDEX(',',REVERSE(@filterValue)) <> 0
											THEN LEFT(@filterValue,LEN(@filterValue)-CHARINDEX(',',REVERSE(@filterValue)))
											ELSE LEFT(@filterValue,LEN(@filterValue)-CHARINDEX('.',REVERSE(@filterValue))) 
										END,',',''),'.','')
	--SET @filterValue = CAST(FLOOR(CAST(REPLACE(@filterValue,',','') AS DECIMAL(22,2))) AS VARCHAR(MAX))

	SET @StrSQL = @StrSQL + 'FLOOR('+@filterColumn + ') = ' + @filterValue
END
ELSE
BEGIN
	SET @filterValue = UPPER('%' + @filterValue + '%')

	SET @StrSQL = @StrSQL + ' UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''
END

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount







GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Saldos_Cuentas_Cobrar_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Saldos_Cuentas_Cobrar_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Elimina un registro de la tabla OPERACIONES_SALDOS_CUENTAS_COBRAR
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Saldos_Cuentas_Cobrar_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM dbo.OPERACIONES_SALDOS_CUENTAS_COBRAR
		WHERE ID_ROW = @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Operaciones_Saldos_Cuentas_Cobrar_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Operaciones_Saldos_Cuentas_Cobrar_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla OPERACIONES_SALDOS_CUENTAS_COBRAR
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Operaciones_Saldos_Cuentas_Cobrar_Inserta]
	@piEMPRESA INT = NULL,
	@psID_OPERACION VARCHAR(25) = NULL, 
	@piCUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF BIGINT = NULL,
	@pdSALDO_CUENTAS_COBRAR DECIMAL(25,2) = NULL,
	@piCOD_TIPO_MONEDA_CUENTAS_COBRAR INT = NULL,
	@piATRASO_CUENTAS_COBRAR INT = NULL,
	@piCUENTA_CONTABLE_CUENTAS_COBRAR_ENTIDAD BIGINT = NULL,
	@piCOD_SISTEMA INT = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.OPERACIONES_SALDOS_CUENTAS_COBRAR (
			EMPRESA,
			ID_OPERACION,
			CUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF,
			SALDO_CUENTAS_COBRAR,
			COD_TIPO_MONEDA_CUENTAS_COBRAR,
			ATRASO_CUENTAS_COBRAR,
			CUENTA_CONTABLE_CUENTAS_COBRAR_ENTIDAD,
			COD_SISTEMA	)
		SELECT 
			@piEMPRESA,
			@psID_OPERACION,
			@piCUENTA_CONTABLE_CUENTAS_COBRAR_SUGEF,
			@pdSALDO_CUENTAS_COBRAR,
			@piCOD_TIPO_MONEDA_CUENTAS_COBRAR,
			@piATRASO_CUENTAS_COBRAR,
			@piCUENTA_CONTABLE_CUENTAS_COBRAR_ENTIDAD,
			@piCOD_SISTEMA
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Personas_Actualiza]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Personas_Actualiza
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Actualiza un registro de la tabla PERSONAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Personas_Actualiza]
	@piID_ROW				INT= NULL,
	@psPRIMER_APELLIDO		VARCHAR(20) = NULL,
	@psSEGUNDO_APELLIDO		VARCHAR(20) = NULL,
	@psNOMBRE				VARCHAR(35) = NULL,
	@psRAZON_SOCIAL			VARCHAR(150) = NULL,
	@piCOD_GENERO			INT = NULL,
	@pdtFECHA_NACIMIENTO	DATE = NULL,
	@psPAIS_NACIMIENTO		VARCHAR(4) = NULL,
	@psCOD_ESTADO			VARCHAR(3) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		UPDATE	dbo.PERSONAS 
		SET		PRIMER_APELLIDO		= @psPRIMER_APELLIDO,
				SEGUNDO_APELLIDO	= @psSEGUNDO_APELLIDO,
				NOMBRE				= @psNOMBRE,
				RAZON_SOCIAL		= @psRAZON_SOCIAL,
				COD_GENERO			= @piCOD_GENERO,
				FECHA_NACIMIENTO	= @pdtFECHA_NACIMIENTO,
				PAIS_NACIMIENTO		= @psPAIS_NACIMIENTO,
				COD_ESTADO			= @psCOD_ESTADO
		WHERE	ID_ROW			= @piID_ROW

		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Personas_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Personas_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo de la tabla PERSONAS, 
			 tomando en cuenta el ordenamiento, paginacin y filtros.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Personas_Consulta]
(@startRowIndex INT,
 @maximumRows INT,
 @filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @sortColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
 DECLARE @TempItems TABLE 
(   ID INT IDENTITY(0,1),
    ID_ROW INT)
 DECLARE @maxRow INT
 SET @filterValue = '%' + @filterValue + '%'

SET @sortColumn = CASE WHEN @sortColumn = '' THEN 'N_REGISTRO, 
													COD_TIPO_PERSONA, 
													ID_PERSONA' ELSE @sortColumn END

SET @maxRow = (@startRowIndex + @maximumRows) 
SET ROWCOUNT @maxRow
INSERT INTO @TempItems (ID_ROW)
EXECUTE('SELECT ID_ROW
		FROM dbo.PERSONAS
WHERE EMPRESA = ' + @filtroEmpresa + ' AND UPPER(ISNULL(' + @filterColumn + ',''''))  LIKE ''' + @filterValue + '''
ORDER BY ' + @sortColumn)
SET ROWCOUNT @maximumRows
	SELECT 
		E.ID_ROW,
		E.N_REGISTRO,
		E.EMPRESA,
		E.COD_TIPO_PERSONA,
		E.ID_PERSONA,
		E.PRIMER_APELLIDO,
		E.SEGUNDO_APELLIDO,
		E.NOMBRE,
		E.RAZON_SOCIAL,
		E.COD_GENERO,
		E.FECHA_NACIMIENTO,
		E.PAIS_NACIMIENTO,
		E.COD_ESTADO,
		TP.DES_TIPO_PERSONA
	FROM @TempItems T 
    INNER JOIN dbo.PERSONAS E 
		ON E.ID_ROW = T.ID_ROW
	LEFT JOIN SICAD_CONFIGURACION.dbo.TIPO_PERSONA TP
		ON E.COD_TIPO_PERSONA = TP.COD_TIPO_PERSONA
	WHERE ID >= @startRowIndex	

SET ROWCOUNT 0






GO
/****** Object:  StoredProcedure [dbo].[Personas_Consulta_Detalle]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Personas_Consulta_Detalle
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el detalle de un registro de acuerdo al campo llave en la tabla PERSONAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Personas_Consulta_Detalle]
	@piID_ROW INT
AS
	SELECT	ID_ROW,
			N_REGISTRO,
			EMPRESA,
			COD_TIPO_PERSONA,
			ID_PERSONA,
			PRIMER_APELLIDO,
			SEGUNDO_APELLIDO,
			NOMBRE,
			RAZON_SOCIAL,
			COD_GENERO,
			FECHA_NACIMIENTO,
			PAIS_NACIMIENTO,
			COD_ESTADO
	FROM	dbo.PERSONAS
	WHERE	ID_ROW = @piID_ROW






GO
/****** Object:  StoredProcedure [dbo].[Personas_Consulta_Rowcount]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Personas_Consulta_Rowcount
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene la cantidad de registros almacenados en la tabla PERSONAS.
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Personas_Consulta_Rowcount]
(@filterValue VARCHAR(MAX),
 @filterColumn VARCHAR(MAX),
 @filtroEmpresa INT)
AS
DECLARE @RowCount INT
DECLARE @StrSQL NVARCHAR(MAX)
SET @filterValue = '%' + @filterValue + '%'

SET @StrSQL = N'SELECT @RowCount = COUNT(1)
FROM dbo.PERSONAS
WHERE EMPRESA = ' + CONVERT(VARCHAR,@filtroEmpresa) + ' AND UPPER(ISNULL(' + @filterColumn + ','''')) LIKE ''' + @filterValue + ''''

EXECUTE sp_executesql @StrSQL, N'@RowCount INTEGER OUT', @RowCount OUT

SELECT @RowCount






GO
/****** Object:  StoredProcedure [dbo].[Personas_Elimina]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Personas_Elimina
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Eliina un registro de la tabla PERSONAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Personas_Elimina]
	@piID_ROW INT
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		DELETE 	 	
		FROM	dbo.PERSONAS
		WHERE	ID_ROW = @piID_ROW
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[Personas_Inserta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Personas_Inserta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Inserta un registro en la tabla PERSONAS
Sistema(s): SICAD

Historial de cambios:

*/

CREATE PROCEDURE [dbo].[Personas_Inserta]
	@piEMPRESA				INT = NULL, 
	@piCOD_TIPO_PERSONA		INT = NULL,
	@psID_PERSONA			VARCHAR(30) = NULL,
	@psPRIMER_APELLIDO		VARCHAR(20) = NULL,
	@psSEGUNDO_APELLIDO		VARCHAR(20) = NULL,
	@psNOMBRE				VARCHAR(35) = NULL,
	@psRAZON_SOCIAL			VARCHAR(150) = NULL,
	@piCOD_GENERO			INT = NULL,
	@pdtFECHA_NACIMIENTO	DATE = NULL,
	@psPAIS_NACIMIENTO		VARCHAR(4) = NULL,
	@psCOD_ESTADO			VARCHAR(3) = NULL
AS 
	BEGIN TRANSACTION TRA_Control
	BEGIN TRY
		INSERT INTO dbo.PERSONAS (
					EMPRESA,
					COD_TIPO_PERSONA,
					ID_PERSONA,
					PRIMER_APELLIDO,
					SEGUNDO_APELLIDO,
					NOMBRE,
					RAZON_SOCIAL,
					COD_GENERO,
					FECHA_NACIMIENTO,
					PAIS_NACIMIENTO,
					COD_ESTADO)
		SELECT 		@piEMPRESA,
					@piCOD_TIPO_PERSONA,
					@psID_PERSONA,
					@psPRIMER_APELLIDO,
					@psSEGUNDO_APELLIDO,
					@psNOMBRE,
					@psRAZON_SOCIAL,
					@piCOD_GENERO,
					@pdtFECHA_NACIMIENTO,
					@psPAIS_NACIMIENTO,
					@psCOD_ESTADO
		COMMIT TRANSACTION TRA_Control
		SELECT 0
	END TRY
	BEGIN CATCH
		SELECT ERROR_NUMBER()
		ROLLBACK TRANSACTION TRA_Control
	END CATCH





GO
/****** Object:  StoredProcedure [dbo].[SSIS_XML_Operaciones_No_Reportadas]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
SSIS_XML_Operaciones_No_Reportadas
Autor(es): GMAS - Jos Gonzlez
Fecha creacin: 28/07/2015
Versin: 1.0
Descripcin: Genera el XML correspondiente al bloque de OPERACIONES_NO_REPORTADAS
Sistema(s): SICAD

Historial de cambios:
*/

CREATE PROCEDURE [dbo].[SSIS_XML_Operaciones_No_Reportadas]
@parEmpresa INT
, @varRuta VARCHAR(250)
--, @ID_BITACORA INT
, @Ind_Encabezado INT

AS
BEGIN

	DECLARE @COD_BLOQUE INT
	SET @COD_BLOQUE = 4 --OPERACIONES_NO_REPORTADAS

	DELETE dbo.GENERACION_XML
	WHERE COD_BLOQUE = @COD_BLOQUE
		AND EMPRESA = @parEmpresa
					
	INSERT INTO dbo.GENERACION_XML
	SELECT 
		@parEmpresa AS EMPRESA
		,@COD_BLOQUE AS COD_BLOQUE
		,@varRuta+'\Crediticio_InformacionOperacionesNoReportadas.xml' AS RUTA	--NOMBRE CON QUE SE GENERA EL ARCHIVO
		,'<?xml version="1.0" encoding = "UTF-8"?>' +
		'<!--   Archivo generado mediante COMSYS   --> ' +
		'<ArchivoSICVECA>' as COMENTARIO
		,(select (select CONVERT (VARCHAR(10),a.COD_CLASE_DATO) AS 'ClaseDato'
				,a.VERSION_CLASE_DATO AS 'VersionClaseDato'
				,CONVERT (VARCHAR(10),a.COD_ARCHIVO) AS 'Archivo'
				,a.VERSION_ARCHIVO AS 'VersionArchivo'
				,(RIGHT('0'+CONVERT(VARCHAR,DAY(CONVERT(DATE,a.FECHA_PERIODO))),2)+'/'+RIGHT('0'+CONVERT(VARCHAR,MONTH(CONVERT(DATE,a.FECHA_PERIODO))),2)+'/'+CONVERT(VARCHAR,YEAR(CONVERT(DATE,a.FECHA_PERIODO)))) AS 'Periodo'
				,a.ID_ENTIDAD AS 'IdEntidad'
				,CONVERT (VARCHAR(10),a.COD_TIPO_CARGA) AS 'TipoCarga'
				,CONVERT (VARCHAR(10),a.COD_TIPO_MONEDA) AS 'TipoMoneda'
			from dbo.ENCABEZADO_XML a
			left join dbo.RELACION_BLOQUE_ARCHIVO_CLASE_DATO b
				on a.COD_ARCHIVO = b.COD_ARCHIVO
			where b.COD_BLOQUE = @COD_BLOQUE and a.COD_EMPRESA = @parEmpresa
			ORDER BY  /*ID_ENCABEZADO_XML*/ID_ROW ASC
			for xml path('Encabezado'),TYPE)
			,(SELECT LP.N_REGISTRO '@id', 'insertar' '@accion'
				,LP.COD_TIPO_PERSONA AS 'TipoPersona'
				,LP.ID_DEUDOR AS 'IdDeudor'
				,LP.ID_OPERACION AS 'IdOperacion'
				,LP.COD_TIPO_MOTIVO_LIQUIDACION AS 'MotivoLiquidacion'
				,(RIGHT('0'+CONVERT(VARCHAR,DAY(CONVERT(DATE,LP.FECHA_LIQUIDACION))),2)+'/'+RIGHT('0'+CONVERT(VARCHAR,MONTH(CONVERT(DATE,LP.FECHA_LIQUIDACION))),2)+'/'+CONVERT(VARCHAR,YEAR(CONVERT(DATE,LP.FECHA_LIQUIDACION)))) AS 'FechaLiquidacion'
				,LP.SALDO_PRINCIPAL_LIQUIDADO AS 'SaldoPrincipalLiquidado'
				,LP.SALDO_PRODUCTOS_LIQUIDADO AS 'SaldoProductosLiquidado'
				,LP.ID_OPERACION_NUEVA AS 'IdOperacionNueva'
			FROM SICAD_CONSOLIDADO.dbo.OPERACIONES_NO_REPORTADAS LP
			WHERE LP.N_REGISTRO IS NOT NULL AND LP.EMPRESA = @parEmpresa
			ORDER BY LP.N_REGISTRO ASC
			FOR XML PATH('Registro'), root('Datos'),elements xsinil,type)
	for XML path('ArchivoSICVECA')) AS CODIGO_XML
		
	END

GO
/****** Object:  StoredProcedure [dbo].[Sugef_Padron_Emisor_Catalogo_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/*
Categoria_Riesgo_Deudor_Catalogo_Consulta
Autor(es): GrupoMAS - Genoveva Salmeron
Fecha creacin: FEB2015
Versin: 1.0
Descripcin: Obtiene el set de datos completo almacenado en la tabla CATEGORIA_RIESGO_DEUDOR
Sistema(s): SICAD

Historial de cambios:
*/

CREATE PROCEDURE [dbo].[Sugef_Padron_Emisor_Catalogo_Consulta]
AS    
    SELECT	NEM_EMI,
			DES_EMISOR,		  
			(NEM_EMI + ' - ' + DES_EMISOR) AS DES_CONC
	FROM	dbo.SUGEF_PADRON_EMISOR
	ORDER BY NEM_EMI,DES_EMISOR









GO
/****** Object:  StoredProcedure [dbo].[Sugef_Padron_Instrumento_Catalogo_Consulta]    Script Date: 17/05/2016 03:44:59 p.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROCEDURE [dbo].[Sugef_Padron_Instrumento_Catalogo_Consulta]
AS    
    SELECT	COD_INSTRUMENTO,
			DES_INSTRUMENTO,		  
			(COD_INSTRUMENTO + ' - ' + DES_INSTRUMENTO) AS DES_CONC
	FROM	dbo.SUGEF_PADRON_INSTRUMENTO
	ORDER BY COD_INSTRUMENTO,DES_INSTRUMENTO







GO

